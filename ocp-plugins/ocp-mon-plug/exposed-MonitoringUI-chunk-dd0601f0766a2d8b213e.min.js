"use strict";(self.webpackChunkmonitoring_plugin=self.webpackChunkmonitoring_plugin||[]).push([[218],{67380:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(20559),r=a.n(n),l=a(93476),o=a.n(l)()(r());o.push([e.id,'.pf-theme-dark .query-browser__tooltip-line,.pf-theme-dark .query-browser__tooltip-arrow,.pf-theme-dark .query-browser__tooltip{--pf-global--BackgroundColor--dark-100: var(--pf-global--palette--black-1000)}.co-alert-manager{margin-bottom:var(--pf-global--spacer--md)}.co-resource-item.co-resource-item--monitoring-alert{margin:0 5px}.pf-c-modal-box .custom-time-range-modal{overflow:visible;padding:var(--pf-c-modal-box__body--PaddingTop) var(--pf-c-modal-box__body--PaddingLeft)}.pf-c-modal-box .custom-time-range-modal-footer{padding-top:var(--pf-c-modal-box__body--PaddingTop)}.graph-empty-state{min-height:310px}.graph-empty-state__loaded{align-items:stretch;display:flex;flex-direction:column;justify-content:center}.graph-wrapper__horizontal-bar{padding-right:10px}.graph-wrapper.graph-wrapper--query-browser{padding:5px 15px 15px 60px}.graph-wrapper.graph-wrapper--query-browser--with-legend{min-height:305px}.horizontal-scroll{overflow-x:auto;padding-left:var(--pf-global--spacer--md);padding-right:var(--pf-global--spacer--md)}.horizontal-scroll:before,.horizontal-scroll:after{bottom:0;content:"";pointer-events:none;position:absolute;top:0;width:var(--pf-global--spacer--md);z-index:1}.horizontal-scroll:before{background:linear-gradient(to right, var(--pf-global--BackgroundColor--100), rgba(255, 255, 255, 0));left:0}.horizontal-scroll:after{background:linear-gradient(to left, var(--pf-global--BackgroundColor--100), rgba(255, 255, 255, 0));right:0}.monitoring-breadcrumbs{padding-bottom:var(--pf-global--spacer--sm)}.monitoring-dashboards__card{height:calc(100% - 20px);margin:0 0 20px 0}.monitoring-dashboards__card .co-dashboard-card__body--dashboard{padding:10px 15px 10px 10px}.monitoring-dashboards__card.co-dashboard-card--gradient .pf-c-card__body{max-height:350px;overflow:scroll}.monitoring-dashboards__card.co-dashboard-card--gradient:after{width:calc(100% - 10px)}.monitoring-dashboards__card .query-browser__wrapper{border:0;margin:0;min-height:240px;padding:0}.monitoring-dashboards__card-body-content{height:100%}.monitoring-dashboards__card-header{flex:0 0 auto}.monitoring-dashboards__dropdown-button{max-width:280px !important;min-width:100px}@media(min-width: 768px){.monitoring-dashboards__dropdown-button{max-width:100% !important}}.monitoring-dashboards__dropdown-title{text-transform:capitalize}.monitoring-dashboards__dropdown-wrap{display:flex;flex-direction:column;margin-right:20px}.monitoring-dashboards__dropdown-wrap .monitoring-dashboards__dashboard_dropdown_item{display:flex;justify-content:space-between}.monitoring-dashboards__dropdown-wrap .monitoring-dashboards__dashboard_dropdown_tag{font-weight:var(--pf-global--FontWeight--bold);line-height:13px;margin-left:20px}.monitoring-dashboards__header{display:flex;flex-wrap:wrap;justify-content:space-between}.monitoring-dashboards__label-column-header{min-width:175px}@media(min-width: 1200px){.monitoring-dashboards__label-column-header{min-width:225px}}.monitoring-dashboards__legend-wrap{height:75px;padding-top:1px}.monitoring-dashboards__legend-wrap svg{max-height:65px}.monitoring-dashboards__dropdowns{display:flex}.monitoring-dashboards__options{display:flex;margin-right:-20px}.monitoring-dashboards__panel{padding:0 10px}.monitoring-dashboards__panel--max-1{width:100%}@media(max-width: 567px){.monitoring-dashboards__panel--max-2,.monitoring-dashboards__panel--max-3,.monitoring-dashboards__panel--max-4{min-width:100%}}@media(min-width: 567px)and (max-width: 1199px){.monitoring-dashboards__panel--max-2{width:100%}.monitoring-dashboards__panel--max-3,.monitoring-dashboards__panel--max-4{flex:1 0 50%;min-width:50%}}@media(min-width: 1200px){.monitoring-dashboards__panel--max-2{flex:1 0 50%;min-width:50%}.monitoring-dashboards__panel--max-3{flex:1 0 33%;min-width:33%}.monitoring-dashboards__panel--max-4{flex:0 0 25%;min-width:25%}}.monitoring-dashboards__row{display:flex;flex-wrap:wrap;margin:0 -10px}.monitoring-dashboards__single-stat{font-size:var(--pf-global--FontSize--3xl)}.monitoring-dashboards__table{table-layout:auto;width:100%}.monitoring-dashboards__table-container{overflow-x:auto}.monitoring-dashboards__variable-dropdown .pf-c-dropdown__menu,.monitoring-dashboards__variable-dropdown .pf-c-select__menu{max-height:60vh;overflow-y:auto}.monitoring-dashboards__variable-dropdown .pf-m-search{min-width:140px}.monitoring-dashboards__variables{display:flex;flex-wrap:wrap;justify-content:space-between}.monitoring-description,.monitoring-label-list{line-height:18px;margin-top:4px}.monitoring-description{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;height:36px;overflow:hidden;text-overflow:ellipsis}.monitoring-heading{display:flex;justify-content:space-between}.monitoring-icon-wrap{margin-right:10px}.monitoring-alert-detail-toolbar.pf-c-toolbar{padding-top:0}.monitoring-alert-detail-toolbar.pf-c-toolbar .pf-c-toolbar__content{padding:0}.monitoring-alert-detail-toolbar.pf-c-toolbar .co-section-heading{margin:0}.monitoring-silence-alert{max-width:950px}.monitoring-silence-alert__label-options{align-items:baseline;display:flex;justify-content:space-between}@media(min-width: var(--global--breakpoint--md)){.monitoring-silence-alert__label-options{padding-top:26px}}.monitoring-silence-alert__paragraph{margin-bottom:var(--pf-c-content--MarginBottom)}.monitoring-state-icon--pending{color:var(--pf-global--palette--black-700)}.monitoring-timestamp{font-size:var(--pf-global--FontSize--sm)}.prometheus-template-tag{margin:0 2px}.query-browser__autocomplete-match{font-weight:var(--pf-global--FontWeight--bold)}.query-browser__clear-icon{font-size:18px !important;padding:4px !important;position:absolute !important;right:0;top:0;width:30px}.query-browser__controls{display:flex;flex-wrap:wrap-reverse;justify-content:space-between;margin-bottom:15px;width:100%}.query-browser__controls .pf-c-check{--pf-c-check__input--MarginTop: 0}.query-browser__controls--left{display:flex}.query-browser__reduced-resolution.pf-c-alert{align-content:center}.query-browser__controls--right{display:flex;margin-left:auto}.query-browser__dropdown--subtitle{padding:1px 10px}.query-browser__expand-button{border:none;height:30px;padding:0 14px !important}.query-browser__expand-icon{font-size:30px;vertical-align:middle}.query-browser__inline-control{margin-left:10px;margin-right:10px}.query-browser__loading{margin:auto 0;min-width:20px}.query-browser__metrics-dropdown-menu{max-height:25vh;overflow:auto;width:100%}.query-browser__query{line-height:1;margin:0 15px 0 0;width:100%}.query-browser__query .pf-c-form__helper-text{margin-top:var(--pf-global--spacer--xs)}.query-browser__query-controls{align-items:center;border:solid var(--pf-global--BorderColor--100);border-width:1px 0;display:flex;padding:10px 0}.query-browser__query>.query-browser__query-input{padding-right:28px !important;resize:vertical;font-family:var(--pf-c-code-block__pre--FontFamily),monospace;font-size:var(--pf-c-code-block__pre--FontSize)}.query-browser__query>.query-browser__query-input:focus-within{--pf-c-form-control--BorderBottomColor: var(--pf-c-form-control--focus--BorderBottomColor);padding-bottom:var(--pf-c-form-control--focus--PaddingBottom);border-bottom-width:var(--pf-c-form-control--focus--BorderBottomWidth)}.query-browser__series-btn{border:var(--pf-global--BorderWidth--sm) solid rgba(0,0,0,0);border-radius:var(--pf-global--BorderRadius--sm);height:20px;padding:0 !important;width:20px}.query-browser__series-btn--disabled{border:var(--pf-global--BorderWidth--sm) solid #888 !important}.query-browser__series-btn-wrap{border:var(--pf-global--BorderWidth--sm) solid rgba(0,0,0,0);border-radius:var(--pf-global--BorderRadius--sm);display:flex;height:26px;padding:2px;width:26px}.query-browser__series-btn-wrap:hover{background-color:var(--pf-global--active-color--200);border-color:var(--pf-global--active-color--100)}.query-browser__span{max-width:130px}.query-browser__span .query-browser__span-dropdown-item{width:129px}.query-browser__table{border-left:3px solid rgba(0,0,0,0);margin-bottom:25px}.query-browser__table--expanded{border-left-color:var(--pf-global--active-color--100)}.query-browser__table tr>:first-child{padding-top:0;padding-bottom:0;padding-left:0;vertical-align:middle}.query-browser__table-wrapper{position:relative;width:100%}.query-browser__table-wrapper table{table-layout:auto}.query-browser__table-wrapper .query-browser__series-select-all-btn{margin-top:var(--pf-global--spacer--md)}.query-browser__table-message{border-bottom:solid 1px var(--pf-global--BorderColor--100);padding:10px 20px}.query-browser__toggle-graph-container{display:flex;justify-content:flex-end;margin-bottom:var(--pf-global--spacer--xs)}.query-browser__tooltip{background-color:var(--pf-global--BackgroundColor--dark-100);color:#eee;font-size:12px;overflow-x:hidden;padding:10px}.query-browser__tooltip-arrow{border-bottom:12px solid rgba(0,0,0,0);border-right:12px solid var(--pf-global--BackgroundColor--dark-100);border-top:12px solid rgba(0,0,0,0);height:0;width:0}.query-browser__tooltip-line{stroke:var(--pf-global--BackgroundColor--dark-100)}.query-browser__tooltip-series{display:flex}.query-browser__tooltip-series .query-browser__series-btn{flex:0 0 12px;height:12px;margin-top:4px;margin-right:3px}.query-browser__tooltip-time{font-weight:var(--pf-global--FontWeight--bold)}.query-browser__tooltip-value{font-weight:var(--pf-global--FontWeight--bold);margin-left:auto;padding-left:10px;white-space:nowrap}.query-browser__tooltip-wrap{align-items:center;display:flex;height:100%}.query-browser__tooltip-wrap--left{flex-direction:row-reverse}.query-browser__tooltip-wrap--left .query-browser__tooltip-arrow{border-left:12px solid var(--pf-global--BackgroundColor--dark-100);border-right:none}.query-browser__wrapper{border:var(--pf-global--BorderWidth--sm) solid var(--pf-global--BorderColor--100);margin:0 0 20px 0;overflow:visible;padding:10px;width:100%}.query-browser__wrapper--hidden{border-bottom:none;border-top:none;height:0;margin:0;padding-bottom:0;padding-top:0}.query-browser__zoom{cursor:ew-resize;position:relative;height:200px}.query-browser__zoom:focus{outline:none}.query-browser__zoom-overlay{background-color:rgba(0,0,0,.2);bottom:0;position:absolute;top:0;z-index:1050}.monitoring__title-help-text{font-size:var(--pf-global--FontSize--md);margin-bottom:1.5rem;margin-top:5px}',"",{version:3,sources:["webpack://./components/_monitoring.scss"],names:[],mappings:"AAIE,gIACE,6EAAA,CAIJ,kBACE,0CAAA,CAGF,qDACE,YAAA,CAIA,yCACE,gBAAA,CACA,wFAAA,CAGF,gDACE,mDAAA,CAIJ,mBACE,gBAAA,CACA,2BACE,mBAAA,CACA,YAAA,CACA,qBAAA,CACA,sBAAA,CAIJ,+BACE,kBAAA,CAGF,4CACE,0BAAA,CAEA,yDACE,gBAAA,CAIJ,mBACE,eAAA,CACA,yCAAA,CACA,0CAAA,CAEA,mDACE,QAAA,CACA,UAAA,CACA,mBAAA,CACA,iBAAA,CACA,KAAA,CACA,kCAAA,CACA,SAAA,CAEF,0BACE,oGAAA,CAKA,MAAA,CAEF,yBACE,mGAAA,CAKA,OAAA,CAIJ,wBACE,2CAAA,CAGF,6BACE,wBAAA,CACA,iBAAA,CAEA,iEAGE,2BAAA,CAIA,0EACE,gBAAA,CACA,eAAA,CAEF,+DACE,uBAAA,CAIJ,qDACE,QAAA,CACA,QAAA,CACA,gBAAA,CACA,SAAA,CAIJ,0CACE,WAAA,CAGF,oCACE,aAAA,CAGF,wCACE,0BAAA,CACA,eAAA,CACA,yBAHF,wCAII,yBAAA,CAAA,CAIJ,uCACE,yBAAA,CAGF,sCACE,YAAA,CACA,qBAAA,CACA,iBAAA,CAEA,sFACE,YAAA,CACA,6BAAA,CAEF,qFACE,8CAAA,CACA,gBAAA,CACA,gBAAA,CAIJ,+BACE,YAAA,CACA,cAAA,CACA,6BAAA,CAGF,4CAEE,eAAA,CACA,0BAHF,4CAII,eAAA,CAAA,CAIJ,oCAEE,WAAA,CACA,eAAA,CACA,wCACE,eAJsB,CAQ1B,kCACE,YAAA,CAGF,gCACE,YAAA,CACA,kBAAA,CAGF,8BACE,cAAA,CAGF,qCACE,UAAA,CAKF,yBACE,+GAGE,cAAA,CAAA,CAIJ,gDACE,qCACE,UAAA,CAEF,0EAEE,YAAA,CACA,aAAA,CAAA,CAIJ,0BACE,qCACE,YAAA,CACA,aAAA,CAEF,qCACE,YAAA,CACA,aAAA,CAEF,qCACE,YAAA,CACA,aAAA,CAAA,CAIJ,4BACE,YAAA,CACA,cAAA,CACA,cAAA,CAGF,oCACE,yCAAA,CAGF,8BACE,iBAAA,CACA,UAAA,CAGF,wCACE,eAAA,CAIA,4HAEE,eAAA,CACA,eAAA,CAEF,uDACE,eAAA,CAIJ,kCACE,YAAA,CACA,cAAA,CACA,6BAAA,CAKF,+CACE,gBAHuB,CAIvB,cAAA,CAGF,wBAIE,mBAAA,CACA,2BAAA,CACA,oBAHY,CAIZ,WAAA,CACA,eAAA,CACA,sBAAA,CAGF,oBACE,YAAA,CACA,6BAAA,CAGF,sBACE,iBAAA,CAGF,8CACE,aAAA,CAEA,qEACE,SAAA,CAGF,kEACE,QAAA,CAIJ,0BACE,eAAA,CAEA,yCACE,oBAAA,CACA,YAAA,CACA,6BAAA,CACA,iDAJF,yCAKI,gBAAA,CAAA,CAIJ,qCACE,+CAAA,CAIJ,gCACE,0CAAA,CAGF,sBACE,wCAAA,CAGF,yBACE,YAAA,CAGF,mCACE,8CAAA,CAGF,2BACE,yBAAA,CACA,sBAAA,CACA,4BAAA,CACA,OAAA,CACA,KAAA,CACA,UAAA,CAGF,yBACE,YAAA,CACA,sBAAA,CACA,6BAAA,CACA,kBAAA,CACA,UAAA,CAEA,qCACE,iCAAA,CAIJ,+BACE,YAAA,CAGF,8CACE,oBAAA,CAGF,gCACE,YAAA,CACA,gBAAA,CAGF,mCACE,gBAAA,CAGF,8BACE,WAAA,CACA,WAAA,CACA,yBAAA,CAGF,4BACE,cAAA,CACA,qBAAA,CAGF,+BACE,gBAAA,CACA,iBAAA,CAGF,wBACE,aAAA,CACA,cAAA,CAGF,sCACE,eAAA,CACA,aAAA,CACA,UAAA,CAGF,sBACE,aAAA,CACA,iBAAA,CACA,UAAA,CAEA,8CACE,uCAAA,CAIJ,+BACE,kBAAA,CACA,+CAAA,CACA,kBAAA,CACA,YAAA,CACA,cAAA,CAGF,kDACE,6BAAA,CACA,eAAA,CACA,6DAAA,CACA,+CAAA,CAEA,+DACE,0FAAA,CACA,6DAAA,CACA,sEAAA,CAIJ,2BACE,4DAAA,CACA,gDAAA,CACA,WAAA,CACA,oBAAA,CACA,UAAA,CACA,qCACE,8DAAA,CAIJ,gCACE,4DAAA,CACA,gDAAA,CACA,YAAA,CACA,WAAA,CACA,WAAA,CACA,UAAA,CACA,sCACE,oDAAA,CACA,gDAAA,CAKJ,qBAEE,eADQ,CAGR,wDACE,WAAA,CAIJ,sBACE,mCAAA,CACA,kBAAA,CAEA,gCACE,qDAAA,CAGF,sCACE,aAAA,CACA,gBAAA,CACA,cAAA,CACA,qBAAA,CAIJ,8BACE,iBAAA,CACA,UAAA,CAEA,oCACE,iBAAA,CAIJ,oEACE,uCAAA,CAGF,8BACE,0DAAA,CACA,iBAAA,CAGF,uCACE,YAAA,CACA,wBAAA,CACA,0CAAA,CAGF,wBACE,4DAAA,CAEA,UAAA,CACA,cAAA,CACA,iBAAA,CACA,YAAA,CAGF,8BACE,sCAAA,CACA,mEAAA,CAEA,mCAAA,CACA,QAAA,CACA,OAAA,CAGF,6BACE,kDAAA,CAIF,+BACE,YAAA,CAEA,0DACE,aAAA,CACA,WAAA,CACA,cAAA,CACA,gBAAA,CAIJ,6BACE,8CAAA,CAGF,8BACE,8CAAA,CACA,gBAAA,CACA,iBAAA,CACA,kBAAA,CAGF,6BACE,kBAAA,CACA,YAAA,CACA,WAAA,CAEA,mCACE,0BAAA,CAEA,iEACE,kEAAA,CAEA,iBAAA,CAKN,wBACE,iFAAA,CACA,iBAAA,CACA,gBAAA,CACA,YAAA,CACA,UAAA,CAEA,gCACE,kBAAA,CACA,eAAA,CACA,QAAA,CACA,QAAA,CACA,gBAAA,CACA,aAAA,CAIJ,qBACE,gBAAA,CACA,iBAAA,CAIA,YAAA,CAHA,2BACE,YAAA,CAKJ,6BACE,+BAAA,CACA,QAAA,CACA,iBAAA,CACA,KAAA,CACA,YAAA,CAGF,6BACE,wCAAA,CACA,oBAAA,CACA,cAAA",sourcesContent:["$screen-sm-min: 768px;\n$screen-lg-min: 1200px;\n\n%tooltip-background-color-theme-dark {\n  .pf-theme-dark & {\n    --pf-global--BackgroundColor--dark-100: var(--pf-global--palette--black-1000);\n  }\n}\n\n.co-alert-manager {\n  margin-bottom: var(--pf-global--spacer--md);\n}\n\n.co-resource-item.co-resource-item--monitoring-alert {\n  margin: 0 5px;\n}\n\n.pf-c-modal-box {\n  .custom-time-range-modal {\n    overflow: visible;\n    padding: var(--pf-c-modal-box__body--PaddingTop) var(--pf-c-modal-box__body--PaddingLeft);\n  }\n\n  .custom-time-range-modal-footer {\n    padding-top: var(--pf-c-modal-box__body--PaddingTop);\n  }\n}\n\n.graph-empty-state {\n  min-height: 310px;\n  &__loaded {\n    align-items: stretch;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n  }\n}\n\n.graph-wrapper__horizontal-bar {\n  padding-right: 10px;\n}\n\n.graph-wrapper.graph-wrapper--query-browser {\n  padding: 5px 15px 15px 60px;\n\n  &--with-legend {\n    min-height: 305px;\n  }\n}\n\n.horizontal-scroll {\n  overflow-x: auto;\n  padding-left: var(--pf-global--spacer--md);\n  padding-right: var(--pf-global--spacer--md);\n\n  &:before, &:after {\n    bottom: 0;\n    content: '';\n    pointer-events: none;\n    position: absolute;\n    top: 0;\n    width: var(--pf-global--spacer--md);\n    z-index: 1;\n  }\n  &:before {\n    background: linear-gradient(\n      to right,\n      var(--pf-global--BackgroundColor--100),\n      rgba(255, 255, 255, 0)\n    );\n    left: 0;\n  }\n  &:after {\n    background: linear-gradient(\n      to left,\n      var(--pf-global--BackgroundColor--100),\n      rgba(255, 255, 255, 0)\n    );\n    right: 0;\n  }\n}\n\n.monitoring-breadcrumbs {\n  padding-bottom: var(--pf-global--spacer--sm);\n}\n\n.monitoring-dashboards__card {\n  height: calc(100% - 20px);\n  margin: 0 0 20px 0;\n\n  .co-dashboard-card__body--dashboard {\n    // Add extra padding to the right. X-axis times with AM/PM at certain screen widths can overflow\n    // the card otherwise.\n    padding: 10px 15px 10px 10px;\n  }\n\n  &.co-dashboard-card--gradient {\n    .pf-c-card__body {\n      max-height: 350px;\n      overflow: scroll;\n    }\n    &:after {\n      width: calc(100% - 10px);\n    }\n  }\n\n  .query-browser__wrapper {\n    border: 0;\n    margin: 0;\n    min-height: 240px;\n    padding: 0;\n  }\n}\n\n.monitoring-dashboards__card-body-content {\n  height: 100%;\n}\n\n.monitoring-dashboards__card-header {\n  flex: 0 0 auto;\n}\n\n.monitoring-dashboards__dropdown-button {\n  max-width: 280px !important; // allow truncation\n  min-width: 100px;\n  @media (min-width: $screen-sm-min) {\n    max-width: 100% !important;\n  }\n}\n\n.monitoring-dashboards__dropdown-title {\n  text-transform: capitalize;\n}\n\n.monitoring-dashboards__dropdown-wrap {\n  display: flex;\n  flex-direction: column;\n  margin-right: 20px;\n\n  .monitoring-dashboards__dashboard_dropdown_item {\n    display: flex;\n    justify-content: space-between;\n  }\n  .monitoring-dashboards__dashboard_dropdown_tag {\n    font-weight: var(--pf-global--FontWeight--bold);\n    line-height: 13px;\n    margin-left: 20px;\n  }\n}\n\n.monitoring-dashboards__header {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n}\n\n.monitoring-dashboards__label-column-header {\n  // Set a min-width to avoid aggressive wrapping, which makes the table much taller.\n  min-width: 175px;\n  @media (min-width: $screen-lg-min) {\n    min-width: 225px;\n  }\n}\n\n.monitoring-dashboards__legend-wrap {\n  $legend-content-height: 65px;\n  height: $legend-content-height + 10px; // Add space for the horizontal scrollbar\n  padding-top: 1px;\n  svg {\n    max-height: $legend-content-height; // Required for Chrome to prevent vertical scrolling\n  }\n}\n\n.monitoring-dashboards__dropdowns {\n  display: flex;\n}\n\n.monitoring-dashboards__options {\n  display: flex;\n  margin-right: -20px;\n}\n\n.monitoring-dashboards__panel {\n  padding: 0 10px;\n}\n\n.monitoring-dashboards__panel--max-1 {\n  width: 100%;\n}\n\n$screen-phone-landscape-min-width: 567px;\n\n@media (max-width: $screen-phone-landscape-min-width) {\n  .monitoring-dashboards__panel--max-2,\n  .monitoring-dashboards__panel--max-3,\n  .monitoring-dashboards__panel--max-4 {\n    min-width: 100%;\n  }\n}\n\n@media (min-width: $screen-phone-landscape-min-width) and (max-width: $screen-lg-min - 1) {\n  .monitoring-dashboards__panel--max-2 {\n    width: 100%;\n  }\n  .monitoring-dashboards__panel--max-3,\n  .monitoring-dashboards__panel--max-4 {\n    flex: 1 0 50%;\n    min-width: 50%;\n  }\n}\n\n@media (min-width: $screen-lg-min) {\n  .monitoring-dashboards__panel--max-2 {\n    flex: 1 0 50%;\n    min-width: 50%;\n  }\n  .monitoring-dashboards__panel--max-3 {\n    flex: 1 0 33%;\n    min-width: 33%;\n  }\n  .monitoring-dashboards__panel--max-4 {\n    flex: 0 0 25%;\n    min-width: 25%;\n  }\n}\n\n.monitoring-dashboards__row {\n  display: flex;\n  flex-wrap: wrap;\n  margin: 0 -10px;\n}\n\n.monitoring-dashboards__single-stat {\n  font-size: var(--pf-global--FontSize--3xl);\n}\n\n.monitoring-dashboards__table {\n  table-layout: auto;\n  width: 100%;\n}\n\n.monitoring-dashboards__table-container {\n  overflow-x: auto;\n}\n\n.monitoring-dashboards__variable-dropdown {\n  .pf-c-dropdown__menu,\n  .pf-c-select__menu {\n    max-height: 60vh;\n    overflow-y: auto;\n  }\n  .pf-m-search {\n    min-width: 140px;\n  }\n}\n\n.monitoring-dashboards__variables {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n}\n\n$monitoring-line-height: 18px;\n\n.monitoring-description, .monitoring-label-list {\n  line-height: $monitoring-line-height;\n  margin-top: 4px;\n}\n\n.monitoring-description {\n  // Limit to $num-lines lines of text. Truncate with an ellipsis in WebKit. Just overflow hidden\n  // for other browsers.\n  $num-lines: 2;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: $num-lines;\n  height: $num-lines * $monitoring-line-height;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.monitoring-heading {\n  display: flex;\n  justify-content: space-between;\n}\n\n.monitoring-icon-wrap {\n  margin-right: 10px;\n}\n\n.monitoring-alert-detail-toolbar.pf-c-toolbar  {\n  padding-top: 0;\n\n  .pf-c-toolbar__content{\n    padding: 0;\n  }\n\n  .co-section-heading{\n    margin: 0;\n  }\n}\n\n.monitoring-silence-alert {\n  max-width: 950px;\n\n  &__label-options {\n    align-items: baseline;\n    display: flex;\n    justify-content: space-between;\n    @media (min-width: var(--global--breakpoint--md)) {\n      padding-top: 26px;\n    }\n  }\n\n  &__paragraph {\n    margin-bottom: var(--pf-c-content--MarginBottom);\n  }\n}\n\n.monitoring-state-icon--pending {\n  color: var(--pf-global--palette--black-700);\n}\n\n.monitoring-timestamp {\n  font-size: var(--pf-global--FontSize--sm);\n}\n\n.prometheus-template-tag {\n  margin: 0 2px;\n}\n\n.query-browser__autocomplete-match {\n  font-weight: var(--pf-global--FontWeight--bold);\n}\n\n.query-browser__clear-icon {\n  font-size: 18px !important;\n  padding: 4px !important;\n  position: absolute !important;\n  right: 0;\n  top: 0;\n  width: 30px;\n}\n\n.query-browser__controls {\n  display: flex;\n  flex-wrap: wrap-reverse;\n  justify-content: space-between;\n  margin-bottom: 15px;\n  width: 100%;\n\n  .pf-c-check {\n    --pf-c-check__input--MarginTop: 0;\n  }\n}\n\n.query-browser__controls--left {\n  display: flex;\n}\n\n.query-browser__reduced-resolution.pf-c-alert{\n  align-content: center;\n}\n\n.query-browser__controls--right {\n  display: flex;\n  margin-left: auto;\n}\n\n.query-browser__dropdown--subtitle {\n  padding: 1px 10px;\n}\n\n.query-browser__expand-button {\n  border: none;\n  height: 30px;\n  padding: 0 14px !important; // align with series buttons\n}\n\n.query-browser__expand-icon {\n  font-size: 30px;\n  vertical-align: middle;\n}\n\n.query-browser__inline-control {\n  margin-left: 10px;\n  margin-right: 10px;\n}\n\n.query-browser__loading {\n  margin: auto 0;\n  min-width: 20px;\n}\n\n.query-browser__metrics-dropdown-menu {\n  max-height: 25vh;\n  overflow: auto;\n  width: 100%;\n}\n\n.query-browser__query {\n  line-height: 1;\n  margin: 0 15px 0 0;\n  width: 100%;\n\n  .pf-c-form__helper-text {\n    margin-top: var(--pf-global--spacer--xs);\n  }\n}\n\n.query-browser__query-controls {\n  align-items: center;\n  border: solid var(--pf-global--BorderColor--100);\n  border-width: 1px 0;\n  display: flex;\n  padding: 10px 0;\n}\n\n.query-browser__query > .query-browser__query-input {\n  padding-right: 28px !important;\n  resize: vertical;\n  font-family: var(--pf-c-code-block__pre--FontFamily), monospace;\n  font-size: var(--pf-c-code-block__pre--FontSize);\n\n  &:focus-within {\n    --pf-c-form-control--BorderBottomColor: var(--pf-c-form-control--focus--BorderBottomColor);\n    padding-bottom: var(--pf-c-form-control--focus--PaddingBottom);\n    border-bottom-width: var(--pf-c-form-control--focus--BorderBottomWidth);\n  }\n}\n\n.query-browser__series-btn {\n  border: var(--pf-global--BorderWidth--sm) solid transparent;\n  border-radius: var(--pf-global--BorderRadius--sm);\n  height: 20px;\n  padding: 0 !important;\n  width: 20px;\n  &--disabled {\n    border: var(--pf-global--BorderWidth--sm) solid #888 !important;\n  }\n}\n\n.query-browser__series-btn-wrap {\n  border: var(--pf-global--BorderWidth--sm) solid transparent;\n  border-radius: var(--pf-global--BorderRadius--sm);\n  display: flex;\n  height: 26px;\n  padding: 2px;\n  width: 26px;\n  &:hover {\n    background-color: var(--pf-global--active-color--200);\n    border-color: var(--pf-global--active-color--100);\n  }\n}\n\n// Match the width of the combined text input and dropdown button input group and the dropdown menu\n.query-browser__span {\n  $width: 130px;\n  max-width: $width;\n\n  .query-browser__span-dropdown-item {\n    width: $width - 1px;\n  }\n}\n\n.query-browser__table {\n  border-left: 3px solid transparent;\n  margin-bottom: 25px;\n\n  &--expanded {\n    border-left-color: var(--pf-global--active-color--100);\n  }\n\n  tr > :first-child {\n    padding-top: 0;\n    padding-bottom: 0;\n    padding-left: 0;\n    vertical-align: middle;\n  }\n}\n\n.query-browser__table-wrapper {\n  position: relative;\n  width: 100%;\n\n  table {\n    table-layout: auto;\n  }\n}\n\n.query-browser__table-wrapper .query-browser__series-select-all-btn {\n  margin-top: var(--pf-global--spacer--md);\n}\n\n.query-browser__table-message {\n  border-bottom: solid 1px var(--pf-global--BorderColor--100);\n  padding: 10px 20px;\n}\n\n.query-browser__toggle-graph-container {\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: var(--pf-global--spacer--xs);\n}\n\n.query-browser__tooltip {\n  background-color: var(--pf-global--BackgroundColor--dark-100);\n  @extend %tooltip-background-color-theme-dark;\n  color: #eee;\n  font-size: 12px;\n  overflow-x: hidden;\n  padding: 10px;\n}\n\n.query-browser__tooltip-arrow {\n  border-bottom: 12px solid transparent;\n  border-right: 12px solid var(--pf-global--BackgroundColor--dark-100);\n  @extend %tooltip-background-color-theme-dark;\n  border-top: 12px solid transparent;\n  height: 0;\n  width: 0;\n}\n\n.query-browser__tooltip-line {\n  stroke: var(--pf-global--BackgroundColor--dark-100);\n  @extend %tooltip-background-color-theme-dark;\n}\n\n.query-browser__tooltip-series {\n  display: flex;\n\n  .query-browser__series-btn {\n    flex: 0 0 12px;\n    height: 12px;\n    margin-top: 4px;\n    margin-right: 3px;\n  }\n}\n\n.query-browser__tooltip-time {\n  font-weight: var(--pf-global--FontWeight--bold);\n}\n\n.query-browser__tooltip-value {\n  font-weight: var(--pf-global--FontWeight--bold);\n  margin-left: auto;\n  padding-left: 10px;\n  white-space: nowrap;\n}\n\n.query-browser__tooltip-wrap {\n  align-items: center;\n  display: flex;\n  height: 100%;\n\n  &--left {\n    flex-direction: row-reverse;\n\n    .query-browser__tooltip-arrow {\n      border-left: 12px solid var(--pf-global--BackgroundColor--dark-100);\n      @extend %tooltip-background-color-theme-dark;\n      border-right: none;\n    }\n  }\n}\n\n.query-browser__wrapper {\n  border: var(--pf-global--BorderWidth--sm) solid var(--pf-global--BorderColor--100);\n  margin: 0 0 20px 0;\n  overflow: visible;\n  padding: 10px;\n  width: 100%;\n\n  &--hidden {\n    border-bottom: none;\n    border-top: none;\n    height: 0;\n    margin: 0;\n    padding-bottom: 0;\n    padding-top: 0;\n  }\n}\n\n.query-browser__zoom {\n  cursor: ew-resize;\n  position: relative;\n  &:focus {\n    outline: none;\n  }\n  height: 200px;\n}\n\n.query-browser__zoom-overlay {\n  background-color: rgba(0, 0, 0, 0.2);\n  bottom: 0;\n  position: absolute;\n  top: 0;\n  z-index: 1050;\n}\n\n.monitoring__title-help-text {\n  font-size: var(--pf-global--FontSize--md);\n  margin-bottom: 1.5rem;\n  margin-top: 5px;\n}\n"],sourceRoot:""}]);const s=o},31185:(e,t,a)=>{a.d(t,{$x:()=>l,A$:()=>p,BZ:()=>v,F$:()=>A,HA:()=>s,IR:()=>E,LS:()=>N,Li:()=>y,Mw:()=>b,O8:()=>d,Pn:()=>B,W0:()=>x,ZC:()=>o,Zn:()=>m,bH:()=>g,dp:()=>h,gV:()=>f,k:()=>u,lL:()=>i,mM:()=>c,nw:()=>k,qw:()=>_,xU:()=>C,xu:()=>S,y9:()=>w});var n,r=a(9345);!function(e){e.AlertingSetData="alertingSetData",e.AlertingSetRules="alertingSetRules",e.DashboardsPatchAllVariables="dashboardsPatchAllVariables",e.DashboardsPatchVariable="dashboardsPatchVariable",e.DashboardsClearVariables="dashboardsClearVariables",e.DashboardsSetEndTime="dashboardsSetEndTime",e.DashboardsSetPollInterval="dashboardsSetPollInterval",e.DashboardsSetTimespan="dashboardsSetTimespan",e.DashboardsVariableOptionsLoaded="dashboardsVariableOptionsLoaded",e.QueryBrowserAddQuery="queryBrowserAddQuery",e.QueryBrowserDuplicateQuery="queryBrowserDuplicateQuery",e.QueryBrowserDeleteAllQueries="queryBrowserDeleteAllQueries",e.QueryBrowserDeleteAllSeries="queryBrowserDeleteAllSeries",e.QueryBrowserDeleteQuery="queryBrowserDeleteQuery",e.QueryBrowserDismissNamespaceAlert="queryBrowserDismissNamespaceAlert",e.QueryBrowserPatchQuery="queryBrowserPatchQuery",e.QueryBrowserRunQueries="queryBrowserRunQueries",e.QueryBrowserSetAllExpanded="queryBrowserSetAllExpanded",e.QueryBrowserSetMetrics="queryBrowserSetMetrics",e.QueryBrowserSetPollInterval="queryBrowserSetPollInterval",e.QueryBrowserSetTimespan="queryBrowserSetTimespan",e.QueryBrowserToggleIsEnabled="queryBrowserToggleIsEnabled",e.QueryBrowserToggleSeries="queryBrowserToggleSeries",e.QueryBrowserToggleAllSeries="queryBrowserToggleAllSeries",e.SetAlertCount="SetAlertCount",e.ToggleGraphs="toggleGraphs"}(n||(n={}));const l=(e,t,a)=>(0,r.action)(n.DashboardsPatchVariable,{key:e,patch:t,perspective:a}),o=(e,t)=>(0,r.action)(n.DashboardsPatchAllVariables,{variables:e,perspective:t}),s=e=>(0,r.action)(n.DashboardsClearVariables,{perspective:e}),i=(e,t)=>(0,r.action)(n.DashboardsSetEndTime,{endTime:e,perspective:t}),c=(e,t)=>(0,r.action)(n.DashboardsSetPollInterval,{pollInterval:e,perspective:t}),m=(e,t)=>(0,r.action)(n.DashboardsSetTimespan,{timespan:e,perspective:t}),d=(e,t,a)=>(0,r.action)(n.DashboardsVariableOptionsLoaded,{key:e,newOptions:t,perspective:a}),u=(e,t="admin")=>(0,r.action)(n.AlertingSetData,{key:e,data:{loaded:!1,loadError:null,data:null,perspective:t}}),p=(e,t,a="admin")=>(0,r.action)(n.AlertingSetData,{key:e,data:{loaded:!0,loadError:null,data:t,perspective:a}}),g=(e,t,a="admin")=>(0,r.action)(n.AlertingSetData,{key:e,data:{loaded:!0,loadError:t,data:null,perspective:a}}),b=(e,t,a="admin")=>(0,r.action)(n.AlertingSetRules,{key:e,data:t,perspective:a}),E=()=>(0,r.action)(n.ToggleGraphs),A=()=>(0,r.action)(n.QueryBrowserAddQuery),h=e=>(0,r.action)(n.QueryBrowserDuplicateQuery,{index:e}),v=()=>(0,r.action)(n.QueryBrowserDeleteAllQueries),_=()=>(0,r.action)(n.QueryBrowserDeleteAllSeries),f=e=>(0,r.action)(n.QueryBrowserDeleteQuery,{index:e}),w=(e,t)=>(0,r.action)(n.QueryBrowserPatchQuery,{index:e,patch:t}),y=()=>(0,r.action)(n.QueryBrowserRunQueries),C=e=>(0,r.action)(n.QueryBrowserSetAllExpanded,{isExpanded:e}),x=e=>(0,r.action)(n.QueryBrowserSetPollInterval,{pollInterval:e}),S=e=>(0,r.action)(n.QueryBrowserSetTimespan,{timespan:e}),N=e=>(0,r.action)(n.QueryBrowserToggleAllSeries,{index:e}),k=e=>(0,r.action)(n.QueryBrowserToggleIsEnabled,{index:e}),B=(e,t)=>(0,r.action)(n.QueryBrowserToggleSeries,{index:e,labels:t})},23115:(e,t,a)=>{a.r(t),a.d(t,{AlertRulesDetailsPage:()=>dl,AlertState:()=>Dr,AlertsDetailsPage:()=>il,Severity:()=>Mr,StateCounts:()=>Ur,StateTimestamp:()=>Pr,alertMessageResources:()=>al,alertStateFilter:()=>kl,default:()=>jl,severityRowFilter:()=>fl});var n=a(37901),r=a(37786),l=a(56050),o=a(78854),s=a(58515),i=a(19990),c=a(78231),m=a(70131),d=a(60042),u=a.n(d),p=a(69396),g=a(29955),b=a(98807),E=a(27206),A=a(31609),h=a(5359),v=a(60182),_=a(49666),f=a(21575),w=a(1453),y=a(23136),C=a(71817),x=a(81228),S=a(74853),N=a(22045),k=a(15150),B=a(92757),q=a(54701),I=a(85657),T=a(10008),Z=a(53516),F=a(46080),D=a(56271),R=a(18170),P=a(60733),L=a(46556),$=a(55630),M=a(32892),G=a(46357),j=a(19847);const U=()=>localStorage.getItem("bridge/last-language"),O=new Intl.DateTimeFormat(U()||void 0,{hour:"numeric",minute:"numeric"}),z=new Intl.DateTimeFormat(U()||void 0,{hour:"numeric",minute:"numeric",second:"numeric"}),Q=new Intl.DateTimeFormat(U()||void 0,{month:"short",day:"numeric"}),V=new Intl.DateTimeFormat(U()||void 0,{month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",year:"numeric"}),W=36e5,Y={w:6048e5,d:864e5,h:W,m:6e4,s:1e3},J=e=>{if(!M.Z(e)||e<0)return"";let t=e,a="";return _.Z(Y,((e,n)=>{const r=Math.floor(t/e);r>0&&(a+=`${r}${n} `,t-=r*e)})),G.Z(a)},H=e=>{try{const t=e.trim().split(/\s+/).map((e=>e.match(/^(\d+)([wdhms])$/)));return j.Z(t,(e=>parseInt(e[1],10)*Y[e[2]]))}catch(e){return 0}},K=D.createContext({}),X=()=>D.createElement("div",null);class ee extends D.Component{constructor(e){super(e),this.state={hasError:!1,error:{message:"",stack:"",name:""},errorInfo:{componentStack:""}}}componentDidCatch(e,t){this.setState({hasError:!0,error:e,errorInfo:t}),console.error("Catched error in a child component:",e,t)}render(){const{hasError:e,error:t,errorInfo:a}=this.state,n=this.props.FallbackComponent||X;return e?D.createElement(n,{title:t.name,componentStack:a.componentStack,errorMessage:t.message,stack:t.stack}):D.createElement(D.Fragment,null,this.props.children)}}const te=(e,t)=>{const a=a=>D.createElement(ee,{FallbackComponent:t},D.createElement(e,{...a}));return a.displayName=`withFallback(${e.displayName||e.name})`,a},ae=e=>"console.alerts/rules-source"===e.type,ne=e=>"console.alerts/rules-chart"===e.type,re=window.SERVER_FLAGS.prometheusBaseURL,le=window.SERVER_FLAGS.prometheusTenancyBaseURL,oe=(e,t=(e.namespace?le:re))=>{if(e.endpoint!==n.PrometheusEndpoint.RULES&&!e.query)return"";const a=(({endpoint:e,endTime:t,timespan:a,samples:r,...l})=>{const o=e===n.PrometheusEndpoint.QUERY_RANGE?((e=Date.now(),t=60,a=36e5)=>{const n=new URLSearchParams;return n.append("start",""+(e-a)/1e3),n.append("end",""+e/1e3),n.append("step",`${Math.ceil(a/t/1e3)}`),n})(t,r,a):new URLSearchParams;return _.Z(l,((e,t)=>e&&o.append(t,e.toString()))),o})(e);return`${t}/${e.endpoint}?${a.toString()}`},se={kind:"ServiceMonitor",label:"ServiceMonitor",labelKey:"public~ServiceMonitor",labelPlural:"ServiceMonitors",labelPluralKey:"public~ServiceMonitors",apiGroup:"monitoring.coreos.com",apiVersion:"v1",abbr:"SM",namespaced:!0,crd:!0,plural:"servicemonitors",propagationPolicy:"Foreground"},ie={kind:"PodMonitor",label:"PodMonitor",labelKey:"public~PodMonitor",labelPlural:"PodMonitors",labelPluralKey:"public~PodMonitors",apiGroup:"monitoring.coreos.com",apiVersion:"v1",abbr:"PM",namespaced:!0,crd:!0,plural:"podmonitors",propagationPolicy:"Foreground"},ce={namespaced:!0,kind:"Pod"},me={kind:"Namespace"},de=({text:e})=>D.createElement("h2",{className:"co-section-heading","data-test-section-heading":e},e);var ue=a(10011);const pe=({href:e,text:t})=>D.createElement("a",{className:"co-external-link",href:e,target:"_blank",rel:"noopener noreferrer"},t),ge=({children:e})=>D.createElement(ue.ZP,{properties:{target:"_blank",rel:"noopener noreferrer"}},e),be=(0,a(37704).lX)(),Ee=e=>new URLSearchParams(window.location.search).get(e),Ae=()=>{const e={},t=new URLSearchParams(window.location.search);for(const[a,n]of t.entries())e[a]=n;return e},he=(e,t)=>{const a=new URLSearchParams(window.location.search);if(a.get(e)!==t){a.set(e,t);const n=new URL(window.location.href);be.replace(`${n.pathname}?${a.toString()}${n.hash}`)}},ve=e=>{const t=new URLSearchParams(window.location.search);let a=!1;if(_.Z(e,((e,n)=>{t.get(n)!==e&&(a=!0,t.set(n,e))})),a){const e=new URL(window.location.href);be.replace(`${e.pathname}?${t.toString()}${e.hash}`)}},_e=e=>{const t=new URLSearchParams(window.location.search);if(t.has(e)){t.delete(e);const a=new URL(window.location.href);be.replace(`${a.pathname}?${t.toString()}${a.hash}`)}};class fe extends Error{constructor(e){super(e),Object.defineProperty(this,"name",{value:new.target.name,enumerable:!1,configurable:!0}),"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error(e).stack,Object.setPrototypeOf(this,new.target.prototype)}}class we extends fe{constructor(e,t){super(`Call to ${e} timed out after ${t}ms.`),this.url=e,this.ms=t}}class ye extends fe{constructor(e){super(`Could not fetch all data. This data are missing: ${e.join(", ")}.`),this.labels=e}}const Ce=a.p+"assets/restricted-sign..svg";var xe=a.t(Ce);const Se=({children:e,className:t})=>D.createElement("div",{className:u()("cos-status-box",t)},e),Ne=({label:e,className:t,message:a,canRetry:n=!0})=>{const{t:l}=(0,P.useTranslation)();return D.createElement(Se,{className:t},D.createElement("div",{className:"pf-u-text-align-center cos-error-title"},y.Z(a)?l("public~Error Loading {{label}}: {{message}}",{label:e,message:a}):l("public~Error Loading {{label}}",{label:e})),n&&D.createElement("div",{className:"pf-u-text-align-center"},D.createElement(P.Trans,{ns:"public"},"Please"," ",D.createElement(r.Button,{type:"button",onClick:window.location.reload.bind(window.location),variant:"link",isInline:!0},"try again"),".")))};Ne.displayName="LoadError";const ke=({className:e})=>D.createElement("div",{className:u()("co-m-loader co-an-fade-in-out",e),"data-test":"loading-indicator"},D.createElement("div",{className:"co-m-loader-dot__one"}),D.createElement("div",{className:"co-m-loader-dot__two"}),D.createElement("div",{className:"co-m-loader-dot__three"}));ke.displayName="Loading";const Be=()=>D.createElement(ke,{className:"co-m-loader--inline"});Be.displayName="LoadingInline";const qe=({className:e,message:t})=>D.createElement(Se,{className:u()("cos-status-box--loading",e)},D.createElement(ke,null),t&&D.createElement("div",{className:"cos-status-box__loading-message"},t));qe.displayName="LoadingBox";const Ie=({label:e})=>{const{t}=(0,P.useTranslation)();return D.createElement(Se,null,D.createElement("div",{"data-test":"empty-message",className:"pf-u-text-align-center"},e?t("public~No {{label}} found",{label:e}):t("public~Not found")))};Ie.displayName="EmptyBox";const Te=({title:e,detail:t,className:a=""})=>D.createElement(Se,{className:a},e&&D.createElement("div",{className:"cos-status-box__title","data-test":"msg-box-title"},e),t&&D.createElement("div",{className:"pf-u-text-align-center cos-status-box__detail","data-test":"msg-box-detail"},t));Te.displayName="MsgBox";const Ze=({message:e})=>{const{t}=(0,P.useTranslation)();return D.createElement("div",null,D.createElement(Se,{className:"pf-u-text-align-center"},D.createElement("img",{className:"cos-status-box__access-denied-icon",src:xe}),D.createElement(Te,{title:t("public~Restricted Access"),detail:t("public~You don't have access to this section due to cluster policy.")})),y.Z(e)&&D.createElement(r.Alert,{isInline:!0,className:"co-alert",variant:"danger",title:t("public~Error details")},e))};Ze.displayName="AccessDenied";const Fe=({label:e,data:t,children:a})=>!t||g.Z(t)?D.createElement("div",{className:"loading-box loading-box__loaded"},D.createElement(Ie,{label:e})):D.createElement("div",{className:"loading-box loading-box__loaded"},a);Fe.displayName="Data";const De=e=>{const{loadError:t,loaded:a,skeleton:n,data:l,...o}=e,{t:s}=(0,P.useTranslation)();if(t){const n=p.Z(t,"response.status");return 404===n?D.createElement("div",{className:"co-m-pane__body"},D.createElement("h1",{className:"co-m-pane__heading co-m-pane__heading--center"},s("public~404: Not Found"))):403===n?D.createElement(Ze,{message:t.message}):t instanceof ye&&!g.Z(l)?D.createElement(Fe,{data:l,...o},D.createElement(r.Alert,{variant:"info",isInline:!0,title:s("public~{{labels}} content is not available in the catalog at this time due to loading failures.",{labels:new Intl.ListFormat(localStorage.getItem("bridge/last-language")||"en",{style:"long",type:"conjunction"}).format(t.labels)})}),e.children):a&&t instanceof we?D.createElement(Fe,{data:l,...o},D.createElement("div",{className:"co-m-timeout-error text-muted"},s("public~Timed out fetching new data. The data below is stale.")),e.children):D.createElement(Ne,{message:t.message,label:e.label,className:"loading-box loading-box__errored"})}return a?D.createElement(Fe,{data:l,...o}):n?D.createElement(D.Fragment,null,n):D.createElement(qe,{className:"loading-box loading-box__loading"})};De.displayName="StatusBox";var Re=a(31185),Pe=a(94146),Le=a(87347),$e=a(1679),Me=a(44108),Ge=a(91670),je=a(3548),Ue=a(65657),Oe=a(91329),ze=a(6524),Qe=a(78641),Ve=a(46673),We=a(62540),Ye=a(70067),Je=a(91985);const He=e=>"console.dashboards/datasource"===e.type,Ke=({message:e,title:t})=>{const{t:a}=(0,P.useTranslation)();return D.createElement(r.Alert,{isInline:!0,className:"co-alert co-alert--scrollable",title:t||a("plugin__monitoring-plugin~An error occurred"),variant:"danger"},e)};var Xe=a(48801),et=a(98784);const tt=e=>{const[t,a]=D.useState(e);return[t,D.useCallback((()=>a((e=>!e))),[]),D.useCallback((()=>a(!0)),[]),D.useCallback((()=>a(!1)),[])]},at="OFF_KEY",nt=({id:e,interval:t,setInterval:a})=>{const[n,l,,o]=tt(!1),{t:s}=(0,P.useTranslation)("plugin__monitoring-plugin"),i=D.useCallback((e=>a(e===at?null:H(e))),[a]),c={[at]:s("Refresh off"),"15s":s("{{count}} second",{count:15}),"30s":s("{{count}} second",{count:30}),"1m":s("{{count}} minute",{count:1}),"5m":s("{{count}} minute",{count:5}),"15m":s("{{count}} minute",{count:15}),"30m":s("{{count}} minute",{count:30}),"1h":s("{{count}} hour",{count:1}),"2h":s("{{count}} hour",{count:2}),"1d":s("{{count}} day",{count:1})},m=null===t?at:J(t);return D.createElement(r.Dropdown,{dropdownItems:et.map(c,((e,t)=>D.createElement(r.DropdownItem,{component:"button",key:t,onClick:()=>i(t)},e))),isOpen:n,onSelect:o,toggle:D.createElement(r.DropdownToggle,{className:"monitoring-dashboards__dropdown-button",id:`${e}-dropdown`,onToggle:l},c[m]),className:"monitoring-dashboards__variable-dropdown"})};var rt=a(87268),lt=a(38735),ot=a(82010),st=a(15219),it=a(22701),ct=a(65029);const mt={},dt={numeric:{units:["","k","m","b"],space:!1,divisor:1e3},binaryBytes:{units:["B","KiB","MiB","GiB","TiB","PiB"],space:!0,divisor:1024},SI:{units:["","k","M","G","T","P","E"],space:!1,divisor:1e3},decimalBytesPerSec:{units:["Bps","KBps","MBps","GBps","TBps","PBps","EBps"],space:!0,divisor:1e3},packetsPerSec:{units:["pps","kpps"],space:!0,divisor:1e3},seconds:{units:["ns","μs","ms","s"],space:!0,divisor:1e3}},ut=(e,t,a,n,r)=>{const l=n?t.indexOf(n):0,o=t.slice(l);if(r||""===r){const t=o.indexOf(r);if(-1!==t)return{value:e/a**t,unit:r}}let s=o.shift();for(;e>=a&&o.length>0;)e/=a,s=o.shift();return{value:e,unit:s}},pt=e=>e<1?3:e<100?2:1,gt=mt.round=(e,t)=>{if(!isFinite(e))return 0;const a=Math.pow(10,t||pt(e));return Math.round(e*a)/a},bt=mt.humanize=(e,t,a=!1,n,r)=>{const l=(e=>{const t=dt[e];return it.Z(t)?t:{units:[],space:!1,divisor:1e3}})(t);isFinite(e)||(e=0);let o=ut(e,l.units,l.divisor,n,r);a&&(o.value=gt(o.value),o=ut(o.value,l.units,l.divisor,o.unit,r));const s=((e,t)=>{const a=pt(e),{locales:n,...r}=ct.Z(void 0,{maximumFractionDigits:a});return isFinite(e)&&0!==e||(e=0),Intl.NumberFormat(n,r).format(e)})(o.value);return{string:l.space?`${s} ${o.unit}`:s+o.unit,unit:o.unit,value:o.value}},Et=(e,t,a)=>bt(e,"numeric",!0,t,a),At=(e,t,a)=>bt(e,"seconds",!0,t,a),ht=()=>{const e=(0,D.useRef)(null),[t,a]=(0,D.useState)(),n=e?.current?.clientWidth;return(0,D.useEffect)((()=>{const t=()=>a(e?.current?.clientWidth);return window.addEventListener("resize",t),window.addEventListener("sidebar_toggle",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("sidebar_toggle",t)}}),[]),(0,D.useEffect)((()=>{a(n)}),[n]),[e,t]},vt=({height:e=180,loading:t=!1})=>{const{t:a}=(0,P.useTranslation)();return D.createElement("div",{style:{alignItems:"center",display:"flex",height:e,justifyContent:"center",padding:"5px",width:"100%",flexGrow:1}},t?D.createElement("div",{className:"skeleton-chart","data-test":"skeleton-chart"}):D.createElement("div",{className:"text-secondary","data-test":"datapoints-msg"},a("public~No datapoints found.")))},_t={bar:{style:{labels:{textAnchor:"end"}}},dependentAxis:{style:{axis:{stroke:"none"},tickLabels:{fill:"none"}}},independentAxis:{style:{axis:{stroke:"none"},tickLabels:{textAnchor:"start"}}}},ft=(0,rt.jp)(lt.nz.blue,lt.py.light,_t),wt=({barSpacing:e=15,barWidth:t=10,data:a=[],LabelComponent:n,loading:r=!1})=>{const[l,o]=ht(),s=.3333333333333333*o,i={bottom:e,left:0,right:Math.min(100,s),top:0};return D.createElement("div",{ref:l,className:"graph-wrapper graph-wrapper__horizontal-bar"},a.length?a.map(((e,r)=>D.createElement(D.Fragment,{key:r},D.createElement("div",{className:"graph-bar__label"},n?D.createElement(n,{title:e.x,metric:e.metric}):String(e.x)),D.createElement("div",{className:"graph-bar__chart"},D.createElement(ot.B,{barWidth:t,data:[e],horizontal:!0,labelComponent:D.createElement(st.Df,{x:o,textAnchor:_t.bar.style.labels.textAnchor}),theme:ft,height:t+i.bottom,width:o,domain:{y:[0,a[0].y]},padding:i}))))):D.createElement(vt,{loading:r}))},yt=({barSpacing:e,barWidth:t,customDataSource:a,delay:r,humanize:l=Et,LabelComponent:o,metric:s,query:i})=>{const[c,,m]=(0,n.usePrometheusPoll)({customDataSource:a,delay:r,endpoint:n.PrometheusEndpoint.QUERY,query:i}),d=((e,t,a)=>p.Z(e,"data.result",[]).map((e=>{const n=parseFloat(p.Z(e,"value[1]"));return{label:a?a(n).string:null,x:p.Z(e,["metric",t],""),y:n,metric:e.metric}})))(c,s,l);return D.createElement(wt,{barSpacing:e,barWidth:t,data:d,LabelComponent:o,loading:m,query:i})},Ct=({metric:e})=>D.createElement(D.Fragment,null,Le.Z(e).join()),xt=({customDataSource:e,pollInterval:t,query:a})=>D.createElement(yt,{barSpacing:5,barWidth:8,customDataSource:e,delay:t,LabelComponent:Ct,query:a});var St=a(76482),Nt=a(1931),kt=a(51127),Bt=a(1095),qt=a(46118),It=a(26338),Tt=a(46322),Zt=a(63247),Ft=a(98064),Dt=a(56878),Rt=a(74935),Pt=a(25314),Lt=a(43344),$t=a(70965),Mt=a(48276),Gt=a(98194),jt=a(33073),Ut=a(15646),Ot=a(59448),zt=a(35499),Qt=a(13544),Vt=a(43672);const Wt=(e,t,...a)=>{const n=(0,D.useRef)(null);(0,D.useEffect)((()=>{n.current=e}),[e]),(0,D.useEffect)((()=>{const e=()=>n.current();if(e(),t){const a=setInterval(e,t);return()=>clearInterval(a)}}),[t,...a])},Yt=(e,t=2,a="short")=>{const n=Number(e);if(A.Z(e)||isNaN(n))return e||"-";switch(a){case"percentunit":return Intl.NumberFormat(void 0,{style:"percent",maximumFractionDigits:t,minimumFractionDigits:t}).format(n);case"bytes":return(r=n,bt(r,"binaryBytes",!0,undefined,undefined)).string;case"Bps":return((e,t,a)=>bt(e,"decimalBytesPerSec",!0,void 0,void 0))(n).string;case"pps":return((e,t,a)=>bt(e,"packetsPerSec",!0,void 0,void 0))(n).string;case"ms":return At(n,"ms").string;case"s":return At(1e3*n,"ms").string;default:return Et(n).string}var r},Jt={padding:5,fontFamily:"var(--pf-chart-global--FontFamily)",letterSpacing:"var(--pf-chart-global--letter-spacing)",fill:"var(--pf-global--Color--200)"},Ht={chart:{padding:{bottom:0,left:0,right:0,top:0}},dependentAxis:{style:{axis:{stroke:"none"},grid:{stroke:"#EDEDED"},tickLabels:Jt}},independentAxis:{style:{ticks:{size:5,strokeWidth:1,stroke:a(58033).yz.value},tickLabels:Object.assign({},Jt,{padding:2}),grid:{stroke:"none"}}},line:{style:{data:{opacity:.75}}}},Kt=(0,rt.jp)(lt.nz.multiUnordered,lt.py.light,Ht);var Xt=a(19610);const ea=["5m","15m","30m","1h","2h","6h","12h","1d","2d","1w","2w"],ta=Kt.line.colorScale,aa=e=>(e<0?"-":"")+(e=>0===e||.001<=e&&e<1e23?((e,t,a)=>bt(e,"SI",!0,void 0,void 0))(e).string:e.toExponential(1))(Math.abs(e)),na=e=>["ms","s","bytes","Bps","pps"].includes(e)?t=>Yt(String(t),void 0,e):aa,ra=({error:e,title:t="An error occurred"})=>D.createElement(r.Alert,{isInline:!0,className:"co-alert",title:t,variant:"danger"},p.Z(e,"json.error",e.message)),la=({children:e,title:t})=>D.createElement("div",{className:"query-browser__wrapper graph-empty-state"},D.createElement(r.EmptyState,{variant:r.EmptyStateVariant.full},D.createElement(r.EmptyStateIcon,{icon:Qt.y3}),D.createElement(r.Title,{headingLevel:"h2",size:"md"},t),D.createElement(r.EmptyStateBody,null,e))),oa=D.memo((({defaultSpanText:e,onChange:t,span:a,hasReducedResolution:n})=>{const{t:l}=(0,P.useTranslation)("plugin__monitoring-plugin"),[o,s]=D.useState(!0),[i,c]=D.useState(J(a)),[m,d,,u]=tt(!1);D.useEffect((()=>{c(J(a))}),[a]);const p=D.useCallback(St.Z(t,400),[t]),g=(e,n=!1)=>{const r=H(e),l=r>0;s(l),c(e),l&&r!==a&&(n?p:t)(r)},b=ea.map((e=>D.createElement(r.DropdownItem,{className:"query-browser__span-dropdown-item",key:e,onClick:()=>g(e,!0)},e)));return D.createElement(D.Fragment,null,D.createElement(r.InputGroup,{className:"query-browser__span"},D.createElement(r.TextInput,{"aria-label":l("graph timespan"),className:"query-browser__span-text",validated:o?"default":"error",onChange:e=>g(e,!0),type:"text",value:i}),D.createElement(r.Dropdown,{dropdownItems:b,isOpen:m,onSelect:u,position:r.DropdownPosition.right,toggle:D.createElement(r.DropdownToggle,{"aria-label":l("graph timespan"),onToggle:d})})),D.createElement(r.Button,{className:"query-browser__inline-control",onClick:()=>g(e),type:"button",variant:"tertiary"},l("Reset zoom")),n&&D.createElement(r.Alert,{isInline:!0,isPlain:!0,className:"query-browser__reduced-resolution",title:l("Displaying with reduced resolution due to large dataset."),variant:"info",truncateTitle:1}))})),sa=te((({activePoints:e,center:t,height:a,style:n,width:r,x:l})=>{const o=e?.[0]?.x;if(!Nt.Z(o)||!M.Z(l))return null;if(Math.abs(l-t.x)>r/15)return null;const s=l+85,i=r-l+45,c=s>i,m=Math.min(c?s:i,400),d=[];e.forEach((({_y1:e,y:t},a)=>{const r=e??t;if(d.length<20||d[19].total<r){const e={color:n[a]?.fill,labels:n[a]?.labels,name:n[a]?.name,total:r,value:na(n[a]?.units)(t)};d.splice(kt.Z(d,e,(e=>-e.total)),0,e)}}));const p=d.slice(0,20),b=k.Z(Bt.Z($e.Z(w.Z(p,(e=>e.labels?Object.keys(e.labels):[]))),"__name__"),[e=>-$e.Z(p.map((t=>t.labels[e]))).length,e=>e.length]);return D.createElement(D.Fragment,null,D.createElement(Vt.V,null,D.createElement("foreignObject",{height:400,width:m,x:c?l-m:l,y:t.y-200},D.createElement("div",{className:u()("query-browser__tooltip-wrap",{"query-browser__tooltip-wrap--left":c})},D.createElement("div",{className:"query-browser__tooltip-arrow"}),D.createElement("div",{className:"query-browser__tooltip"},D.createElement("div",{className:"query-browser__tooltip-time"},V.format(o)),p.map(((e,t)=>{return D.createElement("div",{className:"query-browser__tooltip-series",key:t},D.createElement("div",{className:"query-browser__series-btn",style:{backgroundColor:e.color}}),D.createElement("div",{className:"co-nowrap co-truncate"},(a=e,y.Z(a.name)?a.name:g.Z(a.labels)?"{}":`${a.labels.__name__??""}{${qt.Z(b,Object.keys(a.labels)).map((e=>`${e}=${a.labels[e]}`)).join(",")}}`)),D.createElement("div",{className:"query-browser__tooltip-value"},e.value));var a})))))),D.createElement("line",{className:"query-browser__tooltip-line",x1:l,x2:l,y1:"0",y2:a}))})),ia=D.createElement(Lt.H,{activateData:!1,labelComponent:D.createElement(sa,null),labels:()=>" ",mouseFollowTooltips:!0,voronoiDimension:"x",voronoiPadding:0}),ca=({children:e})=>{const t=e?.[0]?.[0]?.props?.width??"100%";return D.createElement("foreignObject",{height:75,width:"100%",y:245},D.createElement("div",{className:"monitoring-dashboards__legend-wrap horizontal-scroll"},D.createElement("svg",{width:t},e)))},ma=D.createElement((()=>null),null),da=(e,t)=>[e-t,e],ua=D.memo((({allSeries:e,disabledSeries:t,fixedXDomain:a,formatSeriesTitle:n,isStack:r,showLegend:l,span:o,units:s,width:i})=>{const{t:c}=(0,P.useTranslation)("plugin__monitoring-plugin"),m=[],d=[],u=[],p=[],[b,E]=D.useState(a||da(Date.now(),o));D.useEffect((()=>{E(a||da(Date.now(),o))}),[e,o,a]);const A={x:b,y:void 0};if(_.Z(e,((e,a)=>{_.Z(e,(([e,r])=>{if(m.push(Z.Z(t?.[a],(t=>It.Z(t,e)))?null:r),n){const t=n(e,a);p.push({name:t}),d.push(t)}else u.push(e)}))})),!m.some(Array.isArray))return D.createElement(vt,null);let h=na(s);if(r){const t=F.Z(e,(e=>F.Z(e,(([,e])=>F.Z(e,{y:0})))));t&&(A.y=[0,1])}else{const e=e=>Tt.Z(e,"y"),t=e=>Zt.Z(e,"y");let a=e(m.map(e))?.y??0,n=t(m.map(t))?.y??0;0===a&&0===n?(a=0,n=1):a>0&&n>0?a=0:a<0&&n<0&&(n=0),A.y=[a,n],Math.abs(n-a)<.005&&(h=e=>0===e?"0":e.toExponential(1))}const v=Math.round(i/100),f=o<6e4*v,w=r?$t.K:Mt.G,y=r?Gt.A:jt.m;return D.createElement(Ut.k,{containerComponent:ia,ariaTitle:c("query browser chart"),domain:A,domainPadding:{y:1},height:200,scale:{x:"time",y:"linear"},theme:Kt,width:i},D.createElement(Ot.C,{tickCount:v,tickFormat:e=>o>H("1d")?`${Q.format(e)}\n${O.format(e)}`:f?z.format(e):O.format(e)}),D.createElement(Ot.C,{crossAxis:!1,dependentAxis:!0,tickComponent:ma,tickCount:6,tickFormat:h}),D.createElement(w,null,m.map(((e,t)=>{if(null===e)return null;const a=ta[t%ta.length],n={data:{[r?"fill":"stroke"]:a},labels:{fill:a,labels:u[t],name:d[t],units:s}};return D.createElement(y,{data:e,groupComponent:D.createElement("g",null),key:t,name:`series-${t}`,style:n})}))),l&&!g.Z(p)&&D.createElement(zt.Qk,{data:p,groupComponent:D.createElement(ca,null),gutter:30,itemsPerRow:4,orientation:"vertical",style:{labels:{fontSize:11,fill:"var(--pf-global--Color--100)"}},symbolSpacer:4}))})),pa=(e,t,a,n)=>{const r=E.Z(e,(e=>{const t=Number(e[1]);return{x:new Date(1e3*e[0]),y:Number.isNaN(t)?n:t}})),l=Number(p.Z(r,"[0].x")),o=Number(p.Z(Ft.Z(r),"x")),s=a/t;return Dt.Z(l,o,s).forEach(((e,t)=>{const a=new Date(e);p.Z(r,[t,"x"])>a&&r.splice(t,0,{x:a,y:null})})),r},ga=({allSeries:e,disabledSeries:t,fixedXDomain:a,formatSeriesTitle:n,isStack:r,onZoom:l,showLegend:o,span:s,units:i,width:c})=>{const[m,d]=D.useState(!1),[u,g]=D.useState(0),[b,E]=D.useState(0),A=m?{onKeyDown:e=>{"Escape"===e.key&&(e.preventDefault(),d(!1))},onMouseMove:e=>{E(e.clientX-e.currentTarget.getBoundingClientRect().left)},onMouseUp:e=>{d(!1);const t=Math.min(u,b),n=Math.max(u,b);if(n===t)return;const r=e.currentTarget.getBoundingClientRect().width,o=p.Z(a,"[0]",Date.now()-s);let i=o+s*t/r,c=o+s*n/r,m=c-i;if(m<3e4){m=3e4;const e=(i+c)/2;i=e-m/2,c=e+m/2}l(i,c)},tabIndex:-1}:{onMouseDown:e=>{d(!0);const t=e.clientX-e.currentTarget.getBoundingClientRect().left;g(t),E(t)}};return D.createElement("div",{className:"query-browser__zoom",...A},m&&D.createElement("div",{className:"query-browser__zoom-overlay",style:{left:Math.min(u,b),width:Math.abs(u-b)}}),D.createElement(ua,{allSeries:e,disabledSeries:t,fixedXDomain:a,formatSeriesTitle:n,isStack:r,showLegend:o,span:s,units:i,width:c}))},ba=()=>D.createElement("div",{className:"query-browser__loading"},D.createElement(Be,null)),Ea=e=>Rt.Z(Math.round(e/5e3),10,300),Aa=te((({customDataSource:e,defaultSamples:t,defaultTimespan:a=H("30m"),disabledSeries:l,disableZoom:o,filterLabels:s,fixedEndTime:i,formatSeriesTitle:c,GraphLink:m,hideControls:d,isStack:b=!1,namespace:A,onZoom:h,pollInterval:v,queries:f,showLegend:w,showStackedControl:y=!1,timespan:x,units:S})=>{const{t:N}=(0,P.useTranslation)("plugin__monitoring-plugin"),k=(0,L.useSelector)((({observe:e})=>!!e.get("hideGraphs"))),B=(0,L.useSelector)((({observe:e})=>v??e.getIn(["queryBrowser","pollInterval"]))),q=(0,L.useSelector)((({observe:e})=>e.getIn(["queryBrowser","lastRequestTime"]))),I=(0,L.useDispatch)(),T=ea.find((e=>H(e)>=a)),[F,R]=D.useState(x||H(T)),$=t||Ea(F),[M,G]=D.useState(),[U,O]=D.useState(),[z,Q]=D.useState(!1),[V,W]=D.useState(null),[Y,J]=D.useState($),[K,X]=D.useState(!0),[ee,te]=ht(),ae=M?.[1],ne=(0,Xe.b)(),[re,le]=D.useState(b),se=j.Z(V,"length")<=50;let ie;D.useEffect((()=>{x&&(R(x),J(t||Ea(x)))}),[t,x]),D.useEffect((()=>{W(null),i&&G(da(i,F))}),[i,F]),D.useEffect((()=>{i||G(void 0)}),[i]),D.useEffect((()=>{I((0,Re.qw)())}),[I,A]),ie=ae||k||null===B?null:B>0?B:Math.max(F/120,1e4);const ce=Pt.Z(f,g.Z).join();Wt((()=>{if(k)return;const t=Date.now(),a=(0,Xt.Yf)(F,ae||t),r=E.Z(f,(t=>{if(g.Z(t))return Promise.resolve([]);{const r=E.Z(a,(r=>ne(oe({endpoint:n.PrometheusEndpoint.QUERY_RANGE,endTime:r.endTime,namespace:A,query:t,samples:Math.ceil(Y/a.length),timeout:"60s",timespan:r.duration-1},e?.basePath))));return Promise.all(r).then((e=>{const t=E.Z(e,"data.result").reduce(((e,t)=>(t.forEach((t=>{const a=e.findIndex((e=>JSON.stringify(e.metric)===JSON.stringify(t.metric)));-1===a?e.push(t):e[a].values=e[a].values.concat(t.values)})),e)),[]),a=e.at(0);return a?(a.data.result=t,a):[]}))}}));return Promise.all(r).then((e=>{const t=E.Z(e,"data.result"),a=j.Z(t,(e=>j.Z(e,"values.length")));if(a>1e4&&10===Y)return void Q(!0);Q(!1);const n=Rt.Z(Math.floor(6e3*Y/a),10,$);if(Math.abs(n-Y)/Y>.2||n!==Y&&(n===$||10===n))J(n);else{const e=E.Z(t,((e,t)=>E.Z(e,(({metric:e,values:a})=>{if(Z.Z(s,((t,a)=>C.Z(e,a)&&e[a]!==t)))return[];{let n=null;return b&&Z.Z(a,(e=>Number.isNaN(Number(e[1]))))&&(console.warn("Invalid response values for stacked graph converted to 0 for query: ",f[t]),n=0),[e,pa(a,Y,F,n)]}}))));W(e),_.Z(t,((e,t)=>I((0,Re.y9)(t,{series:e?E.Z(e,"metric"):void 0})))),X(!1)}O(void 0)})).catch((e=>{"AbortError"!==e.name&&(O(e),X(!1))}))}),ie,ae,s,A,ce,Y,F,q),D.useLayoutEffect((()=>X(!0)),[ae,A,ce,Y,F]);const me=D.useCallback((e=>{W(null),G(void 0),R(e),I((0,Re.xu)(e)),J(t||Ea(e))}),[t,I]),de=p.Z(U,"json.error","").match(/invalid expression type "range vector"/);if(k)return D.createElement(D.Fragment,null,U&&!de&&D.createElement(ra,{error:U}),D.createElement("div",{className:"query-browser__wrapper query-browser__wrapper--hidden"},D.createElement("div",{className:"graph-wrapper graph-wrapper--query-browser"},D.createElement("div",{ref:ee,style:{width:"100%"}}))));if(de)return D.createElement(la,{title:N("Ungraphable results")},N("Query results include range vectors, which cannot be graphed. Try adding a function to transform the data."));if(U?.json?.error?.match(/invalid expression type "string"/))return D.createElement(la,{title:N("Ungraphable results")},N("Query result is a string, which cannot be graphed."));if(z)return D.createElement(la,{title:N("Ungraphable results")},N("The resulting dataset is too large to graph."));const ue=!V||V.every((e=>0===e.length)),pe=!ue&&Y<$&&!K;return D.createElement("div",{className:u()("query-browser__wrapper",{"graph-empty-state":ue,"graph-empty-state__loaded":ue&&!K})},d?D.createElement(D.Fragment,null,K&&D.createElement(ba,null)):D.createElement("div",{className:"query-browser__controls"},D.createElement("div",{className:"query-browser__controls--left"},D.createElement(oa,{defaultSpanText:T,onChange:me,span:F,hasReducedResolution:pe}),K&&D.createElement(ba,null)),D.createElement("div",{className:"query-browser__controls--right"},m&&D.createElement(m,null),se&&y&&D.createElement(r.Checkbox,{id:"stacked",isChecked:re,"data-checked-state":re,label:N("Stacked"),onChange:e=>le(e)}))),D.createElement("div",{className:u()("graph-wrapper graph-wrapper--query-browser",{"graph-wrapper--query-browser--with-legend":w&&!!c})},D.createElement("div",{ref:ee,style:{width:"100%"}},U&&D.createElement(ra,{error:U}),ue&&!K&&D.createElement(vt,null),!ue&&te>0&&D.createElement(D.Fragment,null,o?D.createElement(ua,{allSeries:V,disabledSeries:l,fixedXDomain:M,formatSeriesTitle:c,isStack:se&&re,showLegend:w,span:F,units:S,width:te}):D.createElement(ga,{allSeries:V,disabledSeries:l,fixedXDomain:M,formatSeriesTitle:c,isStack:se&&re,onZoom:(e,a)=>{W(null),G([e,a]),R(a-e),J(t||Ea(a-e)),h?.(e,a)},showLegend:w,span:F,units:S,width:te})))))}));var ha=a(90046);const va="ALL_OPTION_KEY",_a=e=>e?"dev":"admin",fa=(e,t,a)=>{const n=et.find(e,{name:t})?.data,r={};return et.each(n?.templating?.list,(e=>{if("query"===e.type||"interval"===e.type){let t=Ee(e.name);null===t&&(t=et.find(e.options,{selected:!0})?.value),void 0===t&&e.includeAll&&(t=va),r[e.name]=(0,ha.Map)({datasource:e.datasource,includeAll:!!e.includeAll,isHidden:!(!a||"namespace"!==e.name)||0!==e.hide,isLoading:a?"query"===e.type&&!a:"query"===e.type,options:et.map(e.options,"value"),query:"query"===e.type?e.query:void 0,value:a&&"namespace"===e.name?a:t||e.options?.[0]?.value})}})),r},wa=({customDataSource:e,formatSeriesTitle:t,isStack:a,pollInterval:n,queries:r,showLegend:l,units:o,onZoomHandle:s,namespace:i})=>{const c=(0,L.useDispatch)(),m=_a(i),d=(0,L.useSelector)((({observe:e})=>e.getIn(["dashboards",m,"endTime"]))),u=(0,L.useSelector)((({observe:e})=>e.getIn(["dashboards",m,"timespan"]))),p=D.useCallback(((e,t)=>{c((0,Re.lL)(t,m)),c((0,Re.Zn)(t-e,m)),s?.(t-e,t)}),[m,c,s]);return D.createElement(Aa,{customDataSource:e,defaultSamples:60,fixedEndTime:d,formatSeriesTitle:t,hideControls:!0,isStack:a,onZoom:p,pollInterval:n,queries:r,showLegend:l,timespan:u,units:o,namespace:i})},ya={"super-light-blue":"blue-100","light-blue":"blue-200",blue:"blue-300","semi-dark-blue":"blue-400","dark-blue":"blue-500","super-light-green":"green-100","light-green":"green-200",green:"green-300","semi-dark-green":"green-400","dark-green":"green-500","super-light-orange":"orange-100","light-orange":"orange-200",orange:"orange-300","semi-dark-orange":"orange-400","dark-orange":"orange-500","super-light-purple":"purple-100","light-purple":"purple-200",purple:"purple-300","semi-dark-purple":"purple-400","dark-purple":"purple-500","super-light-red":"red-100","light-red":"red-200",red:"red-300","semi-dark-red":"red-400","dark-red":"red-500","super-light-yellow":"gold-100","light-yellow":"gold-200",yellow:"gold-300","semi-dark-yellow":"gold-400","dark-yellow":"gold-500"},Ca=({children:e})=>D.createElement(r.Bullseye,{className:"monitoring-dashboards__single-stat"},e),xa=({customDataSource:e,namespace:t,panel:a,pollInterval:r,query:l})=>{const{decimals:o,format:s,options:i,postfix:c,postfixFontSize:m,prefix:d,prefixFontSize:u,valueFontSize:g,valueMaps:b}=a,[E,A]=D.useState(),[h,v]=D.useState(!0),[_,f]=D.useState(),w=D.useCallback((0,Xe.b)(),[]),y=oe({endpoint:n.PrometheusEndpoint.QUERY,query:l,namespace:t},e?.basePath);Wt((()=>{y&&w(y).then((e=>{A(void 0),v(!1),f(p.Z(e,"data.result[0].value[1]"))})).catch((e=>{"AbortError"!==e.name&&(A(p.Z(e,"json.error",e.message)),v(!1),f(void 0))}))}),r,l);const C=b?.filter((e=>"="===e.op)),x=void 0===_?C?.find((e=>"null"===e.value)):C?.find((e=>e.value===_));if(h)return D.createElement(Be,null);if(E)return D.createElement(Ke,{message:E});let S;const N=i?.fieldOptions?.thresholds;if(N&&void 0!==_){const e=kt.Z(N,{value:Number(_)},(e=>Number(e.value)))-1;k=N[e]?.color,S=ya[k]?`var(--pf-chart-color-${ya[k]})`:void 0}var k;return D.createElement(Ca,null,d&&D.createElement("span",{style:{color:S,fontSize:u}},d),D.createElement("span",{style:{color:S,fontSize:g}},x?x.text:Yt(_,o,s)),c&&D.createElement("span",{style:{color:S,fontSize:m}},c))},Sa=[10,20,50,100,200,500].map((e=>({title:e.toString(),value:e}))),Na=({firstIndex:e,itemCount:t,itemsTitle:a,lastIndex:n})=>{const{t:r}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement(P.Trans,{t:r},D.createElement("b",null,{firstIndex:e}," - ",{lastIndex:n})," ","of ",D.createElement("b",null,{itemCount:t})," ",{itemsTitle:a})},ka=({itemCount:e,page:t,perPage:a,perPageOptions:n=Sa,setPage:l,setPerPage:o})=>{const{t:s}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement(r.Pagination,{itemCount:e,onPerPageSelect:(e,n)=>{const r=(t-1)*a;l(Math.floor(r/n)+1),o(n)},onSetPage:(e,t)=>l(t),page:t,perPage:a,perPageOptions:n,variant:r.PaginationVariant.bottom,toggleTemplate:Na,titles:{items:"",page:"",itemsPerPage:s("Items per page"),perPageSuffix:s("per page"),toFirstPage:s("Go to first page"),toPreviousPage:s("Go to previous page"),toLastPage:s("Go to last page"),toNextPage:s("Go to next page"),optionsToggle:s("Items per page"),currPage:s("Current page"),paginationTitle:s("Pagination"),ofWord:s("of")}})},Ba=[5,10,20,50,100].map((e=>({title:e.toString(),value:e}))),qa=({customDataSource:e,panel:t,pollInterval:a,queries:l,namespace:o})=>{const{t:s}=(0,P.useTranslation)("plugin__monitoring-plugin"),[i,c]=D.useState(),[d,u]=D.useState(!0),[b,h]=D.useState(),[v,_]=D.useState(1),[f,w]=D.useState(5),[y,C]=D.useState({index:0,direction:"asc"}),x=D.useCallback((0,Xe.b)(),[]);if(Wt((()=>{const a=E.Z(l,(t=>g.Z(t)?Promise.resolve():x(oe({endpoint:n.PrometheusEndpoint.QUERY,query:t,namespace:o},e?.basePath))));Promise.all(a).then((e=>{c(void 0),u(!1),h(e.reduce(((e,a,n)=>{if(a){const r=t.targets[n].refId;a.data.result.forEach((({metric:t,value:a})=>{const n=Object.values(t).join("-");e[n]||(e[n]={...t}),e[n][`Value #${r}`]=a[1]||""}))}return e}),{}))})).catch((e=>{"AbortError"!==e.name&&(c(p.Z(e,"json.error",e.message)),u(!1),h(void 0))}))}),a,l),d)return D.createElement("div",{className:"loading-skeleton--table"});if(i)return D.createElement(Ke,{message:i});if(g.Z(t.styles))return D.createElement(Ke,{message:s("panel.styles attribute not found")});if(g.Z(b))return D.createElement(r.EmptyState,{variant:r.EmptyStateVariant.xs},D.createElement(r.EmptyStateBody,null,s("No data found")));const S=(e=>{const t=[],a=[];return e.forEach((e=>{"hidden"!==e.type&&!e.pattern.startsWith("/")&&e.alias&&(e.pattern.startsWith("Value #")?a.push(e):"Value"===e.pattern?a.push({...e,pattern:"Value #A"}):t.push({...e,className:"monitoring-dashboards__label-column-header"}))})),[...t,...a]})(t.styles),N=T.Z(b,[e=>{const{pattern:t,type:a}=S[y.index],n=e[t];if("number"!==a)return n;if(A.Z(n))return Number.MIN_VALUE;const r=Number(n);return M.Z(r)?r:n}],[y.direction]),k=N.slice((v-1)*f,v*f).map((e=>S.reduce(((t,{type:a,decimals:n=2,pattern:r,unit:l=""})=>{const o=e[r];return"number"===a?t.push(Yt(o,n,l)):t.push(o||"-"),t}),[]))),B=S.map((({alias:e,className:t})=>({title:e,transforms:[m.sortable],...t?{props:{className:t}}:{}})));return D.createElement(D.Fragment,null,D.createElement("div",{className:"monitoring-dashboards__table-container"},D.createElement(m.Table,{"aria-label":s("query results table"),cells:B,className:"monitoring-dashboards__table",gridBreakPoint:m.TableGridBreakpoint.none,onSort:(e,t,a)=>C({index:t,direction:a}),rows:k,sortBy:y,variant:m.TableVariant.compact},D.createElement(m.TableHeader,null),D.createElement(m.TableBody,null))),D.createElement(ka,{itemCount:N.length,page:v,perPage:f,perPageOptions:Ba,setPage:_,setPerPage:w}))},Ia=e=>e<10?`0${e}`:e,Ta=e=>`${e.getFullYear()}-${Ia(e.getMonth()+1)}-${Ia(e.getDate())}`,Za=e=>new Intl.DateTimeFormat("en",{hour:"numeric",minute:"numeric",hourCycle:"h23"}).format(e),Fa=({activePerspective:e,isOpen:t,setClosed:a})=>{const{t:n}=(0,P.useTranslation)("plugin__monitoring-plugin"),l=(0,L.useDispatch)(),o=(0,L.useSelector)((({observe:t})=>t.getIn(["dashboards",e,"endTime"]))),s=(0,L.useSelector)((({observe:t})=>t.getIn(["dashboards",e,"timespan"]))),i=new Date,c=o&&s?new Date(o-s):void 0,[m,d]=D.useState(Ta(c??i)),[u,p]=D.useState(c?Za(c):"00:00"),[g,b]=D.useState(Ta(o?new Date(o):i)),[E,A]=D.useState(o?Za(new Date(o)):"23:59");return D.createElement(r.Modal,{hasNoBodyWrapper:!0,isOpen:t,position:"top",showClose:!1,title:n("Custom time range"),variant:r.ModalVariant.small},D.createElement(r.Flex,{className:"custom-time-range-modal",direction:{default:"column"}},D.createElement(r.FlexItem,{spacer:{default:"spacerNone"}},D.createElement("label",null,n("From"))),D.createElement(r.Flex,null,D.createElement(r.FlexItem,null,D.createElement(r.DatePicker,{onChange:(e,t)=>d(t),value:m})),D.createElement(r.FlexItem,null,D.createElement(r.TimePicker,{is24Hour:!0,onChange:(e,t)=>p(t),time:u}))),D.createElement(r.FlexItem,{spacer:{default:"spacerNone"}},D.createElement("label",null,n("To"))),D.createElement(r.Flex,null,D.createElement(r.FlexItem,null,D.createElement(r.DatePicker,{onChange:(e,t)=>b(t),value:g})),D.createElement(r.FlexItem,null,D.createElement(r.TimePicker,{is24Hour:!0,onChange:(e,t)=>A(t),time:E}))),D.createElement(r.Flex,{className:"custom-time-range-modal-footer"},D.createElement(r.FlexItem,{align:{default:"alignRight"}},D.createElement(r.Button,{variant:"secondary",onClick:a},n("Cancel"))),D.createElement(r.FlexItem,null,D.createElement(r.Button,{variant:"primary",onClick:()=>{const t=Date.parse(`${m} ${u}`),n=Date.parse(`${g} ${E}`);I.Z(t)&&I.Z(n)&&(l((0,Re.lL)(n,e)),l((0,Re.Zn)(n-t,e)),ve({endTime:n.toString(),timeRange:(n-t).toString()}),a())}},n("Save"))))))},Da="CUSTOM_TIME_RANGE_KEY",Ra=({namespace:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=_a(e),[n,l,,o]=tt(!1),[s,,i,c]=tt(!1),m=(0,L.useSelector)((({observe:e})=>e.getIn(["dashboards",a,"timespan"]))),d=(0,L.useSelector)((({observe:e})=>e.getIn(["dashboards",a,"endTime"]))),u=Ee("timeRange"),p=Ee("endTime"),g=(0,L.useDispatch)(),b=D.useCallback((e=>{e===Da?i():(he("timeRange",H(e).toString()),_e("endTime"),g((0,Re.Zn)(H(e),a)),g((0,Re.lL)(null,a)))}),[a,g,i]),E={[Da]:t("Custom time range"),"5m":t("Last {{count}} minute",{count:5}),"15m":t("Last {{count}} minute",{count:15}),"30m":t("Last {{count}} minute",{count:30}),"1h":t("Last {{count}} hour",{count:1}),"2h":t("Last {{count}} hour",{count:2}),"6h":t("Last {{count}} hour",{count:6}),"12h":t("Last {{count}} hour",{count:12}),"1d":t("Last {{count}} day",{count:1}),"2d":t("Last {{count}} day",{count:2}),"1w":t("Last {{count}} week",{count:1}),"2w":t("Last {{count}} week",{count:2})};return D.createElement(D.Fragment,null,D.createElement(Fa,{activePerspective:a,isOpen:s,setClosed:c}),D.createElement("div",{className:"form-group monitoring-dashboards__dropdown-wrap"},D.createElement("label",{className:"monitoring-dashboards__dropdown-title",htmlFor:"monitoring-time-range-dropdown"},t("Time range")),D.createElement(r.Dropdown,{className:"monitoring-dashboards__variable-dropdown",dropdownItems:et.map(E,((e,t)=>D.createElement(r.DropdownItem,{component:"button",key:t,onClick:()=>b(t)},e))),isOpen:n,onSelect:o,toggle:D.createElement(r.DropdownToggle,{className:"monitoring-dashboards__dropdown-button",id:"monitoring-time-range-dropdown",onToggle:l},E[d||p?Da:J(et.toNumber(u)||m)])})))},Pa=["__interval","__rate_interval","__auto_interval_[a-z]+"],La=e=>Z.Z(Pa,(t=>e?.match(new RegExp(`\\$${t}`,"g")))),$a=(e,t,a)=>{if(g.Z(e))return;const n={value:`${Math.floor(a/1e3)}s`},r={...t.toJS(),__range:n,__range_ms:n,__range_s:n},l=a/60,o=Math.floor(l/1e3/60),s={value:`${Math.max(o,5)}m`};Pa.forEach((e=>r[e]=s));let i=e;return _.Z(r,((e,t)=>{const a=new RegExp(`\\$${t}`,"g");if(i.match(a)){if(e.isLoading)return i=void 0,!1;const t=e.value===va?".+":e.value||"";i=i.replace(a,t)}})),i},Ma=D.createContext(""),Ga=({items:e,onChange:t,OptionComponent:a,selectedKey:l})=>{const{t:o}=(0,P.useTranslation)("plugin__monitoring-plugin"),[s,,i,c]=tt(!1),[m,d]=D.useState(),u=m?Pe.Z(e,(e=>e.toLowerCase().includes(m))):e;return D.createElement(r.Select,{className:"monitoring-dashboards__variable-dropdown",hasInlineFilter:v.Z(e)>1,inlineFilterPlaceholderText:o("Filter options"),isOpen:s,onFilter:()=>null,onSelect:(e,a)=>{t(a),c(),d(void 0)},onToggle:e=>{e?i():(c(),d(void 0))},onTypeaheadInputChanged:e=>d(e.toLowerCase()),placeholderText:Object.keys(e).includes(l)?La(l)?"Auto interval":e[l]:D.createElement(D.Fragment,null,D.createElement(n.RedExclamationCircleIcon,null)," ",o("Select a dashboard from the dropdown"))},E.Z(u,((e,t)=>a?D.createElement(a,{key:t,itemKey:t}):La(t)?D.createElement(r.Tooltip,{content:t},D.createElement(r.SelectOption,{key:t,value:t},"Auto interval")):D.createElement(r.SelectOption,{key:t,value:t},t===va?"All":t))))},ja=({id:e,name:t,namespace:a})=>{const{t:l}=(0,P.useTranslation)("plugin__monitoring-plugin"),o=_a(a),s=(0,L.useSelector)((({observe:e})=>e.getIn(["dashboards",o,"timespan"]))),i=(0,L.useSelector)((({observe:e})=>e.getIn(["dashboards",o,"variables"]))),c=i.toJS()[t],m=$a(c.query,i,s),d=(0,L.useDispatch)(),u=D.useCallback((0,Xe.b)(),[]),[p,b]=D.useState(!1),E=c?.datasource?.name,[A,h]=(0,n.useResolvedExtensions)(He),v=!g.Z(A),f=D.useCallback((async e=>{try{if(!E)return oe(e);if(h&&v){const t=A.find((e=>"monitoring-dashboards"===e?.properties?.contextId)),a=t?.properties?.getDataSource,n=await(a?.(E));return n&&n.basePath?oe(e,n?.basePath):void b(!0)}}catch(e){console.error(e),b(!0)}}),[E,A,h,v]);D.useEffect((()=>{if(!m)return;const e=m.replace(/label_values\((.*), (.*)\)/,"count($1) by ($2)"),r=(0,Xt.Yf)(s),l=new Set;let i=!1;d((0,Re.$x)(t,{isLoading:!0},o)),Promise.allSettled(r.map((async t=>{const o={endpoint:n.PrometheusEndpoint.QUERY_RANGE,query:e,samples:Math.ceil(60/r.length),timeout:"60s",timespan:t.duration,namespace:a,endTime:t.endTime};return f(o).then((e=>u(e).then((({data:e})=>{w.Z(e?.result,(({metric:e})=>Le.Z(e))).forEach(l.add,l)})).catch((e=>{(0,Xt.q4)(e)?console.error(`Timed Out Retrieving Labels from ${new Date(t.endTime-Xt.b6).toISOString()} - ${new Date(t.endTime).toISOString()} for ${m}`):"AbortError"===e.name?i=!0:console.error(e)}))))}))).then((e=>{const a=e.filter((e=>"rejected"===e.status)).length>0;if(l.size>0||!a){b(!1);const e=Array.from(l).sort();d((0,Re.O8)(t,e,o))}else d((0,Re.$x)(t,{isLoading:!1},o)),i||b(!0)}))}),[o,d,f,t,a,m,u,s,c.includeAll,c.options]),D.useEffect((()=>{c.value&&c.value!==Ee(t)&&("dev"===o&&"namespace"!==t||"admin"===o)&&he(t,c.value)}),[o,t,c.value]);const y=D.useCallback((e=>{e!==c.value&&(("dev"===o&&"namespace"!==t||"admin"===o)&&he(t,e),d((0,Re.$x)(t,{value:e},o)))}),[o,d,t,c.value]);if(c.isHidden||!p&&g.Z(c.options))return null;const C=c.includeAll?{[va]:"All"}:{};return _.Z(c.options,(e=>{C[e]=e})),D.createElement("div",{className:"form-group monitoring-dashboards__dropdown-wrap","data-test":`${t.toLowerCase()}-dropdown`},D.createElement("label",{htmlFor:`${e}-dropdown`,className:"monitoring-dashboards__dropdown-title"},t),p?D.createElement(r.Select,{isDisabled:!0,onToggle:()=>{},placeholderText:D.createElement(D.Fragment,null,D.createElement(n.RedExclamationCircleIcon,null)," ",l("Error loading options"))}):D.createElement(Ga,{items:C,onChange:y,selectedKey:c.value}))},Ua=()=>{const e=D.useContext(Ma),t=(0,L.useSelector)((({observe:t})=>t.getIn(["dashboards",_a(e),"variables"])));return D.createElement(D.Fragment,null,t.keySeq().map((t=>D.createElement(ja,{key:t,id:t,name:t,namespace:e}))))},Oa=["red","purple","blue","green","cyan","orange"],za=D.memo((({color:e,text:t})=>D.createElement(r.Label,{className:"monitoring-dashboards__dashboard_dropdown_tag",color:e},t))),Qa=D.memo((({items:e,onChange:t,selectedKey:a})=>{const{t:n}=(0,P.useTranslation)("plugin__monitoring-plugin"),l=w.Z(e,"tags"),o=$e.Z(l),s=Ge.Z(e,"title");return D.createElement("div",{className:"form-group monitoring-dashboards__dropdown-wrap","data-test":"dashboard-dropdown"},D.createElement("label",{className:"monitoring-dashboards__dropdown-title",htmlFor:"monitoring-board-dropdown"},n("Dashboard")),D.createElement(Ga,{items:s,onChange:t,OptionComponent:({itemKey:t})=>D.createElement(r.SelectOption,{className:"monitoring-dashboards__dashboard_dropdown_item",value:t},e[t]?.title,e[t]?.tags?.map(((e,t)=>D.createElement(za,{color:Oa[Me.Z(o,e)%Oa.length],key:t,text:e})))),selectedKey:a}))})),Va=({namespace:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=Ee("refreshInterval"),n=_a(e),r=(0,L.useSelector)((({observe:e})=>e.getIn(["dashboards",n,"pollInterval"]))),l=(0,L.useDispatch)(),o=D.useCallback((e=>{e?he("refreshInterval",e.toString()):_e("refreshInterval"),l((0,Re.mM)(e,n))}),[l,n]);return D.createElement("div",{className:"form-group monitoring-dashboards__dropdown-wrap"},D.createElement("label",{htmlFor:"refresh-interval-dropdown",className:"monitoring-dashboards__dropdown-title"},t("Refresh interval")),D.createElement(nt,{id:"refresh-interval-dropdown",interval:je.Z(a)||r,setInterval:o}))},Wa=D.memo((()=>{const e=D.useContext(Ma);return D.createElement("div",{className:"monitoring-dashboards__options"},D.createElement(Ra,{namespace:e}),D.createElement(Va,{namespace:e}))})),Ya=D.memo((()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement("div",{className:"monitoring-dashboards__header"},D.createElement("h1",{className:"co-m-pane__heading"},D.createElement("span",null,e("Dashboards"))),D.createElement(Wa,null))})),Ja=({queries:e,customDataSourceName:t})=>{const{t:a}=(0,P.useTranslation)("plugin__monitoring-plugin"),n=new URLSearchParams;e.forEach(((e,t)=>n.set(`query${t}`,e)));const r=D.useContext(Ma);return t&&n.set("datasource",t),D.createElement($.Link,{"aria-label":a("Inspect"),to:r?`/dev-monitoring/ns/${r}/metrics?${n.toString()}`:`/monitoring/query-browser?${n.toString()}`},a("Inspect"))},Ha=D.memo((({panel:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=D.useContext(Ma),l=_a(a),o=(0,L.useSelector)((({observe:e})=>e.getIn(["dashboards",l,"pollInterval"]))),s=(0,L.useSelector)((({observe:e})=>e.getIn(["dashboards",l,"timespan"]))),i=(0,L.useSelector)((({observe:e})=>e.getIn(["dashboards",l,"variables"]))),c=D.useRef(),[,m]=(e=>{const[t,a]=D.useState(!1),[n,r]=D.useState(!1);return D.useEffect((()=>{const t=new IntersectionObserver((([e])=>{a(e.isIntersecting),e.isIntersecting&&r(!0)}));return e?.current&&t.observe(e.current),()=>t.disconnect()}),[e,a,r]),[t,n]})(c),[d,p]=D.useState(!1),[b,h]=D.useState(!0),[v,_]=D.useState(void 0),f=e.datasource?.name,[w,y]=(0,n.useResolvedExtensions)(He),C=!g.Z(w);D.useEffect((()=>{(async()=>{if(f)if(y)if(C){const e=w.find((e=>"monitoring-dashboards"===e?.properties?.contextId)),t=e?.properties?.getDataSource,a=await(t?.(f));a&&a.basePath?(_(a),h(!1)):(p(!0),h(!1))}else h(!1),p(!0);else h(!0);else h(!1),_(null)})().catch((e=>{console.error(e),p(!0)}))}),[w,y,f,C]);const x=D.useCallback(((t,a)=>{const n=e.targets?.[a]?.legendFormat;return A.Z(n)?g.Z(t)?"{}":"":n.replace(/{{\s*([a-zA-Z_][a-zA-Z0-9_]*)\s*}}/g,((e,a)=>t[a]??""))}),[e]),S=D.useCallback(((e,t)=>{ve({endTime:t.toString(),timeRange:e.toString()})}),[]);if("row"===e.type)return D.createElement(D.Fragment,null,E.Z(e.panels,(e=>D.createElement(Ha,{key:e.id,panel:e}))));if(!["gauge","grafana-piechart-panel","graph","singlestat","table"].includes(e.type))return null;const N=E.Z(e.targets,"expr");if(!N.length)return null;const k=N.map((e=>$a(e,i,s))),B=Z.Z(k,ze.Z)&&b||void 0===v,q=(e=>{const t=(e=>{if(e.span)return e.span;const t=Ue.Z(Oe.Z(e.breakpoint,"%"));return t>0?Math.round(t/100*12):12})(e);switch(t){case 6:return"max-2";case 2:case 4:case 5:return"max-3";case 3:return"max-4";default:return"max-1"}})(e);return D.createElement("div",{className:`monitoring-dashboards__panel monitoring-dashboards__panel--${q}`},D.createElement(r.Card,{className:u()("monitoring-dashboards__card",{"co-overview-card--gradient":"grafana-piechart-panel"===e.type}),"data-test":`${e.title.toLowerCase().replace(/\s+/g,"-")}-chart`,"data-test-id":e.id?`chart-${e.id}`:void 0},D.createElement(r.CardHeader,{className:"monitoring-dashboards__card-header"},D.createElement(r.CardTitle,null,e.title),D.createElement(r.CardActions,{className:"co-overview-card__actions"},!B&&D.createElement(Ja,{queries:k,customDataSourceName:f}))),D.createElement(r.CardBody,{className:"co-dashboard-card__body--dashboard"},d?D.createElement(D.Fragment,null,D.createElement(n.RedExclamationCircleIcon,null)," ",t("Error loading card")):D.createElement("div",{className:"monitoring-dashboards__card-body-content",ref:c},B||!m?D.createElement("div",{className:"graph"===e.type?"query-browser__wrapper":""},D.createElement(Be,null)):D.createElement(D.Fragment,null,"grafana-piechart-panel"===e.type&&D.createElement(xt,{pollInterval:o,query:k[0],customDataSource:v}),"graph"===e.type&&D.createElement(wa,{formatSeriesTitle:x,isStack:e.stack,pollInterval:o,queries:k,showLegend:e.legend?.show,units:e.yaxes?.[0]?.format,onZoomHandle:S,namespace:a,customDataSource:v}),("singlestat"===e.type||"gauge"===e.type)&&D.createElement(xa,{panel:e,pollInterval:o,query:k[0],namespace:a,customDataSource:v}),"table"===e.type&&D.createElement(qa,{panel:e,pollInterval:o,queries:k,namespace:a,customDataSource:v}))))))})),Ka=({row:e})=>{const t=e.showTitle&&!g.Z(e.title),[a,n]=tt(!t||!e.collapse),l=a?Ye.LC:Je.oR,o=a?"Hide":"Show";return D.createElement("div",{"data-test-id":`panel-${Qe.Z(e?.title)}`},t&&D.createElement(r.Button,{"aria-label":o,className:"pf-m-link--align-left",onClick:n,style:{fontSize:24},title:o,variant:"plain"},D.createElement(l,null)," ",e.title),a&&D.createElement("div",{className:"monitoring-dashboards__row"},E.Z(e.panels,(e=>D.createElement(Ha,{key:e.id,panel:e})))))},Xa=({rows:e})=>D.createElement(D.Fragment,null,E.Z(e,(e=>D.createElement(Ka,{key:E.Z(e.panels,"id").join(),row:e})))),en=te((0,$.withRouter)((({history:e,match:t})=>{const{t:a}=(0,P.useTranslation)("plugin__monitoring-plugin"),r=(0,L.useDispatch)(),l=t.params?.ns,o=_a(l),[s,i]=D.useState(),[c,m,d]=(e=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=D.useCallback((0,Xe.b)(),[]),[n,r]=D.useState([]),[l,o]=D.useState(),[s,,,i]=tt(!0);return D.useEffect((()=>{a("/api/console/monitoring-dashboard-config").then((a=>{i(),o(void 0);let n=a.items;e&&(n=et.filter(n,(e=>"true"===e.metadata?.labels["console.openshift.io/odc-dashboard"])));const l=et.sortBy(et.map(n,(e=>{try{return{data:JSON.parse(et.values(e.data)[0]),name:e.metadata.name}}catch(a){return o(t('Could not parse JSON data for dashboard "{{dashboard}}"',{dashboard:e.metadata.name})),{data:void 0,name:e?.metadata?.name}}})),(e=>et.toLower(e?.data?.title)));r(l)})).catch((e=>{i(),"AbortError"!==e.name&&o(et.get(e,"json.error",e.message))}))}),[e,a,i,t]),[n,s,l]})(l);D.useEffect((()=>()=>r((0,Re.BZ)())),[r]),D.useEffect((()=>()=>{"dev"===o&&r((0,Re.HA)(o))}),[o,r]);const u=D.useMemo((()=>Ge.Z(Ve.Z(c,"name"),((e,t)=>({tags:e.data?.tags,title:e.data?.title??t})))),[c]),p=D.useCallback((t=>{let a,n,m=l?`/dev-monitoring/ns/${l}?dashboard=${t}`:`/monitoring/dashboards/${t}`;const d=Ee("refreshInterval");if(s?(a=null,n=null,d&&(m=`${m}?${new URLSearchParams({refreshInterval:d}).toString()}`)):(a=Ee("timeRange"),n=Ee("endTime"),window.location.search&&(m=`${m}${window.location.search}`)),t!==s){Ee("dashboard")!==t&&e.replace(m);const s=fa(c,t,l);r((0,Re.ZC)(s,o)),d&&r((0,Re.mM)(je.Z(d),o)),r((0,Re.lL)(je.Z(n)||null,o)),r((0,Re.Zn)(je.Z(a)||18e5,o)),i(t)}}),[o,s,c,r,e,l]);D.useEffect((()=>{if(!s&&!g.Z(c)){const e=Ee("dashboard");p((l?e:t.params.board)||c?.[0]?.name)}}),[s,c,p,t.params.board,l]),D.useEffect((()=>{if("admin"===o)return;const e=Ee("dashboard"),t=fa(c,e,l);r((0,Re.ZC)(t,o))}),[l]);const b=D.useMemo((()=>{const e=B.Z(c,{name:s})?.data;return e?.rows?.length?e.rows:e?.panels?.reduce(((e,t)=>{if("row"===t.type)e.push(We.Z(t));else if(0===e.length)e.push({panels:[t]});else{const a=e[e.length-1];A.Z(a.panels)&&(a.panels=[]),a.panels.push(t)}return e}),[])}),[s,c]);return d?D.createElement(Ke,{message:d}):D.createElement(D.Fragment,null,!l&&D.createElement(R.Helmet,null,D.createElement("title",null,a("Metrics dashboards"))),D.createElement(Ma.Provider,{value:l},D.createElement("div",{className:"co-m-nav-title co-m-nav-title--detail"},!l&&D.createElement(Ya,null),D.createElement("div",{className:"monitoring-dashboards__variables"},D.createElement("div",{className:"monitoring-dashboards__dropdowns"},!g.Z(u)&&D.createElement(Qa,{items:u,onChange:p,selectedKey:s}),D.createElement(Ua,{key:s})),l&&D.createElement(Wa,null))),D.createElement(n.Overview,null,m?D.createElement(Be,null):D.createElement(Xa,{key:s,rows:b}))))}))),tn=({dropdownItems:e})=>{const[t,a,,n]=tt(!1);return D.createElement(r.Dropdown,{"data-test-id":"kebab-button",dropdownItems:e,isOpen:t,isPlain:!0,onSelect:n,position:r.DropdownPosition.right,toggle:D.createElement(r.KebabToggle,{"aria-label":"toggle menu",onToggle:a})})},an=({k:e,v:t})=>D.createElement(r.Label,{className:"co-label",key:e},D.createElement("span",{className:"co-label__key"},e),D.createElement("span",{className:"co-label__eq"},"="),D.createElement("span",{className:"co-label__value"},t)),nn=({kind:e,labels:t})=>{const{t:a}=(0,P.useTranslation)("plugin__monitoring-plugin");return g.Z(t)?D.createElement("div",{className:"text-muted"},a("No labels")):D.createElement("div",{className:`co-text-${e}`},D.createElement(r.LabelGroup,{className:"co-label-group",numLabels:20},E.Z(t,((e,t)=>D.createElement(an,{key:t,k:t,v:e})))))};var rn,ln=a(57371),on=a(23244),sn=a(95767);!function(e){e.ComponentNotFound="COMPONENT_NOT_FOUND"}(rn||(rn={}));class cn extends D.Component{constructor(){super(...arguments),this.state={Component:null,loader:null},this.retryCount=0,this.maxRetries=25,this.isAsyncMounted=!1}static getDerivedStateFromProps(e,t){return(a=e.loader,e=>a?.name===e?.name&&(a||"a").toString()===(e||"b").toString())(t.loader)?null:{Component:null,loader:e.loader};var a}componentDidUpdate(){null===this.state.Component&&this.loadComponent()}componentDidMount(){this.isAsyncMounted=!0,null===this.state.Component&&this.loadComponent()}componentWillUnmount(){this.isAsyncMounted=!1}loadComponent(){this.state.loader().then((e=>{if(!e)return Promise.reject(rn.ComponentNotFound);this.isAsyncMounted&&this.setState({Component:e})})).catch((e=>{e===rn.ComponentNotFound?console.error("Component does not exist in module"):setTimeout((()=>this.loadComponent()),this.retryAfter)}))}get retryAfter(){this.retryCount++;const e=this.retryCount<this.maxRetries?this.retryCount:this.maxRetries;return 100*Math.pow(e,2)}render(){const{Component:e}=this.state,{LoadingComponent:t=qe,forwardRef:a}=this.props,n=q.Z(this.props,"loader");return null!=e?D.createElement(e,{ref:a,...n}):D.createElement(t,null)}}var mn=a(24947);let dn;const un=()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin"),[t,a,,n]=tt(!1),l=(0,L.useSelector)((({observe:e})=>e.getIn(["queryBrowser","queries"]).every((e=>e.get("isExpanded"))))),o=(0,L.useDispatch)(),s=D.useCallback((()=>o((0,Re.F$)())),[o]),i=[D.createElement(r.DropdownItem,{key:"add-query",component:"button",onClick:s},e("Add query")),D.createElement(r.DropdownItem,{key:"collapse-all",component:"button",onClick:()=>o((0,Re.xU)(!l))},e(l?"Collapse all query tables":"Expand all query tables")),D.createElement(r.DropdownItem,{key:"delete-all",component:"button",onClick:()=>{o((0,Re.BZ)()),dn=void 0}},e("Delete all queries"))];return D.createElement(r.Dropdown,{className:"co-actions-menu",dropdownItems:i,isOpen:t,onSelect:n,position:r.DropdownPosition.right,toggle:D.createElement(r.DropdownToggle,{onToggle:a},"Actions")})},pn=()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin"),t=(0,L.useSelector)((({observe:e})=>!!e.get("hideGraphs"))),a=(0,L.useDispatch)(),n=D.useCallback((()=>a((0,Re.IR)())),[a]),l=t?D.createElement(Qt.y3,null):D.createElement(sn.jG,null);return D.createElement(r.Button,{type:"button",className:"pf-m-link--align-right query-browser__toggle-graph",onClick:n,variant:"link"},l," ",e(t?"Show graph":"Hide graph"))},gn=({isExpanded:e,onClick:t})=>{const{t:a}=(0,P.useTranslation)("plugin__monitoring-plugin"),n=a(e?"Hide table":"Show table");return D.createElement(r.Button,{"aria-label":n,className:"query-browser__expand-button",onClick:t,title:n,variant:"plain"},e?D.createElement(Ye.LC,{className:"query-browser__expand-icon"}):D.createElement(Je.oR,{className:"query-browser__expand-icon"}))},bn=({index:e,labels:t})=>{const{t:a}=(0,P.useTranslation)("plugin__monitoring-plugin"),[n,l,o]=(0,L.useSelector)((({observe:a})=>{const n=a.getIn(["queryBrowser","queries",e,"disabledSeries"]);if(Z.Z(n,(e=>It.Z(e,t))))return[null,!0,!1];const r=a.getIn(["queryBrowser","queries",e,"series"]);if(g.Z(r))return[null,!1,!0];return[(a.getIn(["queryBrowser","queries"]).take(e).filter((e=>e.get("isEnabled"))).reduce(((e,t)=>e+v.Z(t.get("series"))),0)+ln.Z(r,(e=>It.Z(e,t))))%ta.length,!1,!1]})),s=(0,L.useDispatch)(),i=D.useCallback((()=>s((0,Re.Pn)(e,t))),[s,e,t]);if(o)return D.createElement("div",{className:"query-browser__series-btn-wrap"});const c=a(l?"Show series":"Hide series");return D.createElement("div",{className:"query-browser__series-btn-wrap"},D.createElement(r.Button,{"aria-label":c,className:u()("query-browser__series-btn",{"query-browser__series-btn--disabled":l}),onClick:i,style:null===n?void 0:{backgroundColor:ta[n]},title:c,type:"button",variant:"plain"}))},En=({index:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=(0,L.useSelector)((({observe:t})=>g.Z(t.getIn(["queryBrowser","queries",e,"disabledSeries"])))),n=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"isEnabled"]))),l=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"query"]))),o=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"queryTableData"]))),s=(0,L.useDispatch)(),i=D.useCallback((()=>s((0,Re.nw)(e))),[s,e]),c=D.useCallback((()=>s((0,Re.LS)(e))),[s,e]),m=D.useCallback((()=>{s((0,Re.gV)(e)),dn=void 0}),[s,e]),d=D.useCallback((()=>{s((0,Re.dp)(e))}),[s,e]),u=e=>e.title?.props?.children,p=e=>e.title.props.children,b=D.createElement(r.DropdownItem,{key:"export",component:"button",onClick:()=>{(e=>{const t=new Blob([e],{type:"data:text/csv;charset=utf-8,"}),a=window.URL.createObjectURL(t),n=document.createElement("a");n.download=`OpenShift_Metrics_QueryTable_${l}.csv`,n.href=a,n.dataset.downloadurl=["text/csv",n.download,n.href].join(":"),n.click(),setTimeout((()=>{URL.revokeObjectURL(a)}),100)})(((e,t=",")=>e.map((e=>e.map((e=>isNaN(e)?`"${e}"`:e)).join(t))).join("\n"))([o.columns.slice(1).map((e=>"string"==typeof e?.title?e.title:u(e)?p(e):"")),...o.rows.map((e=>e.slice(1))).map((e=>e.map((e=>u(e)?p(e):e))))]))}},t("Export as CSV")),E=[D.createElement(r.DropdownItem,{key:"toggle-query",component:"button",onClick:i},t(n?"Disable query":"Enable query")),D.createElement(r.DropdownItem,{tooltip:n?void 0:t("Query must be enabled"),isDisabled:!n,key:"toggle-all-series",component:"button",onClick:c},t(a?"Hide all series":"Show all series")),D.createElement(r.DropdownItem,{key:"delete",component:"button",onClick:m},t("Delete query")),D.createElement(r.DropdownItem,{key:"duplicate",component:"button",onClick:d},t("Duplicate query"))],A=l&&o?.rows&&o?.columns?[...E,b]:E;return D.createElement(tn,{dropdownItems:A})},An=({index:e,namespace:t,customDatasource:a})=>{const{t:l}=(0,P.useTranslation)("plugin__monitoring-plugin"),[o,s]=D.useState(),[i,c]=D.useState(),[d,u]=D.useState(1),[b,A]=D.useState(50),[h,v]=D.useState({}),_=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"isEnabled"]))),f=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"isExpanded"]))),y=(0,L.useSelector)((({observe:e})=>e.getIn(["queryBrowser","pollInterval"],15e3))),C=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"query"]))),x=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"series"]))),S=(0,L.useSelector)((({observe:e})=>e.getIn(["queryBrowser","timespan"]))),N=(0,L.useSelector)((({observe:e})=>e.getIn(["queryBrowser","lastRequestTime"]))),k=(0,L.useDispatch)(),B=D.useCallback((()=>k((0,Re.LS)(e))),[k,e]),q=(0,L.useSelector)((({observe:t})=>g.Z(t.getIn(["queryBrowser","queries",e,"disabledSeries"])))),I=D.useCallback((0,Xe.b)(),[]);if(Wt((()=>{_&&f&&C&&I(oe({endpoint:n.PrometheusEndpoint.QUERY,namespace:t,query:C},a?.basePath)).then((e=>{s(p.Z(e,"data")),c(void 0)})).catch((e=>{"AbortError"!==e.name&&(s(void 0),c(e))}))}),y,t,C,S,N),D.useEffect((()=>{s(void 0),c(void 0),u(1),v({})}),[t,C]),!_||!f||!C)return null;if(i)return D.createElement("div",{className:"query-browser__table-message"},D.createElement(ra,{error:i,title:l("Error loading values")}));if(!o)return D.createElement("div",{className:"query-browser__table-message"},D.createElement(Be,null));const Z=on.Z(x,o.result,((e,t)=>It.Z(e,t.metric))),F=Z.length?[...o.result,...Z.map((e=>({metric:e})))]:o.result;if(!F||0===F.length)return D.createElement("div",{className:"query-browser__table-message"},D.createElement(n.YellowExclamationTriangleIcon,null)," ",l("No datapoints found."));const R=[m.sortable,m.wrappable],$=t=>({title:D.createElement(bn,{index:e,labels:t})});let M,G;if("scalar"===o.resultType)M=["",{title:l("Value"),transforms:R}],G=[[$({}),p.Z(F,"[1]")]];else if("string"===o.resultType)M=[{title:l("Value"),transforms:R}],G=[[F?.[1]]];else{const e=$e.Z(w.Z(F,(({metric:e})=>Object.keys(e)))).sort();let t;if(M=["",...e.map((e=>({title:D.createElement("span",null,"__name__"===e?l("Name"):e),transforms:R}))),{title:l("Value"),transforms:R}],t="matrix"===o.resultType?({metric:t,values:a})=>["",...E.Z(e,(e=>t[e])),{title:D.createElement(D.Fragment,null,E.Z(a,(([e,t])=>D.createElement("div",{key:e},t," @",e))))}]:({metric:t,value:a})=>[$(t),...E.Z(e,(e=>t[e])),p.Z(a,"[1]",{title:D.createElement("span",{className:"text-muted"},l("None"))})],G=E.Z(F,t),h){const t=e.length+1,a=h.index===t?e=>{const a=Number(e[t]);return Number.isNaN(a)?0:a}:`${h.index}`;G=T.Z(G,[a],[h.direction])}}k((0,Re.y9)(e,{queryTableData:{columns:M,rows:G}}));const j=G.slice((d-1)*b,d*b).map((e=>({cells:e})));return D.createElement(D.Fragment,null,D.createElement("div",{className:"query-browser__table-wrapper"},D.createElement("div",{className:"horizontal-scroll"},D.createElement(r.Button,{variant:"link",isInline:!0,onClick:B,className:"query-browser__series-select-all-btn"},l(q?"Unselect all":"Select all")),D.createElement(m.Table,{"aria-label":l("query results table"),cells:M,gridBreakPoint:m.TableGridBreakpoint.none,onSort:(e,t,a)=>v({index:t,direction:a}),rows:j,sortBy:h,variant:m.TableVariant.compact},D.createElement(m.TableHeader,null),D.createElement(m.TableBody,null)))),D.createElement(ka,{itemCount:G.length,page:d,perPage:b,setPage:u,setPerPage:A}))},hn=e=>D.createElement(cn,{loader:()=>Promise.all([a.e(213),a.e(11)]).then(a.bind(a,56011)).then((e=>e.PromQLExpressionInput)),...e}),vn=({index:e,customDatasource:t})=>{const{t:a}=(0,P.useTranslation)("plugin__monitoring-plugin"),n=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"id"]))),l=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"isEnabled"]))),o=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"isExpanded"]))),s=(0,L.useSelector)((({observe:t})=>t.getIn(["queryBrowser","queries",e,"text"],""))),i=(0,L.useDispatch)(),c=D.useCallback((()=>i((0,Re.nw)(e))),[i,e]),m=D.useCallback((()=>i((0,Re.y9)(e,{isExpanded:!o}))),[i,e,o]),d=D.useCallback((t=>{i((0,Re.y9)(e,{text:t}))}),[i,e]),p=D.useCallback((()=>{i((0,Re.Li)())}),[i]),g=`${n}-${l}`,b=a(l?"Disable query":"Enable query");return D.createElement("div",{className:u()("query-browser__table",{"query-browser__table--expanded":o})},D.createElement("div",{className:"query-browser__query-controls"},D.createElement(gn,{isExpanded:o,onClick:m}),D.createElement(hn,{value:s,onValueChange:d,onExecuteQuery:p,onSelectionChange:(t,a,n)=>{dn={index:e,selection:{start:a,end:n},target:t}}}),D.createElement("div",{title:b},D.createElement(r.Switch,{"aria-label":b,id:g,isChecked:l,key:g,onChange:c})),D.createElement("div",{className:"dropdown-kebab-pf"},D.createElement(En,{index:e}))),D.createElement(An,{index:e,customDatasource:t}))},_n=({customDataSourceName:e,customDataSource:t,customDatasourceError:a})=>{const{t:n}=(0,P.useTranslation)("plugin__monitoring-plugin"),l=(0,L.useDispatch)(),o=(0,L.useSelector)((({observe:e})=>!!e.get("hideGraphs"))),s=(0,L.useSelector)((({observe:e})=>e.getIn(["queryBrowser","queries"]))),i=s.toJS();D.useEffect((()=>{const e=Ae();for(let t=0;C.Z(e,`query${t}`);++t){const a=e[`query${t}`];l((0,Re.y9)(t,{isEnabled:!0,isExpanded:!0,query:a,text:a}))}}),[l]);const c=JSON.stringify(E.Z(i,"query")),m=D.useMemo((()=>E.Z(i,"query")),[c]),d=JSON.stringify(Pt.Z(E.Z(i,"disabledSeries"),g.Z)),u=D.useMemo((()=>E.Z(i,"disabledSeries")),[d]);if(D.useEffect((()=>{const t={};_.Z(m,((e,a)=>t[`query${a}`]=e||"")),e&&(t.datasource=e),(e=>{const t=new URLSearchParams;let a=!1;if(_.Z(e,((e,n)=>{t.get(n)!==e&&(a=!0,t.set(n,e))})),a){const e=new URL(window.location.href);be.replace(`${e.pathname}?${t.toString()}${e.hash}`)}})(t)}),[m,e]),o)return null;return e&&a?D.createElement("div",{className:"query-browser__wrapper graph-empty-state"},D.createElement(r.EmptyState,{variant:r.EmptyStateVariant.full},D.createElement(r.EmptyStateIcon,{icon:Qt.y3}),D.createElement(r.Title,{headingLevel:"h2",size:"md"},n("Error loading custom data source")),D.createElement(r.EmptyStateBody,null,n("An error occurred while loading the custom data source.")))):""===m.join("")?D.createElement("div",{className:"query-browser__wrapper graph-empty-state"},D.createElement(r.EmptyState,{variant:r.EmptyStateVariant.full},D.createElement(r.EmptyStateIcon,{icon:Qt.y3}),D.createElement(r.Title,{headingLevel:"h2",size:"md"},n("No query entered")),D.createElement(r.EmptyStateBody,null,n("Enter a query in the box below to explore metrics for this cluster.")),D.createElement(r.Button,{onClick:()=>{const e=dn?.index??0,t=i[e]?e:0,a='sort_desc(sum(sum_over_time(ALERTS{alertstate="firing"}[24h])) by (alertname))';l((0,Re.y9)(t,{isEnabled:!0,query:a,text:a}))},variant:"primary"},n("Insert example query")))):D.createElement(Aa,{customDataSource:t,defaultTimespan:18e5,disabledSeries:u,queries:m,showStackedControl:!0})},fn=()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin"),t=(0,L.useDispatch)(),a=D.useCallback((()=>t((0,Re.F$)())),[t]);return D.createElement(r.Button,{className:"query-browser__inline-control",onClick:a,type:"button",variant:"secondary"},e("Add query"))},wn=()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin"),t=(0,L.useDispatch)(),a=D.useCallback((()=>t((0,Re.Li)())),[t]);return D.createElement(r.Button,{onClick:a,type:"submit",variant:"primary"},e("Run queries"))},yn=({customDatasource:e})=>{const t=(0,L.useSelector)((({observe:e})=>e.getIn(["queryBrowser","queries"]).size));return D.createElement(D.Fragment,null,Dt.Z(t).map((a=>{const n=t-a-1;return D.createElement(vn,{index:n,key:n,customDatasource:e})})))},Cn=()=>{const e=(0,L.useSelector)((({observe:e})=>e.getIn(["queryBrowser","pollInterval"]))),t=(0,L.useDispatch)(),a=D.useCallback((e=>t((0,Re.W0)(e))),[t]);return D.createElement(nt,{interval:e,setInterval:a})},xn=te((()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin"),t=(0,L.useDispatch)();D.useEffect((()=>()=>t((0,Re.BZ)())),[t]);const[a,l]=D.useState(void 0),[o,s]=D.useState(!1),i=Ee("datasource"),[c,m]=(0,n.useResolvedExtensions)(mn.Z),d=!g.Z(c),[u,p]=D.useState(!1);return D.useEffect((()=>{(async()=>{if(i){if(m){if(l({basePath:"",dataSourceType:"prometheus"}),!d)return void p(!0);const e=c.find((e=>"monitoring-dashboards"===e?.properties?.contextId));if(!e)return void p(!0);const t=e?.properties?.getDataSource,a=await(t?.(i));if(!a||!a.basePath)return void p(!0);l(a),s(!0)}}else l(null)})().catch((e=>{console.error(e),p(!0)}))}),[c,m,i,d]),!i||m&&(o||u)?D.createElement(D.Fragment,null,D.createElement(R.Helmet,null,D.createElement("title",null,e("Metrics"))),D.createElement("div",{className:"co-m-nav-title"},D.createElement("h1",{className:"co-m-pane__heading"},D.createElement("span",null,e("Metrics")),D.createElement("div",{className:"co-actions"},D.createElement(Cn,null),D.createElement(un,null)))),D.createElement("div",{className:"co-m-pane__body"},D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},D.createElement("div",{className:"query-browser__toggle-graph-container"},D.createElement(pn,null)))),D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},D.createElement(_n,{customDataSource:a,customDataSourceName:i,customDatasourceError:u}),D.createElement("div",{className:"query-browser__controls"},D.createElement("div",{className:"query-browser__controls--right"},D.createElement(r.ActionGroup,{className:"pf-c-form pf-c-form__group--no-top-margin"},D.createElement(fn,null),D.createElement(wn,null)))),D.createElement(yn,{customDatasource:a}))))):D.createElement("div",{className:"co-m-pane__body"},D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12 pf-u-text-align-center"},D.createElement(Be,null))))}));var Sn=a(79593),Nn=a(67486),kn=a(52913),Bn=a(28187),qn=a(8221),In=a(80369),Tn=a(23615);const Zn=({message:e})=>{const{t}=(0,P.useTranslation)();return D.createElement(r.Alert,{isInline:!0,className:"co-alert co-alert--scrollable",variant:"danger",title:t("public~An error occurred")},D.createElement("div",{className:"co-pre-line"},e))},Fn=({children:e,errorMessage:t,inProgress:a})=>D.createElement("div",{className:"co-m-btn-bar"},D.createElement(r.AlertGroup,{isLiveRegion:!0,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text"},t&&D.createElement(Zn,{message:t}),((e,t)=>D.Children.map(e,(e=>In.Z(e)&&"button"===e.type?D.cloneElement(e,{disabled:e.props.disabled||t}):e)))(e,a),a&&D.createElement(Be,null)));Fn.propTypes={children:Tn.node.isRequired,errorMessage:Tn.node,inProgress:Tn.bool};const Dn=e=>e.sdkCore?.user,Rn=e=>e<10?`0${e}`:String(e),Pn=e=>`${e.getFullYear()}/${Rn(e.getMonth()+1)}/${Rn(e.getDate())} ${Rn(e.getHours())}:${Rn(e.getMinutes())}:${Rn(e.getSeconds())}`,Ln=e=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a="\\d{4}/(0?[1-9]|1[012])/(0?[1-9]|[12]\\d|3[01]) (0?\\d|1\\d|2[0-3]):[0-5]\\d(:[0-5]\\d)?",n=new RegExp(`^${a}$`).test(e.value);return D.createElement("div",null,D.createElement(r.Tooltip,{content:[D.createElement("span",{className:"co-nowrap",key:"co-timestamp"},n?new Date(e.value).toISOString():t("Invalid date / time"))]},D.createElement(r.TextInput,{...e,"aria-label":t("Datetime"),"data-test-id":"silence-datetime",validated:n||e.isDisabled?"default":"error",pattern:a,placeholder:"YYYY/MM/DD hh:mm:ss"})))},$n=()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement("dl",null,D.createElement("dd",null,e("Select the negative matcher option to update the label value to a not equals matcher.")),D.createElement("dd",null,e("If both the RegEx and negative matcher options are selected, the label value must not match the regular expression.")))},Mn=te((0,$.withRouter)((({defaults:e,history:t,Info:a,title:l})=>{const{t:o}=(0,P.useTranslation)("plugin__monitoring-plugin"),s="-",i={[s]:s,"30m":o("30m"),"1h":o("1h"),"2h":o("2h"),"6h":o("6h"),"12h":o("12h"),"1d":o("1d"),"2d":o("2d"),"1w":o("1w")},c=new Date,m=g.Z(e.startsAt)||new Date(e.startsAt)<c;let d=g.Z(e.endsAt)?"2h":s;if(!m&&e.startsAt&&e.endsAt){const t=J(Date.parse(e.endsAt)-Date.parse(e.startsAt));Object.keys(i).includes(t)&&(d=t)}const u=(0,L.useDispatch)(),[b,A,,h]=tt(!1),[v,_]=D.useState(e.comment??""),[f,w]=D.useState(e.createdBy??""),[y,C]=D.useState(d),[x,S]=D.useState(e.endsAt??Pn(new Date(new Date(c).setHours(c.getHours()+2)))),[N,k]=D.useState(),[B,q]=D.useState(!1),[I,T]=D.useState(m),[Z,F]=D.useState(e.matchers??[{isRegex:!1,name:"",value:""}]),[$,M]=D.useState(e.startsAt??Pn(c)),j=(0,L.useSelector)(Dn);D.useEffect((()=>{!f&&j&&w(j.metadata?.name||j.username)}),[j]);const U=(e,t,a)=>{const n=Sn.Z(Z);Nn.Z(n,[e,t],a),F(n)},O=E.Z(i,((e,t)=>D.createElement(r.DropdownItem,{key:t,onClick:()=>C(t)},e)));return D.createElement(D.Fragment,null,D.createElement(R.Helmet,null,D.createElement("title",null,l)),D.createElement("div",{className:"co-m-nav-title co-m-nav-title--detail"},D.createElement(r.Title,{headingLevel:"h1"},l),D.createElement(r.HelperText,null,D.createElement(r.HelperTextItem,{className:"monitoring__title-help-text"},o("Silences temporarily mute alerts based on a set of label selectors that you define. Notifications will not be sent for alerts that match all the listed values or regular expressions.")))),D.createElement("div",{className:"co-m-pane__body"},a&&D.createElement(a,null),D.createElement("form",{onSubmit:a=>{if(a.preventDefault(),""===G.Z(v))return void k("Comment is required.");const{alertManagerBaseURL:r}=window.SERVER_FLAGS;if(!r)return void k("Alertmanager URL not set");q(!0);const l=I?new Date:new Date($),o=y===s?new Date(x):new Date(l.getTime()+H(y)),i={comment:v,createdBy:f,endsAt:o.toISOString(),id:e.id,matchers:Z,startsAt:l.toISOString()};n.consoleFetchJSON.post(`${r}/api/v2/silences`,i).then((({silenceID:e})=>{k(void 0),(0,Xt.rH)(u),t.push(`${Xt.sU.plural}/${encodeURIComponent(e)}`)})).catch((e=>{const t="string"==typeof p.Z(e,"json")?p.Z(e,"json"):e.message||"Error saving Silence";k(t),q(!1)}))},className:"monitoring-silence-alert"},D.createElement("div",{className:"co-m-pane__body-group"},D.createElement(de,{text:o("Duration")}),D.createElement("div",{className:"row"},D.createElement("div",{className:"form-group col-sm-4 col-md-5"},D.createElement("label",null,o("Silence alert from...")),I?D.createElement(Ln,{isDisabled:!0,"data-test":"silence-from",value:o("Now")}):D.createElement(Ln,{"data-test":"silence-from",isRequired:!0,onChange:e=>M(e),value:$})),D.createElement("div",{className:"form-group col-sm-4 col-md-2"},D.createElement("label",null,o("For...")),D.createElement(r.Dropdown,{className:"dropdown--full-width","data-test":"silence-for",dropdownItems:O,isOpen:b,onSelect:h,toggle:D.createElement(r.DropdownToggle,{"data-test":"silence-for-toggle",onToggle:A},y)})),D.createElement("div",{className:"form-group col-sm-4 col-md-5"},D.createElement("label",null,o("Until...")),y===s?D.createElement(Ln,{"data-test":"silence-until",isRequired:!0,onChange:e=>S(e),value:x}):D.createElement(Ln,{"data-test":"silence-until",isDisabled:!0,value:I?o("{{duration}} from now",{duration:i[y]}):(()=>{const e=Date.parse($);return e?Pn(new Date(e+H(y))):"-"})()}))),D.createElement("div",{className:"form-group"},D.createElement("label",null,D.createElement("input",{"data-test":"silence-start-immediately",checked:I,onChange:e=>T(e.currentTarget.checked),type:"checkbox"}),"  ",o("Start immediately")))),D.createElement("div",{className:"co-m-pane__body-group"},D.createElement(de,{text:o("Alert labels")}),D.createElement("p",{className:"co-help-text monitoring-silence-alert__paragraph"},D.createElement(P.Trans,{t:o},"Alerts with labels that match these selectors will be silenced instead of firing. Label values can be matched exactly or with a"," ",D.createElement(pe,{href:"https://github.com/google/re2/wiki/Syntax",text:o("regular expression")}))),E.Z(Z,((e,t)=>D.createElement("div",{className:"row",key:t},D.createElement("div",{className:"form-group col-sm-4"},D.createElement("label",null,o("Label name")),D.createElement(r.TextInput,{"aria-label":o("Label name"),isRequired:!0,onChange:e=>U(t,"name",e),placeholder:o("Name"),value:e.name})),D.createElement("div",{className:"form-group col-sm-4"},D.createElement("label",null,o("Label value")),D.createElement(r.TextInput,{"aria-label":o("Label value"),isRequired:!0,onChange:e=>U(t,"value",e),placeholder:o("Value"),value:e.value})),D.createElement("div",{className:"form-group col-sm-4"},D.createElement("div",{className:"monitoring-silence-alert__label-options"},D.createElement("label",null,D.createElement("input",{checked:e.isRegex,onChange:e=>U(t,"isRegex",e.currentTarget.checked),type:"checkbox"}),"  ",o("RegEx")),D.createElement(r.Tooltip,{content:D.createElement($n,null)},D.createElement("label",null,D.createElement("input",{checked:!1===e.isEqual,onChange:e=>U(t,"isEqual",!e.currentTarget.checked),type:"checkbox"}),"  ",o("Negative matcher"))),D.createElement(r.Tooltip,{content:o("Remove")},D.createElement(r.Button,{type:"button",onClick:()=>(e=>{const t=Sn.Z(Z);t.splice(e,1),F(g.Z(t)?[{isRegex:!1,name:"",value:""}]:t)})(t),"aria-label":o("Remove"),variant:"plain"},D.createElement(Bn.$_,null)))))))),D.createElement("div",{className:"form-group"},D.createElement(r.Button,{className:"pf-m-link--align-left",onClick:()=>{F([...Z,{isRegex:!1,name:"",value:""}])},type:"button",variant:"link"},D.createElement(qn.wl,{className:"co-icon-space-r"}),o("Add label")))),D.createElement("div",{className:"co-m-pane__body-group"},D.createElement(de,{text:o("Info")}),D.createElement("div",{className:"form-group"},D.createElement("label",{className:"co-required"},o("Creator")),D.createElement(r.TextInput,{"aria-label":o("Creator"),isRequired:!0,onChange:e=>w(e),value:f})),D.createElement("div",{className:"form-group"},D.createElement("label",{className:"co-required"},o("Comment")),D.createElement(r.TextArea,{"aria-label":o("Comment"),isRequired:!0,onChange:e=>_(e),"data-test":"silence-comment",value:v})),D.createElement(Fn,{errorMessage:N,inProgress:B},D.createElement(r.ActionGroup,{className:"pf-c-form"},D.createElement(r.Button,{type:"submit",variant:"primary"},o("Silence")),D.createElement(r.Button,{onClick:t.goBack,variant:"secondary"},o("Cancel"))))))))}))),Gn=()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement(r.Alert,{className:"co-alert",isInline:!0,title:e("Overwriting current silence"),variant:"info"},e("When changes are saved, the currently existing silence will be expired and a new silence with the new configuration will take its place."))},jn=({match:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=(0,L.useSelector)((({observe:e})=>e.get("silences"))),n=B.Z(a?.data,{id:e.params.id}),r="expired"===(0,Xt.SI)(n),l=kn.Z(n,["comment","createdBy","endsAt","id","matchers","startsAt"]);return l.startsAt=r?void 0:Pn(new Date(l.startsAt)),l.endsAt=r?void 0:Pn(new Date(l.endsAt)),D.createElement(De,{data:n,label:Xt.sU.label,loaded:a?.loaded,loadError:a?.loadError},D.createElement(Mn,{defaults:l,Info:r?void 0:Gn,title:t(r?"Recreate silence":"Edit silence")}))},Un=()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin"),t=E.Z(Ae(),((e,t)=>({name:t,value:e,isRegex:!1})));return g.Z(t)?D.createElement(Mn,{defaults:{},title:e("Create silence")}):D.createElement(Mn,{defaults:{matchers:t},title:e("Silence alert")})};var On=a(48583),zn=a(47838),Qn=a(19939),Vn=a(3357);class Wn{constructor(e,t){this._conjuncts={},this._emptySelectsAll=!!t,this._OPERATOR_MAP={In:"in",NotIn:"not in",Exists:"exists",DoesNotExist:"does not exist"},this._REVERSE_OPERATOR_MAP={in:"In","not in":"NotIn",exists:"Exists","does not exist":"DoesNotExist"},e&&(e.matchLabels||e.matchExpressions?(_.Z(e.matchLabels,((e,t)=>{this.addConjunct(t,"in",[e])}),this),_.Z(e.matchExpressions,(e=>{this.addConjunct(e.key,this._OPERATOR_MAP[e.operator],e.values)}),this)):_.Z(e,((e,t)=>{e||""===e?this.addConjunct(t,"in",[e]):this.addConjunct(t,"exists",[])}),this))}addConjunct(e,t,a){const n={key:e,operator:t,values:a},r=this._getIdForConjunct(n);return this._conjuncts[r]=n,n.id=r,n.string=this._getStringForConjunct(n),n}removeConjunct(e){e.id?delete this._conjuncts[e.id]:delete this._conjuncts[e]}clearConjuncts(){this._conjuncts={}}isEmpty(){return g.Z(this._conjuncts)}each(e){_.Z(this._conjuncts,e)}select(e){return zn.Z(e)?x.Z(e,Qn.Z(this.matches,this)):Pe.Z(e,Qn.Z(this.matches,this))}matchesLabels(e){if(this.isEmpty())return this._emptySelectsAll;for(const t in this._conjuncts){const a=this._conjuncts[t];switch(a.operator){case"exists":if(!e[a.key]&&""!==e[a.key])return!1;break;case"does not exist":if(e[a.key]||""===e[a.key])return!1;break;case"in":let t=!1;if(e[a.key]||""===e[a.key])for(let n=0;!t&&n<a.values.length;n++)e[a.key]===a.values[n]&&(t=!0);if(!t)return!1;break;case"not in":let n=!0;if(e[a.key])for(let t=0;n&&t<a.values.length;t++)n=e[a.key]!==a.values[t];if(!n)return!1}}return!0}matches(e){if(!e)return!1;const t=e.metadata?.labels||{};return this.matchesLabels(t)}hasConjunct(e){return!!this._conjuncts[this._getIdForConjunct(e)]}findConjunctsMatching(e,t){return Pe.Z(this._conjuncts,Vn.Z({operator:e,key:t}))}covers(e){return!this.isEmpty()&&F.Z(this._conjuncts,(function(t){if(e.hasConjunct(t))return!0;switch(t.operator){case"exists":return!g.Z(e.findConjunctsMatching("in",t.key));case"does not exist":return!1;case"in":const a=e.findConjunctsMatching("in",t.key);return!g.Z(a)&&F.Z(a,(function(e){return e.values.length===qt.Z(e.values,t.values).length}));case"not in":const n=e.findConjunctsMatching("not in",t.key);return!g.Z(n)&&F.Z(n,(function(e){return t.values.length===qt.Z(e.values,t.values).length}))}return!0}))}exportJSON(){const e={matchExpressions:[]};for(const t in this._conjuncts){const a=this._conjuncts[t],n={key:a.key,operator:this._REVERSE_OPERATOR_MAP[a.operator],values:a.values};e.matchExpressions.push(n)}return JSON.stringify(e)}_getStringForConjunct(e){let t=e.key;if("exists"===e.operator)return`${t} exists`;if("does not exist"===e.operator)return`${t} does not exist`;"not in"===e.operator&&(t+=" not"),t+=" in (";for(let a=0;a<e.values.length;a++)""===e.values[a]?t+='""':t+=e.values[a],a!==e.values.length-1&&(t+=", ");return t+=")",t}_getIdForConjunct(e){let t=`${e.key}-${e.operator}`;return e.values&&(t+=`-${e.values.join(",")}`),t}}const Yn=e=>(({group:e,version:t,kind:a})=>[e||"core",t,a].join("~"))({group:e.apiGroup,version:e.apiVersion,kind:e.kind});var Jn;!function(e){e.ServiceMonitor="serviceMonitor",e.PodMonitor="podMonitor"}(Jn||(Jn={}));const Hn=D.createContext([]),Kn=D.createContext([]),Xn=D.createContext([]),er=D.createContext([]),tr=({target:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),[a,r,l]=D.useContext(Xn),[o,s]=D.useContext(er);if(l)return D.createElement(D.Fragment,null,D.createElement(n.RedExclamationCircleIcon,null)," ",t("Error"));if(!s||!r)return D.createElement(Be,null);const i=(0,B.Z)(o,(({metadata:t})=>t.name===e?.labels?.pod&&t.namespace===e?.labels?.namespace)),c=(0,B.Z)(a,(({metadata:t,spec:a})=>i&&e.scrapePool.includes(`/${t.namespace}/${t.name}/`)&&(void 0===a.selector.matchLabels&&void 0===a.selector.matchExpressions||new Wn(a.selector).matchesLabels(i.metadata.labels??{}))&&(void 0===a.namespaceSelector?.matchNames||(0,On.Z)(a.namespaceSelector?.matchNames,i.metadata.namespace))));return c?D.createElement(n.ResourceLink,{kind:Yn(ie),name:c.metadata.name,namespace:c.metadata.namespace}):D.createElement(D.Fragment,null,"-")},ar=({target:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),[a,r,l]=D.useContext(Hn),[o,s]=D.useContext(Kn);if(l)return D.createElement(D.Fragment,null,D.createElement(n.RedExclamationCircleIcon,null)," ",t("Error"));if(!s||!r)return D.createElement(Be,null);const i=(0,B.Z)(o,(({metadata:t})=>t.name===e?.labels?.service&&t.namespace===e?.labels?.namespace)),c=(0,B.Z)(a,(({metadata:t,spec:a})=>i&&e.scrapePool.includes(`/${t.namespace}/${t.name}/`)&&(void 0===a.selector.matchLabels&&void 0===a.selector.matchExpressions||new Wn(a.selector).matchesLabels(i.metadata.labels??{}))&&(void 0===a.namespaceSelector?.matchNames||(0,On.Z)(a.namespaceSelector?.matchNames,i.metadata.namespace))));return c?D.createElement(n.ResourceLink,{kind:Yn(se),name:c.metadata.name,namespace:c.metadata.namespace}):D.createElement(D.Fragment,null,"-")},nr=D.memo((({health:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin");return"up"===e?D.createElement(D.Fragment,null,D.createElement(n.GreenCheckCircleIcon,null)," ",t("Up")):D.createElement(D.Fragment,null,D.createElement(n.RedExclamationCircleIcon,null)," ",t("Down"))})),rr=({loadError:e,title:t})=>{const[a,,,n]=tt(!0);return a?D.createElement(r.Alert,{className:"co-alert",title:t,variant:"danger",actionClose:D.createElement(r.AlertActionCloseButton,{onClose:n})},e.message):null},lr=({loaded:e,loadError:t,targets:a})=>{const{t:l}=(0,P.useTranslation)("plugin__monitoring-plugin"),o=(0,$.useRouteMatch)();let s,i="";if(o?.params?.scrapeUrl)try{i=atob(o?.params?.scrapeUrl),s=(0,B.Z)(a,{scrapeUrl:i})}catch{}const c=s&&s.scrapePool.includes(Jn.ServiceMonitor),m=s&&s.scrapePool.includes(Jn.PodMonitor),[,,d]=D.useContext(Hn),[,,u]=D.useContext(Xn);return D.createElement(D.Fragment,null,D.createElement(R.Helmet,null,D.createElement("title",null,l("Target details"))),D.createElement("div",{className:"pf-c-page__main-breadcrumb"},D.createElement(r.Breadcrumb,{className:"co-breadcrumb"},D.createElement(r.BreadcrumbItem,null,D.createElement($.Link,{className:"pf-c-breadcrumb__link",to:"/monitoring/targets"},l("Targets"))),D.createElement(r.BreadcrumbItem,{isActive:!0},l("Target details")))),D.createElement("div",{className:"co-m-nav-title co-m-nav-title--detail co-m-nav-title--breadcrumbs"},D.createElement("h1",{className:"co-m-pane__heading"},D.createElement("div",{className:"co-resource-item"},i))),D.createElement(De,{data:s,label:"target",loaded:e,loadError:t},D.createElement("div",{className:"co-m-pane__body"},D.createElement(de,{text:l("Target details")}),c&&d&&D.createElement(rr,{loadError:d,title:l("Error loading service monitor data")}),m&&u&&D.createElement(rr,{loadError:u,title:l("Error loading pod monitor data")}),D.createElement("div",{className:"co-m-pane__body-group"},D.createElement("div",{className:"row"},D.createElement("div",{className:"col-sm-6"},D.createElement("dl",{className:"co-m-pane__details"},D.createElement("dt",null,l("Endpoint")),D.createElement("dd",null,i),D.createElement("dt",null,l("Namespace")),D.createElement("dd",null,D.createElement(n.ResourceLink,{kind:"Namespace",name:s?.labels?.namespace})),D.createElement("dt",null,l("Labels")),D.createElement("dd",null,D.createElement(nn,{kind:"metricstarget",labels:s?.labels})),D.createElement("dt",null,l("Last scrape")),D.createElement("dd",null,D.createElement(n.Timestamp,{timestamp:s?.lastScrape})),s?.lastError&&D.createElement(r.Alert,{className:"co-alert",title:l("Scrape failed"),variant:"danger"},s?.lastError))),D.createElement("div",{className:"col-sm-6"},D.createElement("dl",{className:"co-m-pane__details"},D.createElement("dt",null,l("Status")),D.createElement("dd",null,D.createElement(nr,{health:s?.health})),D.createElement("dt",null,l("Monitor")),c&&D.createElement("dd",null,D.createElement(ar,{target:s})),m&&D.createElement("dd",null,D.createElement(tr,{target:s})),!c&&!m&&D.createElement("dd",null,D.createElement(D.Fragment,null,"-")))))))))},or=["pf-u-w-25-on-md","pf-u-w-16-on-md","","pf-u-w-16-on-md","pf-m-hidden pf-m-visible-on-md","pf-m-hidden pf-m-visible-on-md"],sr=({obj:e})=>{const{health:t,labels:a,lastError:l,lastScrape:o,lastScrapeDuration:s,scrapePool:i,scrapeUrl:c}=e,m=i?.includes(Jn.ServiceMonitor),d=i?.includes(Jn.PodMonitor);return D.createElement(D.Fragment,null,D.createElement("td",{className:or[0]},D.createElement($.Link,{to:`./targets/${btoa(c)}`},c)),D.createElement("td",{className:or[1]},m&&D.createElement(ar,{target:e}),d&&D.createElement(tr,{target:e}),!m&&!d&&D.createElement(D.Fragment,null,"-")),D.createElement("td",{className:or[2]},"up"===t?D.createElement(nr,{health:"up"}):D.createElement(r.Tooltip,{content:l},D.createElement("span",null,D.createElement(nr,{health:"down"})))),D.createElement("td",{className:or[3]},a?.namespace&&D.createElement(n.ResourceLink,{inline:!0,kind:me.kind,name:a?.namespace})),D.createElement("td",{className:or[4]},D.createElement(n.Timestamp,{timestamp:o})),D.createElement("td",{className:or[5]},s?`${(1e3*s).toFixed(1)} ms`:"-"))},ir=({data:e,loaded:t,loadError:a,unfilteredData:r})=>{const{t:l}=(0,P.useTranslation)("plugin__monitoring-plugin"),o=D.useMemo((()=>[{id:"scrapeUrl",title:l("Endpoint"),sort:"scrapeUrl",transforms:[m.sortable],props:{className:or[0]}},{id:"monitor",title:l("Monitor"),props:{className:or[1]}},{id:"health",title:l("Status"),sort:"health",transforms:[m.sortable],props:{className:or[2]}},{id:"namespace",title:l("Namespace"),sort:"labels.namespace",transforms:[m.sortable],props:{className:or[3]}},{id:"lastScrape",title:l("Last Scrape"),sort:"lastScrape",transforms:[m.sortable],props:{className:or[4]}},{id:"lastScrapeDuration",title:l("Scrape Duration"),sort:"lastScrapeDuration",transforms:[m.sortable],props:{className:or[5]}}]),[l]);return D.createElement(n.VirtualizedTable,{"aria-label":"metrics targets",columns:o,data:e,loaded:t,loadError:a,Row:sr,unfilteredData:r})},cr=({loaded:e,loadError:t,targets:a})=>{const{t:l}=(0,P.useTranslation)("plugin__monitoring-plugin"),[,,o]=D.useContext(Hn),[,,s]=D.useContext(Xn),i={filter:(e,t)=>(0,Xt.GS)(e.selected?.[0],t.scrapeUrl)||(0,Xt.GS)(e.selected?.[0],t.labels?.namespace),items:[],type:"name"},c=[{filter:(e,t)=>e.selected?.includes(t.health)||(0,g.Z)(e.selected),filterGroupName:l("Status"),items:[{id:"up",title:l("Up")},{id:"down",title:l("Down")}],reducer:e=>e?.health,type:"observe-target-health"},{filter:(e,t)=>e.selected?.includes((0,Xt.Nt)(t))||(0,g.Z)(e.selected),filterGroupName:l("Source"),items:[{id:"platform",title:l("Platform")},{id:"user",title:l("User")}],reducer:Xt.Nt,type:"observe-target-source"}],m=[i,...c],[d,u,p]=(0,n.useListPageFilter)(a,m),b=l("Metrics targets");return D.createElement(D.Fragment,null,D.createElement(R.Helmet,null,D.createElement("title",null,b)),D.createElement(n.ListPageHeader,{title:b}),D.createElement(n.ListPageBody,null,t&&D.createElement(r.Alert,{className:"co-alert",title:l("Error loading latest targets data"),variant:"danger"},t),o&&D.createElement(rr,{loadError:o,title:l("Error loading service monitor data")}),s&&D.createElement(rr,{loadError:s,title:l("Error loading pod monitor data")}),D.createElement(n.ListPageFilter,{data:d,labelFilter:"observe-target-labels",labelPath:"labels",loaded:e,nameFilterPlaceholder:l("Search by endpoint or namespace..."),nameFilterTitle:l("Text"),onFilterChange:p,rowFilters:c}),D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},D.createElement(ir,{data:u??[],loaded:e,loadError:t,unfilteredData:a})))))},mr=()=>{const[e,t]=D.useState(),[a,r]=D.useState(!1),[l,o]=D.useState(),s=(0,n.useK8sWatchResource)({isList:!0,kind:"Service"}),i=(0,n.useK8sWatchResource)({isList:!0,kind:Yn(se)}),c=(0,n.useK8sWatchResource)({isList:!0,kind:ce.kind}),m=(0,n.useK8sWatchResource)({isList:!0,kind:Yn(ie)}),d=D.useCallback((0,Xe.b)(),[]);Wt((()=>d(`${Xt.Uq}/${n.PrometheusEndpoint.TARGETS}?state=active`).then((e=>{t(void 0),r(!0),o(e?.data?.activeTargets)})).catch((e=>{"AbortError"!==e.name&&(t(e),r(!0))}))),15e3);const u=e?.json?.error||e?.message;return D.createElement(Hn.Provider,{value:i},D.createElement(Kn.Provider,{value:s},D.createElement(Xn.Provider,{value:m},D.createElement(er.Provider,{value:c},D.createElement($.Switch,null,D.createElement($.Route,{path:"/monitoring/targets",exact:!0},D.createElement(cr,{loaded:a,loadError:u,targets:l})),D.createElement($.Route,{path:"/monitoring/targets/:scrapeUrl?",exact:!0},D.createElement(lr,{loaded:a,loadError:u,targets:l})))))))};var dr=a(1892),ur=a.n(dr),pr=a(95760),gr=a.n(pr),br=a(38311),Er=a.n(br),Ar=a(58192),hr=a.n(Ar),vr=a(38060),_r=a.n(vr),fr=a(54865),wr=a.n(fr),yr=a(67380),Cr={};Cr.styleTagTransform=wr(),Cr.setAttributes=hr(),Cr.insert=Er().bind(null,"head"),Cr.domAPI=gr(),Cr.insertStyleElement=_r(),ur()(yr.Z,Cr),yr.Z&&yr.Z.locals&&yr.Z.locals;const xr=D.createContext({selectedSilences:new Set,setSelectedSilences:void 0}),Sr=e=>`${Xt.X1.plural}/${p.Z(e,"id")}`,Nr=e=>void 0===e.sourceId||"prometheus"===e.sourceId?"openshift-monitoring/k8s"===e.labels?.prometheus?"platform":"user":e.sourceId,kr=e=>Nr(e.rule),Br={},qr={},Ir=e=>`${Xt.sU.plural}/~new?${(0,Xt.Hp)(e.labels)}`,Tr=({className:e,resource:t})=>D.createElement("span",{className:u()(`co-m-resource-icon co-m-resource-${t.kind.toLowerCase()}`,e),title:t.label},t.abbr),Zr=D.memo((({state:e})=>{switch(e){case"firing":return D.createElement(l.Dk,null);case"pending":return D.createElement(o.V_,null);case"silenced":return D.createElement(s.ow,{className:"text-muted"});default:return null}})),Fr=(e,t)=>{switch(e){case"firing":return t("Firing");case"pending":return t("Pending");case"silenced":return t("Silenced");default:return t("Not Firing")}},Dr=D.memo((({state:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=D.createElement(Zr,{state:e});return a?D.createElement(D.Fragment,null,a," ",Fr(e,t)):null})),Rr=({silence:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=(0,Xt.SI)(e),r={active:D.createElement(n.GreenCheckCircleIcon,null),pending:D.createElement(i.dE,{className:"monitoring-state-icon--pending"}),expired:D.createElement(c.SC,{className:"text-muted","data-test-id":"ban-icon"})}[a];return r?D.createElement(D.Fragment,null,r," ",(e=>{switch(e){case"active":return t("Active");case"pending":return t("Pending");default:return t("Expired")}})(a)):null},Pr=({text:e,timestamp:t})=>D.createElement("div",{className:"text-muted monitoring-timestamp"},e," ",D.createElement(n.Timestamp,{timestamp:t})),Lr=({alert:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin");return e&&!g.Z(e.silencedBy)?D.createElement(Pr,{text:t("Ends"),timestamp:b.Z(E.Z(e.silencedBy,"endsAt"))}):e&&e.activeAt?D.createElement(Pr,{text:t("Since"),timestamp:e.activeAt}):null},$r=D.memo((({severity:e})=>{const t={critical:n.RedExclamationCircleIcon,info:n.BlueInfoCircleIcon,none:n.BlueInfoCircleIcon,warning:n.YellowExclamationTriangleIcon}[e]||n.YellowExclamationTriangleIcon;return D.createElement(t,null)})),Mr=D.memo((({severity:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin");return A.Z(e)?D.createElement(D.Fragment,null,"-"):D.createElement(D.Fragment,null,D.createElement($r,{severity:e})," ",(e=>{switch(e){case"critical":return t("Critical");case"info":return t("Info");case"warning":return t("Warning");case"none":return t("None");default:return e}})(e))})),Gr=D.memo((({severity:e})=>A.Z(e)||"none"===e?null:D.createElement(n.ResourceStatus,null,D.createElement(Mr,{severity:e})))),jr=({alerts:e})=>{if(g.Z(e))return D.createElement(D.Fragment,null,"-");const t=h.Z(e,(e=>{const{severity:t}=e.labels;return"critical"===t||"warning"===t?t:"info"})),a=["critical","warning","info"].filter((e=>t[e]>0));return D.createElement(D.Fragment,null,a.map((e=>D.createElement("span",{className:"monitoring-icon-wrap",key:e},D.createElement($r,{severity:e})," ",t[e]))))},Ur=({alerts:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=h.Z(e,"state"),n=["firing","pending","silenced"].filter((e=>a[e]>0));return D.createElement(D.Fragment,null,n.map((e=>D.createElement("div",{className:"monitoring-icon-wrap",key:e},D.createElement(Zr,{state:e})," ",a[e]," ",Fr(e,t)))))},Or=({bodyContent:e,label:t})=>D.createElement(r.Popover,{headerContent:t,bodyContent:e},D.createElement(r.Button,{variant:"plain",className:"details-item__popover-button"},t)),zr=()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement("dl",{className:"co-inline"},D.createElement("dt",null,D.createElement(Zr,{state:"pending"})," ",D.createElement("strong",null,e("Pending: "))),D.createElement("dd",null,e("The alert is active but is waiting for the duration that is specified in the alerting rule before it fires.")),D.createElement("dt",null,D.createElement(Zr,{state:"firing"})," ",D.createElement("strong",null,e("Firing: "))),D.createElement("dd",null,e("The alert is firing because the alert condition is true and the optional `for` duration has passed. The alert will continue to fire as long as the condition remains true.")),D.createElement("dt",null,D.createElement(Zr,{state:"silenced"})," ",D.createElement("strong",null,e("Silenced: "))),D.createElement("dt",null),D.createElement("dd",null,e("The alert is now silenced for a defined time period. Silences temporarily mute alerts based on a set of label selectors that you define. Notifications will not be sent for alerts that match all the listed values or regular expressions.")))},Qr=()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement("dl",{className:"co-inline"},D.createElement("dt",null,D.createElement($r,{severity:"critical"})," ",D.createElement("strong",null,e("Critical: "))),D.createElement("dd",null,e("The condition that triggered the alert could have a critical impact. The alert requires immediate attention when fired and is typically paged to an individual or to a critical response team.")),D.createElement("dt",null,D.createElement($r,{severity:"warning"})," ",D.createElement("strong",null,e("Warning: "))),D.createElement("dd",null,e("The alert provides a warning notification about something that might require attention in order to prevent a problem from occurring. Warnings are typically routed to a ticketing system for non-immediate review.")),D.createElement("dt",null,D.createElement($r,{severity:"info"})," ",D.createElement("strong",null,e("Info: "))),D.createElement("dd",null,e("The alert is provided for informational purposes only.")),D.createElement("dt",null,D.createElement($r,{severity:"none"})," ",D.createElement("strong",null,e("None: "))),D.createElement("dd",null,e("The alert has no defined severity.")),D.createElement("dd",null,e("You can also create custom severity definitions for user workload alerts.")))},Vr=()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement("dl",{className:"co-inline"},D.createElement("dt",null,D.createElement("strong",null,e("Platform: "))),D.createElement("dd",null,e("Platform-level alerts relate only to OpenShift namespaces. OpenShift namespaces provide core OpenShift functionality.")),D.createElement("dt",null,D.createElement("strong",null,e("User: "))),D.createElement("dd",null,e("User workload alerts relate to user-defined namespaces. These alerts are user-created and are customizable. User workload monitoring can be enabled post-installation to provide observability into your own services.")))},Wr=e=>"href"in e.cta,Yr=e=>"function"==typeof e.cta,Jr=(e,t)=>t?`/dev-monitoring/ns/${t}/metrics?query0=${encodeURIComponent(e)}`:`/monitoring/query-browser?query0=${encodeURIComponent(e)}`,Hr=({filterLabels:e,formatSeriesTitle:t,namespace:a,query:n,ruleDuration:r})=>{const{t:l}=(0,P.useTranslation)("plugin__monitoring-plugin"),o=1e3*Math.max(3*r,1800);return D.createElement(Aa,{namespace:a,defaultTimespan:o,filterLabels:e,formatSeriesTitle:t,GraphLink:()=>n?D.createElement($.Link,{"aria-label":l("View in Metrics"),to:Jr(n,a)},l("View in Metrics")):null,pollInterval:Math.round(o/120),queries:[n]})},Kr=["pf-c-table__action","pf-u-w-50 pf-u-w-33-on-sm","pf-m-hidden pf-m-visible-on-sm","","pf-m-hidden pf-m-visible-on-sm","dropdown-kebab-pf pf-c-table__action"],Xr=({silence:e})=>D.createElement("div",{className:`co-text-${Xt.sU.kind.toLowerCase()}`},E.Z(e.matchers,(({name:e,isEqual:t,isRegex:a,value:n},l)=>D.createElement(r.Label,{className:"co-label",key:l},D.createElement("span",{className:"co-label__key"},e),D.createElement("span",{className:"co-label__eq"},(0,Xt.wX)(t,a)),D.createElement("span",{className:"co-label__value"},n))))),el=({obj:e,showCheckbox:t})=>{const{t:a}=(0,P.useTranslation)("plugin__monitoring-plugin"),{createdBy:n,endsAt:l,firingAlerts:o,id:s,name:i,startsAt:c}=e,m=(0,Xt.SI)(e),{selectedSilences:d,setSelectedSilences:p}=D.useContext(xr),g=D.useCallback((e=>{p((t=>{const a=new Set(t);return e?a.add(s):a.delete(s),a}))}),[s,p]);return D.createElement(D.Fragment,null,t&&D.createElement("td",{className:Kr[0]},D.createElement(r.Checkbox,{id:s,isChecked:d.has(s),isDisabled:"expired"===m,onChange:g})),D.createElement("td",{className:Kr[1]},D.createElement("div",{className:"co-resource-item"},D.createElement(Tr,{resource:Xt.sU}),D.createElement($.Link,{className:"co-resource-item__resource-name","data-test-id":"silence-resource-link",title:s,to:`${Xt.sU.plural}/${s}`},i)),D.createElement("div",{className:"monitoring-label-list"},D.createElement(Xr,{silence:e}))),D.createElement("td",{className:Kr[2]},D.createElement(jr,{alerts:o})),D.createElement("td",{className:u()(Kr[3],"co-break-word")},D.createElement(Rr,{silence:e}),"pending"===m&&D.createElement(Pr,{text:a("Starts"),timestamp:c}),"active"===m&&D.createElement(Pr,{text:a("Ends"),timestamp:l}),"expired"===m&&D.createElement(Pr,{text:a("Expired"),timestamp:l})),D.createElement("td",{className:Kr[4]},n||"-"),D.createElement("td",{className:Kr[5]},D.createElement(gl,{silence:e})))},tl=({obj:e})=>D.createElement(el,{showCheckbox:!0,obj:e}),al={container:{kind:"Container"},daemonset:{namespaced:!0,kind:"DaemonSet"},deployment:{namespaced:!0,kind:"Deployment"},job:{namespaced:!0,kind:"Job"},namespace:me,node:{kind:"Node"},pod:ce,statefulset:{namespaced:!0,kind:"StatefulSet"}},nl=(e,t)=>v.Z(e.match(new RegExp(t,"g"))),rl=({alertText:e,labels:t,template:a})=>{if(g.Z(e))return null;let r=[e];return _.Z(al,((l,o)=>{const s=t[o];if(s&&(!l.namespaced||!g.Z(t.namespace))){const i=nl(a,`\\{\\{ *\\$labels\\.${o} *\\}\\}`),c=nl(e,f.Z(s));if(i>0&&i===c){const e=D.createElement(n.ResourceLink,{className:"co-resource-item--monitoring-alert",inline:!0,key:l.kind,kind:l.kind,name:s,namespace:l.namespaced?t.namespace:void 0});r=w.Z(r,(t=>{if(y.Z(t)&&-1!==t.indexOf(s)){const a=t.split(s);return w.Z(a,(t=>[t,e])).slice(0,-1)}return[t]}))}}})),D.createElement("div",{className:"co-alert-manager"},D.createElement("p",null,D.createElement(ge,null,r)))},ll=({alert:e,rule:t})=>{const a=e.annotations.description?"description":"message";return D.createElement(rl,{alertText:e.annotations[a],labels:e.labels,template:t.annotations[a]})},ol=(e,t)=>{switch(e){case"Platform":return t("Platform");case"User":return t("User");default:return e}},sl=({silences:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=D.useMemo((()=>[{id:"name",props:{className:Kr[1]},title:t("Name")},{id:"firingAlerts",props:{className:Kr[2]},title:t("Firing alerts")},{id:"state",props:{className:Kr[3]},title:t("State")},{id:"createdBy",props:{className:Kr[4]},title:t("Creator")},{id:"actions",props:{className:Kr[5]},title:""}]),[t]);return D.createElement(n.VirtualizedTable,{"aria-label":t("Silenced by"),columns:a,data:e,loaded:!0,loadError:void 0,Row:el,unfilteredData:e})},il=te((0,$.withRouter)((({history:e,match:t})=>{const{t:a}=(0,P.useTranslation)("plugin__monitoring-plugin"),l=C.Z(t.params,"ns"),o=t.params?.ns,s=(0,L.useSelector)((({observe:e})=>!!e.get("hideGraphs"))),i=(0,L.useSelector)((({observe:e})=>e.get(l?"devAlerts":"alerts"))),c=x.Z(i?.data,(e=>e.rule.id===t?.params?.ruleID)),m=c?.[0]?.rule,d=Ae(),u=x.Z(c,(e=>S.Z(e.labels,d))),b=1===u.length?u[0]:void 0,E=(0,Xt.fp)(b),A=JSON.stringify(b?.labels),h=D.useMemo((()=>b?.labels),[A]),v=b?.annotations?.runbook_url,_=m?.sourceId,[f]=(0,n.useResolvedExtensions)(ne),w=f.filter((e=>e.properties.sourceId===_)).map((e=>e.properties.chart)),y=w?.[0];return D.createElement(D.Fragment,null,D.createElement(De,{data:b,label:Xt.vQ.label,loaded:i?.loaded,loadError:i?.loadError},D.createElement("div",{className:"pf-c-page__main-breadcrumb"},D.createElement(r.Breadcrumb,{className:"monitoring-breadcrumbs"},D.createElement(r.BreadcrumbItem,null,D.createElement($.Link,{className:"pf-c-breadcrumb__link",to:o?`/dev-monitoring/ns/${o}/alerts`:"/monitoring/alerts"},a("Alerts"))),D.createElement(r.BreadcrumbItem,{isActive:!0},a("Alert details")))),D.createElement("div",{className:"co-m-nav-title co-m-nav-title--detail co-m-nav-title--breadcrumbs"},D.createElement("h1",{className:"co-m-pane__heading"},D.createElement("div",{"data-test":"resource-title",className:"co-resource-item"},D.createElement(Tr,{className:"co-m-resource-icon--lg",resource:Xt.vQ}),h?.alertname,D.createElement(Gr,{severity:h?.severity})),"silenced"!==E&&D.createElement("div",{"data-test-id":"details-actions"},D.createElement(r.Button,{className:"co-action-buttons__btn",onClick:()=>e.push(Ir(b)),variant:"primary"},a("Silence alert")))),D.createElement(ll,{alert:b,rule:m})),D.createElement("div",{className:"co-m-pane__body"},D.createElement(r.Toolbar,{className:"monitoring-alert-detail-toolbar"},D.createElement(r.ToolbarContent,null,D.createElement(r.ToolbarItem,{variant:"label"},D.createElement(de,{text:a("Alert details")})),D.createElement(r.ToolbarGroup,{alignment:{default:"alignRight"}},D.createElement(n.ActionServiceProvider,{context:{"alert-detail-toolbar-actions":{alert:b}}},(({actions:e,loaded:t})=>t?e.map((e=>Wr(e)?D.createElement(r.ToolbarItem,{key:e.id,spacer:{default:"spacerNone"},className:"pf-u-px-md"},D.createElement($.Link,{to:e.cta.href},e.label)):Yr(e)?D.createElement(r.ToolbarItem,{key:e.id,spacer:{default:"spacerNone"}},D.createElement(r.Button,{variant:"link",onClick:e.cta},e.label)):null)):null)),D.createElement(r.ToolbarItem,null,D.createElement(pn,null))))),D.createElement("div",{className:"co-m-pane__body-group"},D.createElement("div",{className:"row"},D.createElement("div",{className:"col-sm-12"},_&&"prometheus"!==_?y&&!s?D.createElement(y,{rule:m}):null:D.createElement(Hr,{filterLabels:h,namespace:o,query:m?.query,ruleDuration:m?.duration}))),D.createElement("div",{className:"row"},D.createElement("div",{className:"col-sm-6"},D.createElement("dl",{className:"co-m-pane__details"},D.createElement("dt",null,a("Name")),D.createElement("dd",null,h?.alertname),D.createElement("dt",null,D.createElement(Or,{bodyContent:D.createElement(Qr,null),label:a("Severity")})),D.createElement("dd",null,D.createElement(Mr,{severity:h?.severity})),b?.annotations?.description&&D.createElement(D.Fragment,null,D.createElement("dt",null,a("Description")),D.createElement("dd",null,D.createElement(rl,{alertText:b.annotations.description,labels:h,template:m?.annotations?.description}))),b?.annotations?.summary&&D.createElement(D.Fragment,null,D.createElement("dt",null,a("Summary")),D.createElement("dd",null,b.annotations.summary)),b?.annotations?.message&&D.createElement(D.Fragment,null,D.createElement("dt",null,a("Message")),D.createElement("dd",null,D.createElement(rl,{alertText:b.annotations.message,labels:h,template:m?.annotations?.message}))),v&&D.createElement(D.Fragment,null,D.createElement("dt",null,a("Runbook")),D.createElement("dd",null,D.createElement(pe,{href:v,text:v}))))),D.createElement("div",{className:"col-sm-6"},D.createElement("dl",{className:"co-m-pane__details"},D.createElement("dt",null,D.createElement(Or,{bodyContent:D.createElement(Vr,null),label:a("Source")})),D.createElement("dd",null,b&&ol(N.Z(kr(b)),a)),D.createElement("dt",null,D.createElement(Or,{bodyContent:D.createElement(zr,null),label:a("State")})),D.createElement("dd",null,D.createElement(Dr,{state:E}),D.createElement(Lr,{alert:b})))))),D.createElement("div",{className:"co-m-pane__body-group"},D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},D.createElement("dl",{className:"co-m-pane__details","data-test":"label-list"},D.createElement("dt",null,a("Labels")),D.createElement("dd",null,D.createElement(nn,{kind:"alert",labels:h})))))),D.createElement("div",{className:"co-m-pane__body-group"},D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},D.createElement("dl",{className:"co-m-pane__details"},D.createElement("dt",null,a("Alerting rule")),D.createElement("dd",null,D.createElement("div",{className:"co-resource-item"},D.createElement(Tr,{resource:Xt.X1}),D.createElement($.Link,{to:o?`/dev-monitoring/ns/${o}/rules/${m?.id}`:Sr(m),"data-test":"alert-rules-detail-resource-link",className:"co-resource-item__resource-name"},p.Z(m,"name"))))))))),(({observe:e})=>e.get("silences")?.loaded)&&!g.Z(b?.silencedBy)&&D.createElement("div",{className:"co-m-pane__body"},D.createElement("div",{className:"co-m-pane__body-group"},D.createElement(de,{text:a("Silenced by")}),D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},D.createElement(sl,{silences:b?.silencedBy})))))))}))),cl=({text:e})=>D.createElement(D.Fragment,null,e?.split(/(\{\{[^{}]*\}\})/)?.map(((e,t)=>e.match(/^\{\{[^{}]*\}\}$/)?D.createElement("code",{className:"co-code prometheus-template-tag",key:t},e):e))),ml=(0,$.withRouter)((({alerts:e,history:t,namespace:a,ruleID:l})=>{const{t:o}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement("div",{className:"co-m-table-grid co-m-table-grid--bordered"},D.createElement("div",{className:"row co-m-table-grid__head"},D.createElement("div",{className:"col-xs-6"},o("Description")),D.createElement("div",{className:"col-sm-2 hidden-xs"},o("Active since")),D.createElement("div",{className:"col-sm-2 col-xs-3"},o("State")),D.createElement("div",{className:"col-sm-2 col-xs-3"},o("Value"))),D.createElement("div",{className:"co-m-table-grid__body"},k.Z(e,Xt.IS).map(((e,s)=>D.createElement("div",{className:"row co-resource-list__item",key:s},D.createElement("div",{className:"col-xs-6"},D.createElement($.Link,{className:"co-resource-item","data-test":"active-alerts",to:a?`/dev-monitoring/ns/${a}/alerts/${l}?${(0,Xt.Hp)(e.labels)}`:(0,Xt.bZ)(e,l)},(0,Xt.IS)(e))),D.createElement("div",{className:"col-sm-2 hidden-xs"},D.createElement(n.Timestamp,{timestamp:e.activeAt})),D.createElement("div",{className:"col-sm-2 col-xs-3"},D.createElement(Dr,{state:e.state})),D.createElement("div",{className:"col-sm-2 col-xs-3 co-truncate"},e.value),"silenced"!==e.state&&D.createElement("div",{className:"dropdown-kebab-pf"},D.createElement(tn,{dropdownItems:[D.createElement(r.DropdownItem,{component:"button",key:"silence",onClick:()=>t.push(Ir(e))},o("Silence alert"))]})))))))})),dl=te((({match:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=C.Z(e.params,"ns"),l=e.params?.ns,o=(0,L.useSelector)((({observe:e})=>e.get(a?"devRules":"rules"))),s=B.Z(o,{id:p.Z(e,"params.id")}),{loaded:i,loadError:c}=(0,L.useSelector)((({observe:e})=>e.get(a?"devAlerts":"alerts")||{})),m=s?.sourceId,[d]=(0,n.useResolvedExtensions)(ne),u=d.filter((e=>e.properties.sourceId===m)).map((e=>e.properties.chart))[0],b=s?.annotations?.runbook_url;return D.createElement(D.Fragment,null,D.createElement(R.Helmet,null,D.createElement("title",null,t("{{name}} details",{name:s?.name||Xt.X1.label}))),D.createElement(De,{data:s,label:Xt.X1.label,loaded:i,loadError:c},D.createElement("div",{className:"pf-c-page__main-breadcrumb"},D.createElement(r.Breadcrumb,{className:"monitoring-breadcrumbs"},D.createElement(r.BreadcrumbItem,null,D.createElement($.Link,{className:"pf-c-breadcrumb__link",to:l?`/dev-monitoring/ns/${l}/alerts`:"/monitoring/alertrules"},t(l?"Alerts":"Alerting rules"))),D.createElement(r.BreadcrumbItem,{isActive:!0},t("Alerting rule details")))),D.createElement("div",{className:"co-m-nav-title co-m-nav-title--detail co-m-nav-title--breadcrumbs"},D.createElement("h1",{className:"co-m-pane__heading"},D.createElement("div",{"data-test":"resource-title",className:"co-resource-item"},D.createElement(Tr,{className:"co-m-resource-icon--lg",resource:Xt.X1}),s?.name,D.createElement(Gr,{severity:s?.labels?.severity})))),D.createElement("div",{className:"co-m-pane__body"},D.createElement("div",{className:"monitoring-heading"},D.createElement(de,{text:t("Alerting rule details")})),D.createElement("div",{className:"co-m-pane__body-group"},D.createElement("div",{className:"row"},D.createElement("div",{className:"col-sm-6"},D.createElement("dl",{className:"co-m-pane__details"},D.createElement("dt",null,t("Name")),D.createElement("dd",null,s?.name),D.createElement("dt",null,D.createElement(Or,{bodyContent:D.createElement(Qr,null),label:t("Severity")})),D.createElement("dd",null,D.createElement(Mr,{severity:s?.labels?.severity})),s?.annotations?.description&&D.createElement(D.Fragment,null,D.createElement("dt",null,t("Description")),D.createElement("dd",null,D.createElement(cl,{text:s.annotations.description}))),s?.annotations?.summary&&D.createElement(D.Fragment,null,D.createElement("dt",null,t("Summary")),D.createElement("dd",null,s.annotations.summary)),s?.annotations?.message&&D.createElement(D.Fragment,null,D.createElement("dt",null,t("Message")),D.createElement("dd",null,D.createElement(cl,{text:s.annotations.message}))),b&&D.createElement(D.Fragment,null,D.createElement("dt",null,t("Runbook")),D.createElement("dd",null,D.createElement(pe,{href:b,text:b}))))),D.createElement("div",{className:"col-sm-6"},D.createElement("dl",{className:"co-m-pane__details"},D.createElement("dt",null,D.createElement(Or,{bodyContent:D.createElement(Vr,null),label:t("Source")})),D.createElement("dd",null,s&&ol(N.Z(Nr(s)),t)),I.Z(s?.duration)&&D.createElement(D.Fragment,null,D.createElement("dt",null,t("For")),D.createElement("dd",null,0===s.duration?"-":J(1e3*s.duration))),D.createElement("dt",null,t("Expression")),D.createElement("dd",null,m&&"prometheus"!==m?D.createElement(r.CodeBlock,null,D.createElement(r.CodeBlockCode,null,s?.query)):D.createElement($.Link,{to:Jr(s?.query,l)},D.createElement(r.CodeBlock,null,D.createElement(r.CodeBlockCode,null,s?.query)))))))),D.createElement("div",{className:"co-m-pane__body-group"},D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},D.createElement("dl",{className:"co-m-pane__details"},D.createElement("dt",null,t("Labels")),D.createElement("dd",null,D.createElement(nn,{kind:"alertrule",labels:s?.labels}))))))),D.createElement("div",{className:"co-m-pane__body"},D.createElement("div",{className:"co-m-pane__body-group"},D.createElement(r.Toolbar,{className:"monitoring-alert-detail-toolbar"},D.createElement(r.ToolbarContent,null,D.createElement(r.ToolbarItem,{variant:"label"},D.createElement(de,{text:t("Active alerts")})),D.createElement(r.ToolbarGroup,{alignment:{default:"alignRight"}},D.createElement(r.ToolbarItem,null,D.createElement(pn,null))))),D.createElement("div",{className:"row"},D.createElement("div",{className:"col-sm-12"},m&&"prometheus"!==m?u?D.createElement(u,{rule:s}):null:D.createElement(Hr,{formatSeriesTitle:e=>{const t=e.__name__??"",a=q.Z(e,"__name__");return`${t}{${E.Z(a,((e,t)=>`${t}="${e}"`)).join(",")}}`},namespace:l,query:s?.query,ruleDuration:s?.duration,showLegend:!0}))),D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},g.Z(s?.alerts)?D.createElement("div",{className:"pf-u-text-align-center"},t("None found")):D.createElement(ml,{alerts:s.alerts,ruleID:s?.id,namespace:l})))))))})),ul=({isOpen:e,setClosed:t,silenceID:a})=>{const{t:l}=(0,P.useTranslation)("plugin__monitoring-plugin"),o=(0,L.useDispatch)(),[s,,i,c]=tt(!1),[m,d]=D.useState();return D.createElement(r.Modal,{isOpen:e,position:"top",showClose:!1,title:l("Expire silence"),variant:r.ModalVariant.small},D.createElement(r.Flex,{direction:{default:"column"}},D.createElement(r.FlexItem,null,l("Are you sure you want to expire this silence?")),D.createElement(r.Flex,{direction:{default:"column"}},D.createElement(r.FlexItem,null,m&&D.createElement(r.Alert,{className:"co-alert co-alert--scrollable",isInline:!0,title:l("An error occurred"),variant:"danger"},D.createElement("div",{className:"co-pre-line"},m))),D.createElement(r.Flex,null,D.createElement(r.FlexItem,null,s&&D.createElement(Be,null)),D.createElement(r.FlexItem,{align:{default:"alignRight"}},D.createElement(r.Button,{variant:"secondary",onClick:t},l("Cancel"))),D.createElement(r.FlexItem,null,D.createElement(r.Button,{variant:"primary",onClick:()=>{i(),n.consoleFetchJSON.delete(`${window.SERVER_FLAGS.alertManagerBaseURL}/api/v2/silence/${a}`).then((()=>{(0,Xt.rH)(o),t()})).catch((e=>{d(p.Z(e,"json.error")||e.message||"Error expiring silence"),c()})).then(c)}},l("Expire silence")))))))},pl=(0,$.withRouter)((({className:e,history:t,isPlain:a,silence:n,Toggle:l})=>{const{t:o}=(0,P.useTranslation)("plugin__monitoring-plugin"),[s,i,,c]=tt(!1),[m,,d,u]=tt(!1),p=()=>{t.push(`${Xt.sU.plural}/${n.id}/edit`)},g="expired"===(0,Xt.SI)(n)?[D.createElement(r.DropdownItem,{key:"edit-silence",component:"button",onClick:p},o("Recreate silence"))]:[D.createElement(r.DropdownItem,{key:"edit-silence",component:"button",onClick:p},o("Edit silence")),D.createElement(r.DropdownItem,{key:"cancel-silence",component:"button",onClick:d},o("Expire silence"))];return D.createElement(D.Fragment,null,D.createElement(r.Dropdown,{className:e,"data-test":"silence-actions",dropdownItems:g,isOpen:s,isPlain:a,onSelect:c,position:r.DropdownPosition.right,toggle:D.createElement(l,{onToggle:i})}),D.createElement(ul,{isOpen:m,setClosed:u,silenceID:n.id}))})),gl=({silence:e})=>D.createElement(pl,{isPlain:!0,silence:e,Toggle:r.KebabToggle}),bl=({onToggle:e,...t})=>D.createElement(r.DropdownToggle,{"data-test":"silence-actions-toggle",onToggle:e,...t},"Actions"),El=({silence:e})=>D.createElement(pl,{className:"co-actions-menu",silence:e,Toggle:bl}),Al=(0,$.withRouter)((({alerts:e,history:t})=>{const{t:a}=(0,P.useTranslation)("plugin__monitoring-plugin");return g.Z(e)?D.createElement("div",{className:"pf-u-text-align-center"},a("None found")):D.createElement("div",{className:"co-m-table-grid co-m-table-grid--bordered"},D.createElement("div",{className:"row co-m-table-grid__head"},D.createElement("div",{className:"col-xs-9"},a("Name")),D.createElement("div",{className:"col-xs-3"},a("Severity"))),D.createElement("div",{className:"co-m-table-grid__body"},k.Z(e,Xt.IS).map(((e,n)=>D.createElement("div",{className:"row co-resource-list__item",key:n},D.createElement("div",{className:"col-xs-9"},D.createElement($.Link,{className:"co-resource-item","data-test":"firing-alerts",to:(0,Xt.bZ)(e,e.rule.id)},e.labels.alertname),D.createElement("div",{className:"monitoring-description"},(0,Xt.IS)(e))),D.createElement("div",{className:"col-xs-3"},D.createElement(Mr,{severity:e.labels.severity})),D.createElement("div",{className:"dropdown-kebab-pf"},D.createElement(tn,{dropdownItems:[D.createElement(r.DropdownItem,{key:"view-rule",onClick:()=>t.push(Sr(e.rule))},a("View alerting rule"))]})))))))})),hl=te((({match:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),[a]=(()=>{const{namespace:e,setNamespace:t}=D.useContext(K);return[e,t]})(),[l]=(0,n.useActivePerspective)(),o=(0,L.useSelector)((({observe:e})=>e.get("dev"===l?"devAlerts":"alerts")?.loaded)),s=(0,L.useSelector)((({observe:e})=>e.get("silences"))),i=B.Z(s?.data,{id:p.Z(e,"params.id")});return D.createElement(D.Fragment,null,D.createElement(R.Helmet,null,D.createElement("title",null,t("{{name}} details",{name:i?.name||Xt.sU.label}))),D.createElement(De,{data:i,label:Xt.sU.label,loaded:s?.loaded,loadError:s?.loadError},D.createElement("div",{className:"pf-c-page__main-breadcrumb"},D.createElement(r.Breadcrumb,{className:"monitoring-breadcrumbs"},D.createElement(r.BreadcrumbItem,null,D.createElement($.Link,{className:"pf-c-breadcrumb__link",to:"dev"===l?`/dev-monitoring/ns/${a}/alerts`:"/monitoring/silences"},t("dev"===l?"Alerts":"Silences"))),D.createElement(r.BreadcrumbItem,{isActive:!0},t("Silence details")))),D.createElement("div",{className:"co-m-nav-title co-m-nav-title--detail co-m-nav-title--breadcrumbs"},D.createElement("h1",{className:"co-m-pane__heading"},D.createElement("div",{"data-test":"resource-title",className:"co-resource-item"},D.createElement(Tr,{className:"co-m-resource-icon--lg",resource:Xt.sU}),i?.name),D.createElement("div",{className:"co-actions","data-test-id":"details-actions"},i&&D.createElement(El,{silence:i})))),D.createElement("div",{className:"co-m-pane__body"},D.createElement(de,{text:t("Silence details")}),D.createElement("div",{className:"co-m-pane__body-group"},D.createElement("div",{className:"row"},D.createElement("div",{className:"col-sm-6"},D.createElement("dl",{className:"co-m-pane__details"},i?.name&&D.createElement(D.Fragment,null,D.createElement("dt",null,t("Name")),D.createElement("dd",null,i?.name)),D.createElement("dt",null,t("Matchers")),D.createElement("dd",{"data-test":"label-list"},g.Z(i?.matchers)?D.createElement("div",{className:"text-muted"},t("No matchers")):D.createElement(Xr,{silence:i})),D.createElement("dt",null,t("State")),D.createElement("dd",null,D.createElement(Rr,{silence:i})),D.createElement("dt",null,t("Last updated at")),D.createElement("dd",null,D.createElement(n.Timestamp,{timestamp:i?.updatedAt})))),D.createElement("div",{className:"col-sm-6"},D.createElement("dl",{className:"co-m-pane__details"},D.createElement("dt",null,t("Starts at")),D.createElement("dd",null,D.createElement(n.Timestamp,{timestamp:i?.startsAt})),D.createElement("dt",null,t("Ends at")),D.createElement("dd",null,D.createElement(n.Timestamp,{timestamp:i?.endsAt})),D.createElement("dt",null,t("Created by")),D.createElement("dd",null,i?.createdBy||"-"),D.createElement("dt",null,t("Comment")),D.createElement("dd",null,i?.comment||"-"),D.createElement("dt",null,t("Firing alerts")),D.createElement("dd",null,o?D.createElement(jr,{alerts:i?.firingAlerts}):D.createElement(Be,null))))))),D.createElement("div",{className:"co-m-pane__body"},D.createElement("div",{className:"co-m-pane__body-group"},D.createElement(de,{text:t("Firing alerts")}),D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},o?D.createElement(Al,{alerts:i?.firingAlerts}):D.createElement(Be,null)))))))})),vl=["pf-u-w-50 pf-u-w-33-on-sm","pf-m-hidden pf-m-visible-on-sm","","pf-m-hidden pf-m-visible-on-sm","dropdown-kebab-pf pf-c-table__action"],_l=(0,$.withRouter)((({history:e,obj:t})=>{const{t:a}=(0,P.useTranslation)("plugin__monitoring-plugin"),{annotations:l={},labels:o}=t,s=l.description||l.message,i=(0,Xt.fp)(t),c=t.annotations?.description||t.annotations?.message,m=[D.createElement(r.DropdownItem,{key:"view-rule",onClick:()=>e.push(Sr(t.rule))},a("View alerting rule"))];"silenced"!==i&&m.unshift(D.createElement(r.DropdownItem,{key:"silence-alert",onClick:()=>e.push(Ir(t))},a("Silence alert")));const d=e=>{const t=[];return e.forEach((e=>{Wr(e)?t.push(D.createElement(r.DropdownItem,{key:e.id,href:e.cta.href},e.label)):Yr(e)&&t.push(D.createElement(r.DropdownItem,{key:e.id,onClick:e.cta},e.label))})),m.concat(t)};return D.createElement(D.Fragment,null,D.createElement("td",{className:vl[0],title:c},D.createElement("div",{className:"co-resource-item"},D.createElement(Tr,{resource:Xt.vQ}),D.createElement($.Link,{to:(0,Xt.bZ)(t,t.rule.id),"data-test-id":"alert-resource-link",className:"co-resource-item__resource-name"},o?.alertname)),D.createElement("div",{className:"monitoring-description"},s)),D.createElement("td",{className:vl[1],title:c},D.createElement(Mr,{severity:o?.severity})),D.createElement("td",{className:vl[2],title:c},D.createElement(Dr,{state:i}),D.createElement(Lr,{alert:t})),D.createElement("td",{className:vl[3],title:c},"user"===kr(t)?a("User"):a("Platform")),D.createElement("td",{className:vl[4],title:c},D.createElement(n.ActionServiceProvider,{context:{"monitoring-alert-list-item":{alert:t}}},(({actions:e,loaded:t})=>t&&e.length>0?D.createElement(tn,{dropdownItems:d(e)}):D.createElement(tn,{dropdownItems:m})))))})),fl=e=>({filter:(e,t)=>e.selected?.includes(t.labels?.severity)||g.Z(e.selected),filterGroupName:e("Severity"),items:[{id:"critical",title:e("Critical")},{id:"warning",title:e("Warning")},{id:"info",title:e("Info")},{id:"none",title:e("None")}],reducer:({labels:e})=>e?.severity,type:"alert-severity"}),wl=({silencesLoadError:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement(r.Alert,{className:"co-alert",isInline:!0,title:t("Error loading silences from Alertmanager. Some of the alerts below may actually be silenced."),variant:"warning"},e.json?.error||e.message)},yl=e=>[["firing","pending","silenced"].indexOf((0,Xt.fp)(e)),"silenced"===(0,Xt.fp)(e)?b.Z(E.Z(e.silencedBy,"endsAt")):p.Z(e,"activeAt")],Cl=(e,t)=>{if(e){const a=new Set;return e.forEach((e=>{const n=t(e);"platform"!==n&&"user"!==n&&a.add(n)})),Array.from(a).map((e=>({id:e,title:N.Z(e)})))}return[]},xl=te((()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin"),{data:t,loaded:a=!1,loadError:r}=(0,L.useSelector)((({observe:e})=>e.get("alerts")||{})),l=(0,L.useSelector)((({observe:e})=>e.get("silences")?.loadError)),o=D.useMemo((()=>Cl(t,kr)),[t]),s=[{filter:(e,t)=>(0,Xt.GS)(e.selected?.[0],t.labels?.alertname),filterGroupName:"",items:[],type:"name"},{defaultSelected:["firing"],filter:(e,t)=>e.selected?.includes((0,Xt.fp)(t))||g.Z(e.selected),filterGroupName:e("Alert State"),items:[{id:"firing",title:e("Firing")},{id:"pending",title:e("Pending")},{id:"silenced",title:e("Silenced")}],reducer:Xt.fp,type:"alert-state"},fl(e),{defaultSelected:["platform"],filter:(e,t)=>e.selected?.includes(kr(t))||g.Z(e.selected),filterGroupName:e("Source"),items:[{id:"platform",title:e("Platform")},{id:"user",title:e("User")},...o],reducer:kr,type:"alert-source"}],[i,c,d]=(0,n.useListPageFilter)(t,s),u=D.useMemo((()=>[{id:"name",props:{className:vl[0]},sort:"labels.alertname",title:e("Name"),transforms:[m.sortable]},{id:"severity",props:{className:vl[1]},sort:(e,t)=>T.Z(e,Xt.hs,[t]),title:e("Severity"),transforms:[m.sortable]},{id:"state",props:{className:vl[2]},sort:(e,t)=>T.Z(e,yl,[t]),title:e("State"),transforms:[m.sortable]},{id:"source",props:{className:vl[3]},sort:(e,t)=>T.Z(e,kr,[t]),title:e("Source"),transforms:[m.sortable]},{id:"actions",props:{className:vl[4]},title:""}]),[e]);return D.createElement(D.Fragment,null,D.createElement(R.Helmet,null,D.createElement("title",null,"Alerting")),D.createElement("div",{className:"co-m-pane__body"},D.createElement(n.ListPageFilter,{data:i,labelFilter:"alerts",labelPath:"labels",loaded:a,onFilterChange:d,rowFilters:s}),l&&D.createElement(wl,{silencesLoadError:l}),D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},D.createElement(n.VirtualizedTable,{"aria-label":e("Alerts"),columns:u,data:c??[],loaded:a,loadError:r,Row:_l,unfilteredData:t})))))})),Sl=(e,t)=>"not-firing"===t?g.Z(e.alerts):Z.Z(e.alerts,{state:t}),Nl=(e,t)=>e.selected?.includes("not-firing")&&g.Z(t.alerts)||Z.Z(t.alerts,(t=>e.selected?.includes(t.state)))||g.Z(e.selected),kl=e=>({filter:Nl,filterGroupName:e("Alert State"),isMatch:Sl,items:[{id:"firing",title:e("Firing")},{id:"pending",title:e("Pending")},{id:"silenced",title:e("Silenced")},{id:"not-firing",title:e("Not Firing")}],type:"alerting-rule-has-alert-state"}),Bl=["pf-u-w-50 pf-u-w-33-on-sm","pf-m-hidden pf-m-visible-on-sm","","pf-m-hidden pf-m-visible-on-sm"],ql=({obj:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a=e.annotations?.description||e.annotations?.message;return D.createElement(D.Fragment,null,D.createElement("td",{className:Bl[0],title:a},D.createElement("div",{className:"co-resource-item"},D.createElement(Tr,{resource:Xt.X1}),D.createElement($.Link,{to:Sr(e),className:"co-resource-item__resource-name"},e.name))),D.createElement("td",{className:Bl[1],title:a},D.createElement(Mr,{severity:e.labels?.severity})),D.createElement("td",{className:Bl[2],title:a},g.Z(e.alerts)?"-":D.createElement(Ur,{alerts:e.alerts})),D.createElement("td",{className:Bl[3],title:a},"user"===Nr(e)?t("User"):t("Platform")))},Il=te((()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin"),t=(0,L.useSelector)((({observe:e})=>e.get("rules"))),{loaded:a=!1,loadError:r}=(0,L.useSelector)((({observe:e})=>e.get("alerts")||{})),l=(0,L.useSelector)((({observe:e})=>e.get("silences")?.loadError)),o=D.useMemo((()=>Cl(t,Nr)),[t]),s=[{filter:(e,t)=>(0,Xt.GS)(e.selected?.[0],t.name),filterGroupName:"",items:[],type:"name"},kl(e),fl(e),{defaultSelected:["platform"],filter:(e,t)=>e.selected?.includes(Nr(t))||g.Z(e.selected),filterGroupName:e("Source"),items:[{id:"platform",title:e("Platform")},{id:"user",title:e("User")},...o],reducer:Nr,type:"alerting-rule-source"}],[i,c,d]=(0,n.useListPageFilter)(t,s),u=D.useMemo((()=>[{id:"name",props:{className:Bl[0]},sort:"name",title:e("Name"),transforms:[m.sortable]},{id:"severity",props:{className:Bl[1]},sort:(e,t)=>T.Z(e,Xt.hs,[t]),title:e("Severity"),transforms:[m.sortable]},{id:"state",props:{className:Bl[2]},sort:(e,t)=>T.Z(e,Xt.wC,[t]),title:e("Alert state"),transforms:[m.sortable]},{id:"source",props:{className:Bl[3]},sort:(e,t)=>T.Z(e,Nr,[t]),title:e("Source"),transforms:[m.sortable]}]),[e]);return D.createElement(D.Fragment,null,D.createElement(R.Helmet,null,D.createElement("title",null,"Alerting")),D.createElement("div",{className:"co-m-pane__body"},D.createElement(n.ListPageFilter,{data:i,labelFilter:"observe-rules",labelPath:"labels",loaded:a,onFilterChange:d,rowFilters:s}),l&&D.createElement(wl,{silencesLoadError:l}),D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},D.createElement(n.VirtualizedTable,{"aria-label":e("Alerting rules"),columns:u,data:c??[],loaded:a,loadError:r,Row:ql,unfilteredData:t})))))})),Tl=D.memo((()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin");return D.createElement($.Link,{className:"co-m-primary-action",to:"/monitoring/silences/~new"},D.createElement(r.Button,{"data-test":"create-silence-btn",variant:"primary"},e("Create silence")))})),Zl=({setErrorMessage:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),[a,,l,o]=tt(!1),s=(0,L.useDispatch)(),{selectedSilences:i,setSelectedSilences:c}=D.useContext(xr);return D.createElement(r.Button,{isDisabled:0===i.size,isLoading:a,onClick:()=>{l(),Promise.allSettled([...i].map((e=>n.consoleFetchJSON.delete(`${window.SERVER_FLAGS.alertManagerBaseURL}/api/v2/silence/${e}`)))).then((t=>{o(),c(new Set),(0,Xt.rH)(s);const a=t.filter((e=>"rejected"===e.status)).map((e=>e.reason));if(a.length>0){const t=a.map((e=>p.Z(e,"json.error")||e.message||"Error expiring silence"));e(t.join(", "))}}))},variant:"secondary"},t("Expire {{count}} silence",{count:i.size}))},Fl=e=>{const t=h.Z(e.firingAlerts,"labels.severity");return[Number.MAX_SAFE_INTEGER-(t.critical??0),Number.MAX_SAFE_INTEGER-(t.warning??0),e.firingAlerts.length]},Dl=e=>[["active","pending","expired"].indexOf((0,Xt.SI)(e)),p.Z(e,"pending"===(0,Xt.SI)(e)?"startsAt":"endsAt")],Rl=({silences:e})=>{const{selectedSilences:t,setSelectedSilences:a}=D.useContext(xr),n=x.Z(e,(e=>"expired"!==(0,Xt.SI)(e))),l=n.length>0&&F.Z(n,(e=>t.has(e.id))),o=D.useCallback((e=>{const t=e?n.map((e=>e.id)):[];a(new Set(t))}),[n,a]);return D.createElement(r.Checkbox,{id:"select-all-silences-checkbox",isChecked:l,isDisabled:0===n.length,onChange:o})},Pl=te((()=>{const{t:e}=(0,P.useTranslation)("plugin__monitoring-plugin"),[t,a]=D.useState(new Set),[l,o]=D.useState(),{data:s,loaded:i=!1,loadError:c}=(0,L.useSelector)((({observe:e})=>e.get("silences")||{})),d=[{filter:(e,t)=>(0,Xt.GS)(e.selected?.[0],t.name),filterGroupName:"",items:[],type:"name"},{defaultSelected:["active","pending"],filter:(e,t)=>e.selected?.includes((0,Xt.SI)(t))||g.Z(e.selected),filterGroupName:e("Silence State"),items:[{id:"active",title:e("Active")},{id:"pending",title:e("Pending")},{id:"expired",title:e("Expired")}],reducer:Xt.SI,type:"silence-state"}],[u,p,b]=(0,n.useListPageFilter)(s,d),E=D.useMemo((()=>[{id:"checkbox",props:{className:Kr[0]},title:D.createElement(Rl,{silences:p})},{id:"name",props:{className:Kr[1]},sort:"name",title:e("Name"),transforms:[m.sortable]},{id:"firingAlerts",props:{className:Kr[2]},sort:(e,t)=>T.Z(e,Fl,[t]),title:e("Firing alerts"),transforms:[m.sortable]},{id:"state",props:{className:Kr[3]},sort:(e,t)=>T.Z(e,Dl,[t]),title:e("State"),transforms:[m.sortable]},{id:"createdBy",props:{className:Kr[4]},sort:"createdBy",title:e("Creator"),transforms:[m.sortable]},{id:"actions",props:{className:Kr[5]},title:""}]),[p,e]);return D.createElement(D.Fragment,null,D.createElement(R.Helmet,null,D.createElement("title",null,"Alerting")),D.createElement("div",{className:"co-m-pane__body"},D.createElement(xr.Provider,{value:{selectedSilences:t,setSelectedSilences:a}},D.createElement(r.Flex,null,D.createElement(r.FlexItem,null,D.createElement(n.ListPageFilter,{data:u,hideLabelFilter:!0,loaded:i,onFilterChange:b,rowFilters:d})),D.createElement(r.FlexItem,null,D.createElement(Tl,null)),D.createElement(r.FlexItem,null,D.createElement(Zl,{setErrorMessage:o}))),c&&D.createElement(r.Alert,{className:"co-alert",isInline:!0,title:e("Error loading silences from Alertmanager. Alertmanager may be unavailable."),variant:"danger"},"string"==typeof c?c:c.message),l&&D.createElement(r.Alert,{className:"co-alert",isInline:!0,title:e("Error"),variant:"danger"},l),D.createElement("div",{className:"row"},D.createElement("div",{className:"col-xs-12"},D.createElement(n.VirtualizedTable,{"aria-label":e("Silences"),columns:E,data:p??[],loaded:i,loadError:c,Row:tl,unfilteredData:s}))))))})),Ll=({active:e,children:t})=>D.createElement("li",{className:u()("co-m-horizontal-nav__menu-item",{"co-m-horizontal-nav-item--active":e})},t),$l=({match:e})=>{const{t}=(0,P.useTranslation)("plugin__monitoring-plugin"),a="/monitoring/alerts",n="/monitoring/alertrules",r="/monitoring/silences",{url:l}=e;return D.createElement(D.Fragment,null,D.createElement("div",{className:"co-m-nav-title co-m-nav-title--detail"},D.createElement("h1",{className:"co-m-pane__heading"},D.createElement("div",{className:"co-m-pane__name co-resource-item"},D.createElement("span",{className:"co-resource-item__resource-name","data-test-id":"resource-title"},t("Alerting"))))),D.createElement("ul",{className:"co-m-horizontal-nav__menu"},D.createElement(Ll,{active:l===a},D.createElement($.Link,{to:a},t("Alerts"))),D.createElement(Ll,{active:l===r},D.createElement($.Link,{to:r},t("Silences"))),D.createElement(Ll,{active:l===n},D.createElement($.Link,{to:n},t("Alerting rules")))),D.createElement($.Switch,null,D.createElement($.Route,{path:a,exact:!0,component:xl}),D.createElement($.Route,{path:n,exact:!0,component:Il}),D.createElement($.Route,{path:r,exact:!0,component:Pl})))},Ml=()=>{const e=(0,L.useDispatch)(),[t]=(0,n.useResolvedExtensions)(ae),a=D.useMemo((()=>t.filter((e=>"observe-alerting"===e.properties.contextId)).map((e=>e.properties))),[t]);return D.useEffect((()=>{const{prometheusBaseURL:t}=window.SERVER_FLAGS;if(t){const t="alerts",r="rules";e((0,Re.k)(t));const l=oe({endpoint:n.PrometheusEndpoint.RULES}),o=()=>{(async(e,t)=>{if(!t||0===t.length)return(0,n.consoleFetchJSON)(e);const a=t.map((e=>({id:e.id,fetch:e.getAlertingRules}))),r=["prometheus",...a.map((e=>e.id))];try{return{data:{groups:await Promise.allSettled([(0,n.consoleFetchJSON)(e),...a.map((e=>e.fetch()))]).then((e=>e.map(((e,t)=>({sourceId:r[t],alerts:e}))).flatMap((e=>"fulfilled"===e.alerts.status&&e.alerts.value?.data?.groups?e.alerts.value.data.groups.map((t=>({...t,rules:[...t.rules.map((t=>({...t,sourceId:e.sourceId})))]}))):[]))))},status:"success"}}catch{return(0,n.consoleFetchJSON)(e)}})(l,a).then((({data:a})=>{const{alerts:n,rules:l}=(0,Xt.lt)(a);e((0,Re.A$)(t,n)),e((0,Re.Mw)(r,l))})).catch((a=>{e((0,Re.bH)(t,a))})).then((()=>{qr[t]&&clearTimeout(qr[t]),qr[t]=setTimeout(o,15e3)}))};Br[t]=o,o()}else e((0,Re.bH)("alerts",new Error("prometheusBaseURL not set")));return()=>_.Z(qr,clearTimeout)}),[a,e]),D.createElement($.Switch,null,D.createElement($.Route,{path:"/monitoring/(alerts|alertrules|silences)",exact:!0,component:$l}),D.createElement($.Route,{path:"/monitoring/alertrules/:id",exact:!0,component:dl}),D.createElement($.Route,{path:"/monitoring/alerts/:ruleID",exact:!0,component:il}),D.createElement($.Route,{path:"/monitoring/silences/:id",exact:!0,component:hl}),D.createElement($.Route,{path:"/monitoring/silences/:id/edit",exact:!0,component:jn}))},Gl=()=>{const e=Ae();return D.createElement($.Redirect,{to:`/monitoring/query-browser?query0=${e["g0.expr"]||""}`})},jl=()=>D.createElement($.Switch,null,D.createElement($.Redirect,{from:"/monitoring",exact:!0,to:"/monitoring/alerts"}),D.createElement($.Route,{path:"/monitoring/dashboards/:board?",exact:!0,component:en}),D.createElement($.Route,{path:"/monitoring/graph",exact:!0,component:Gl}),D.createElement($.Route,{path:"/monitoring/query-browser",exact:!0,component:xn}),D.createElement($.Route,{path:"/monitoring/silences/~new",exact:!0,component:Un}),D.createElement($.Route,{path:"/monitoring/targets",component:mr}),D.createElement($.Route,{component:Ml}))},48801:(e,t,a)=>{a.d(t,{b:()=>l});var n=a(56271),r=a(37901);const l=()=>{const e=(0,n.useRef)();return(0,n.useEffect)((()=>(e.current=new AbortController,()=>e.current.abort())),[]),t=>(0,r.consoleFetchJSON)(t,"get",{signal:e.current.signal})}},19610:(e,t,a)=>{a.d(t,{GS:()=>f,Hp:()=>w,IS:()=>B,Nt:()=>T,SI:()=>S,Uq:()=>E,X1:()=>v,Yf:()=>F,b6:()=>A,bZ:()=>y,fp:()=>x,hs:()=>q,lt:()=>C,q4:()=>Z,rH:()=>k,sU:()=>_,vQ:()=>h,wC:()=>I,wX:()=>N});var n=a(28518),r=a.n(n),l=a(13165),o=a(27206),s=a(69396),i=a(1453),c=a(81228),m=a(92757),d=a(49666),u=a(5359),p=a(61812),g=a(37901),b=a(31185);const E=window.SERVER_FLAGS.prometheusBaseURL,A=864e5,h={kind:"Alert",label:"Alert",plural:"/monitoring/alerts",abbr:"AL"},v={kind:"AlertRule",label:"Alerting Rule",plural:"/monitoring/alertrules",abbr:"AR"},_={kind:"Silence",label:"Silence",plural:"/monitoring/silences",abbr:"SL"},f=(e,t)=>r()(l.Z(e),l.Z(t)),w=e=>o.Z(e,((e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`)).join("&"),y=(e,t)=>`${h.plural}/${t}?${w(e.labels)}`,C=e=>{const t=s.Z(e,"groups"),a=i.Z(t,(e=>c.Z(e.rules,{type:"alerting"}).map((t=>{const a=[e.file,e.name,t.name,t.duration,t.query,...o.Z(t.labels,((e,t)=>`${e}=${t}`))].join(",");return{...t,id:String((0,p.murmur3)(a,"monitoring-salt"))}}))));return a.forEach((e=>{e.alerts.forEach((t=>t.labels={...e.labels,...t.labels}))})),{alerts:i.Z(a,(e=>e.alerts.map((t=>({rule:e,...t}))))),rules:a}},x=e=>e?.state,S=e=>e?.status?.state,N=(e,t)=>t?e?"=~":"!~":e?"=":"!=",k=e=>{const{alertManagerBaseURL:t}=window.SERVER_FLAGS;t&&(e((0,b.k)("silences")),(0,g.consoleFetchJSON)(`${t}/api/v2/silences`).then((t=>{d.Z(t,(e=>{var t;e.name=(t=e,s.Z(m.Z(t.matchers,{name:"alertname"}),"value")||t.matchers.map((e=>`${e.name}${N(e.isEqual,e.isRegex)}${e.value}`)).join(", "))})),e((0,b.A$)("silences",t))})).catch((t=>{e((0,b.bH)("silences",t))})))},B=e=>e.annotations?.description||e.annotations?.message||e.labels?.alertname,q=e=>{const{severity:t}=e.labels;return[{critical:1,warning:2,none:4}[t]??3,t]},I=e=>{const t=u.Z(e.alerts,"state");return["firing","pending","silenced"].map((e=>Number.MAX_SAFE_INTEGER-(t[e]??0)))},T=e=>"openshift-monitoring/k8s"===e.labels?.prometheus?"platform":"user",Z=e=>"TimeoutError"===e.name||e.message.includes("timed out"),F=(e,t=Date.now())=>{if(e<7*A)return[{endTime:t,duration:e}];const a=[{endTime:t-e+A,duration:A}];for(;a.at(-1).endTime<t;){const e=a.at(-1).endTime+A;a.push({endTime:e,duration:A})}return a}}}]);